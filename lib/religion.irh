AI_SYMBOL Effect "Aiswin;symbol" : EA_GENERIC
  { Desc: "Aiswin's holy symbol is a crimson heart-shape with a 
      blade driven through the center."; 
      Flags: EF_NOGEN; } 
            
God "Aiswin"
  {
    Domains: $"Fate", $"Knowledge", $"Night", $"Planning", 
             $"Retribution", $"Trickery";
    Desc: "<15>God of Secrets, Vengeance and Shadows<11>\n
      __Fate, Knowledge, Night, Planning, Retribution, Trickery. 
      The Short Sword. Weapons of Balance. <2>\n
      __Aiswin the Whisperer lurks in the hearts of all men and women.
      Filled with venom and hurt, he offers succor to those who have
      been wounded by the wrongful acts of others, but his edict demands
      an eye for an eye, and a life for a life. A born manipulator,
      Aiswin teaches the weak to use treachery and poison (literal
      and metaphorical) to fell the strong, and believes that the
      greatest possible sin a thinking being can commit is to forgive
      an enemy who has genuinely and knowingly wronged her.\n
      __Aiswin holds as his protectorate all who work at night, or
      work alone, and is revered by many thieves and assassins'
      guilds. Yet, his favour is a fickle thing for any guildmaster
      to try to hold, because he hates the oppression or degradation
      of the weak -- one who wishes to hold his favour had best not
      treat their underlings poorly or encourage victimization of the
      innocent. Aiswin has cults rather than a priesthood, forming
      loyal cliques from those who have been rejected by their peers
      or alienated from society. A common cliche states that Aiswin
      has dominion over everyone who has nobody else.\n
      __Aiswin is the god of vengeance, not the god of all-consuming
      vengeance for imagined slights. His favour comes upon those who
      have been genuinely hurt, though he is lax in enforcing morality
      upon his clerics and many pursue very destructive, over-reaching
      schemes against their enemies. Some even end up going insane for
      having nurtured their bitterness for so long. When clerics of
      Aiswin are not pursuing their personal vendettas, they tend to
      find work as spies, assassins, political advisors and vigilantes.\n
      __Aiswin is True Neutral, and his clerics may be of any alignment.
      Good clerics of Aiswin pursue just vengeance on behalf of those
      who cannot protect themselves, while evil ones blame groups for
      the acts of individuals and carry out vengeance upon entire family
      lines, nations, genders or races to sate their bigotry. The majority
      fall in between these two extremes, being bitter, self-absorbed and 
      vengeful without becoming truly depraved. Aiswin's chosen weapon is
      the short sword, and his holy symbol is a crimson heart-shape with a
      blade driven through the center. He grants access to the domains of
      Fate, Knowledge, Night, Planning, Retribution and Trickery.\n
      __<10>Worship:<2> Aiswin accepts sacrifice only of creatures killed as
      blood vengeance -- hostile creatures who wounded the petitioner before
      the petitioner killed them. Sapient creatures sacrificed in accord with
      blood vengeance are far more valued than others. He is angered when 
      his followers attack creatures who are not hostile to them, or when they
      use magical effects with the [Light] descriptor. He also expects his
      followers to slay any creature who gravely wounds them before they move
      forward in their lives (in game terms, leveling up, or delving deeper 
      into the dungeon). Conversely, 
      however, he is exacting and gives his followers no allowance for such 
      transgressions before he becomes angry.\n
      __While Aiswin places
      few restrictions on his followers, other than expecting them not to
      betray or kill friendly creatures, and he offers a number of useful
      secrets and artifacts long thought lost, but is subject to a serious
      restriction: he can only offer direct divine aid to his followers
      between sunset and sunrise. When the sky is bright, Aiswin has no
      direct influence in the world. Areas deep underground are typically
      considered to be eternal night, but even there Aiswin cannot offer
      aid in areas of bright (magically produced) sunlight.\n
      __<10>Blessings:<2> Aiswin is always willing to strike at the enemies
      of his followers, should they ask for his aid. He will also transport
      worshippers to safety when called upon, heal or resurrect them or identify
      their items. For more devoted petitioners, he may purify the body, clear
      the mind or even remove fatigue. However, Aiswin cannot offer any aid to 
      followers when they are in areas of bright light. Aiswin does not take 
      converts lightly, however, and it takes a great deal of effort on a 
      petitioner's part to bring him to accept a new worshipper. He does not 
      casually aid lay worshippers, but will resurrect even a comparatively
      unskilled loyalist.\n
      __His more permanent blessings include an affinity for hiding in shadows,
      magic to conjure darkness or command the shadows, a preternatural insight 
      into weaknesses and a silvered tongue.";
    Lists:
      * GODSPEAK_LIST
          MSG_ANGER
            "The air grows sharply cold, and all the hairs on the back of your
               neck stand up straight!"
          MSG_PLEASED
            "A soft red glow surronds you, and you hear a whispered voice in
               the back of your mind: |Ideal.|"
          MSG_PROVE_WORTH
            "A silky, dangerous voice whispers into your mind: |Prove your
               devotion.|"
          MSG_INSUFFICIENT
            "A silky whisper mindspeaks: |Insufficient.|"
          MSG_BLESSING1
            "A silky whisper speaks into your mind: |I will make you one with
               shadows!|"
          MSG_BLESSING2
            "A silky whisper speaks into your mind: |I grant you intimacy with
              the night!|"
          MSG_BLESSING3
            "A silky whisper speaks into your mind: |I gift you with secret lore!|"
          MSG_BLESSING4
            "A silky whisper speaks into your mind: |I will open your eyes to
              the weakness of your enemies!|"
          MSG_BLESSING5
            "A silky whisper speaks into your mind: |I name you master over all
              shadows!|"    
          MSG_BLESSING6
            "A silky whisper speaks into your mind: |I gift you with words of
              silk and malice!|"
          MSG_BLESSING7
            "A silky whisper speaks into your mind: |I teach you now to glory in
               the lamentations of those who have wronged you!|" 
          MSG_BLESSING8
            "A silky whisper speaks into your mind: |I teach you now to strike
              by surprise and inflict pain with a touch!|" 
          MSG_BLESSING9
            "A silky whisper speaks into your mind: |To you I open the most
              secret shadow paths, and grant words to call forth a thousand
              knives!|" 
          MSG_CROWNED
            "A silky whisper speaks into your mind: |I crown you the Harbringer
              of Ruin!|"
          MSG_INSUFFICIENT
            "A sinuous voice intones: |Insufficient.|"
          MSG_BADSAC8
            "A silky voice hisses angrily: |Abomination!|"
          MSG_OFFER_RAISE
            "|I offer to you a chance to avenge yourself from beyond death!|"
          MSG_SALUTATION
            "|Blessed be those who walk the path of shadows!|",
      * SACRIFICE_LIST
          MA_SAPIENT    10
          MA_SAPIENT    10
          MA_SAPIENT    10
          MA_SAPIENT    10
          MA_ALL        2
          MA_ALL        2
          MA_CHOICE1    SAC_UNWORTHY
          MA_CHOICE2    SAC_ABOMINATION,
      * GOD_RELATIONS
          REL_DEFAULT   3     0
          $"Hesani"     5     1
          $"Mara"       0     0,
      /* * CROWNING_GIFTS
          $"Nine Lives Stealer"
          $"Kinslayer"
          $"Oathbow"
          $"Spiderbite", */
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          54000
          96000
          102000
          250000,
      * AID_CHART
          AID_SMITE     P_MODERATE   0  
          AID_TELEPORT  P_MODERATE   100         
          AID_HEAL      P_HIGH       500
          AID_RESURRECT P_LOW        500
          AID_IDENTIFY  T_ITEM       500
          AID_PURIFY    P_HIGH       1500
          AID_CLARITY   P_HIGH       1500
          AID_REFRESH   P_HIGH       2000
          AID_DEFLECT   P_LOW        3000;    
    Constants:
      * VOICE_COLOUR BLUE,
      * ALTAR_COLOUR BLUE,
      * HOLY_SYMBOL $"Aiswin;symbol",
      * CHOSEN_WEAPON $"short sword",
      * CHOSEN_WEAPON_QUALITY WQ_BALANCE,
      * INTERVENTION_COST 4,
      * RESURRECTION_COST 6,
      * ALTAR_COST 5,
      * PRAYER_TIMEOUT 5,
      * MIN_RAISE_LEVEL 5,
      * MIN_CONVERT_FAVOUR 750,
      * PRAYER_DC 10,
      * LEVEL_BLEEDOFF 5,
      * TOLERANCE_VAL 0,
      * GODPULSE_INTERVAL 10,
      * GODANGER_INTERVAL 20,
      * PERSONAL_ALIGN 0,
      * LAY_MULTIPLIER 10;
    Grants:
      Stati[SKILL_BONUS,SK_HIDE,+4] at 1st level,
      Ability[CA_INNATE_SPELL,$"deeper darkness"] at 2nd level,
      Ability[CA_GRANT_ITEM,$"spellbook [Lore of Murder I]"] at 3rd level,
      Ability[CA_INNATE_SPELL,$"Bestow Curse"] at 3rd level,
      Stati[SKILL_BONUS,SK_FIND_WEAKNESS,+10] at 4th level,
      Ability[CA_INNATE_SPELL, $"globe of shadow"] at 5th level,
      Ability[CA_INNATE_SPELL, $"animate shadows"] at 5th level,
      Stati[SKILL_BONUS,SK_DIPLOMACY,+5] at 6th level,
      Stati[SKILL_BONUS,SK_BLUFF,+5] at 6th level,
      Ability[CA_FEED_UPON_PAIN,+1] at 7th level,
      Stati[EXTRA_FEAT,FT_BACKSTAB] at 8th level,
      Ability[CA_INNATE_SPELL,$"Pain Touch"] at 8th level,
      Ability[CA_INNATE_SPELL,$"Shadow Step"] at 9th level,
      Ability[CA_INNATE_SPELL,$"Ring of Blades"] at 9th level;
    On Event EV_GIVE_AID {
      hObj hEnemy;
      if (e.EParam == AID_SMITE)
        {
          for (hEnemy=EMap->FirstThing();hEnemy;hEnemy=EMap->NextThing())
            if (hEnemy->isCreature() && hEnemy->DistFrom(EActor) < 15)
              if (hEnemy->isHostileTo(EActor))
                {
                  hEnemy->IDPrint("Shadows rise up and tear at your body!",
                                   "Shadows rise up and tear at the <hObj>!",hEnemy);
                  ThrowDmg(EV_DAMAGE,AD_NORM,6d6,"the vengeance of Aiswin",
                             hEnemy, hEnemy);
                }
          return DONE;
        }
      return NOTHING;
      },
    EV_RETRIBUTION {
      EActor->IDPrint("Shadows rise up and tear at your body!",
                        "Shadows rise up and tear at the <hObj>!",EActor);
      ThrowDmg(EV_DAMAGE,AD_NORM,(e.EParam)d6,"the vengeance of Aiswin",
                  EActor, EActor);
      return DONE;
      },
    GODWATCH(PRE(EV_HIT)) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (EVictim->isFriendlyTo(EActor))
        EActor->Transgress($"Aiswin",4,false,"betrayal of a friend");
      else if (!EVictim->isHostileTo(EActor))
        EActor->Transgress($"Aiswin",2,false,"attacking neutral creature");
      return NOTHING;
      },
    GODWATCH(PRE(EVICTIM(EV_DAMAGE))) {
      /* When a creature wounds the PC, tag it so that it becomes an
         acceptable vengeance-sacrifice. */
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (!EActor->HasEffStati(CORPSE_FLAG,$"Aiswin"))
        EActor->GainPermStati(CORPSE_FLAG,EVictim,SS_MISC,0,0,$"Aiswin",0);
      return NOTHING;
      },
    GODWATCH(POST(EV_EFFECT)) {
      if (e.eID != NULL_ID && !(e.isTrap || e.isActOfGod))
        if (e.eID->Schools & SC_LIGHT)
          if (EActor->getGod() == $"Aiswin")
            EActor->Transgress($"Aiswin",3,false,"using light-magic");
      return NOTHING;
      },
    GODWATCH(EV_ADVANCE) {
      if (EActor->getGod() == $"Aiswin")
        if (EActor->HasStati(CRIT_WOUNDED_BY))
          EActor->Transgress($"Aiswin", 2, false, "failing to avenge grave wounding");
      EActor->RemoveStati(CRIT_WOUNDED_BY);
      }, 
    GODWATCH(EV_ENTER) {
      if (EActor->getMaxDepth(EMap->dID) > EMap->Depth)
        return NOTHING;
      if (!ETarget->EnterDir(DOWN))
        return NOTHING;
      if (EActor->getGod() == $"Aiswin")
        if (EActor->HasStati(CRIT_WOUNDED_BY))
          EActor->Transgress($"Aiswin", 2, false, "failing to avenge grave wounding");
      EActor->RemoveStati(CRIT_WOUNDED_BY);
      return NOTHING;
      },
    GODWATCH(EV_MOVE) {
      int16 tx, ty;
      if (EActor->getGod() != $"Aiswin")
        return NOTHING;
      tx = EActor->x + DirX(e.EDir);
      ty = EActor->y + DirY(e.EDir);
      if (EMap->FallAt(tx,ty) && !EActor->isAerial() && 
           !EMap->FallAt(EActor->x, EActor->y))
        {
          if (EActor->HasStati(CRIT_WOUNDED_BY))
            EActor->Transgress($"Aiswin", 2, false, "failing to avenge grave wounding");
          EActor->RemoveStati(CRIT_WOUNDED_BY);
        }
      return NOTHING;
      },
    PRE(EV_PRAY) {
      if (EMap->BrightAt(EActor->x,EActor->y))
        {
          EActor->IPrint("Aiswin can only offer you aid in areas that have
            at least some shadows. In this brightly-lit region, you cannot
            reach him.");
          return ABORT;
        }
      return NOTHING;
      },
    PRE(EV_SACRIFICE) {
      if (GetHandle(EItem) == NULL_OBJ)
        {
          if (!EVictim->HasEffStati(CORPSE_FLAG,$"Aiswin"))
            e.EParam = MA_CHOICE1;
          if (EVictim->HasStati(WAS_FRIENDLY))
            e.EParam = MA_CHOICE2;
        }
      else
        {
          if (!EItem->HasEffStati(CORPSE_FLAG,$"Aiswin"))
            e.EParam = MA_CHOICE1;
          if (EItem->HasStati(WAS_FRIENDLY))
            e.EParam = MA_CHOICE2;
        }
      return NOTHING;
      },
    EV_GODPULSE {
      rID spID; hObj it; int16 i, x, y; String s1, s2;
      EActor->IPrint("Aiswin whispers a secret to you!");
      switch (1d4)
        {
          case 1: case 2:
            i = 0;
            do {
              it = GenDungeonItem(0, NULL_ID, 20, 10);
              if (it->isType(T_POTION) || it->isType(T_SCROLL) ||
                  it->isType(T_WAND) || it->isType(T_STAFF) ||
                  it->isType(T_ROD) || it->isType(T_AMULET) ||
                  it->isType(T_RING) || it->isType(T_DECK) ||
                  it->isType(T_BRACERS) || it->isType(T_BOOTS) ||
                  it->isType(T_CLOAK) || it->isType(T_HELMET) ||
                  it->isType(T_GIRDLE))
                if (!it->isKnown(KN_MAGIC))
                  i = 200;
              if (i != 200) {
                it->Remove(true);
                i++;
                }
              }
            while (i < 100);
            if (i == 100)
              break;
            it->SetKnown(0);
            it->SetInherentPlus(0);
            it->IFlags = 0;
            it->SetQuantity(1);
            s1 = Pluralize(it->Name(NA_FLAVOR));
            s2 = Pluralize(it->Name(NA_IDENT));
            EActor->IPrint("You now know that <hText1> are really <hText2>!",s1,s2);
            it->MakeKnown(KN_MAGIC);
            it->Remove(true);
           break;
          case 3:
            spID = theGame->GetEffectID(PUR_DUNGEON,0,
              (EActor->ChallengeRating()+3)/2,AI_WIZARDRY);
            EActor->GainTempStati(EFF_FLAG1,NULL,-2,SS_ENCH,
              theGame->SpellNum(spID),0,$"Aiswin's Lore",e.vCasterLev);
            EActor->setSpellFlags(spID, EActor->getSpellFlags(spID) 
                      | SP_KNOWN | SP_BARDIC);
            EActor->IPrint("Mystical knowledge of <9><Res><7> imprints
              itself on your mind!", spID);
           break;
          case 4:
            for (x = EActor->x - 30; x!= (EActor->x + 30 + 1); x++)
              for (y = EActor->y - 30; y!= (EActor->y + 30 + 1); y++)
                if (x > 1 && y > 1 && x+1 < EMap->SizeX() && y+1 < EMap->SizeY())
                  if (dist(x,y,EActor->x,EActor->y) <= 30)
                    if (EMap->SolidAt(x,y))
                      if (!(EMap->SolidAt(x+1,y) && EMap->SolidAt(x-1,y) &&
                            EMap->SolidAt(x,y+1) && EMap->SolidAt(x,y-1) &&
                            EMap->SolidAt(x+1,y+1) && EMap->SolidAt(x-1,y-1) &&
                            EMap->SolidAt(x-1,y+1) && EMap->SolidAt(x+1,y-1)))
                        /* Assumption: Player #0 */
                        EMap->MarkAsSeen(0,x,y,0);
            ETerm->RefreshMap();
           break;
        }
      return DONE;
      },
    EV_ANGER_PULSE {
      if (EActor->HasStati(AFRAID))
        return NOTHING;
      EActor->IPrint("You catch vague glimses of nightmarish, obscene shapes
        menacing you from the shadows!");
      EActor->GainTempStati(AFRAID,NULL,200,SS_MISC,FEAR_PANIC,0,$"Aiswin");
      return DONE;
      };
    Flags: GF_COMBAT_ANGER, GF_JEALOUS;
  }
  
Effect "Aiswin's Lore" : EA_GENERIC
  { SC_DIV; 
    Desc: "Aiswin has blessed you with knowledge of a single specific
      dwenomer for one full day.";
    On Event EV_REMOVED {
      rID spID2;
      spID2 = theGame->SpellID(e.vVal);
      EActor->IPrint("The knowledge of <9><Res><7> fades from your mind.",spID2);
      EActor->setSpellFlags(spID2,EActor->getSpellFlags(spID2) & 
                              ~(SP_BARDIC|SP_KNOWN));
      return NOTHING;
      };
  }

AI_SYMBOL Effect "Asherath;symbol" : EA_GENERIC
   { Desc: "Asherath's holy symbol is an iron gauntlet clasping the planet
   of Therya, with an open book behind it, and his chosen weapon is the
   long sword." ;
    Flags: EF_NOGEN; } 

God "Asherath"
  {
    Domains: $"Strength", $"Knowledge", $"Planning",
             $"Time", $"Trickery", $"War";
    Desc: "<15>God of War, Scholarship, Time and History<11>\n
      __Knowledge, Planning, Strength, Time, Trickery, War. The Long
      Sword. Weapons of Accuracy.<2>
      \n__Asherath is a distant, callous diety, but many rulers claim to
      find wisdom in his words. His faith is ironically two-sided, for he
      is the divine protector and patron of both scholars and warriors. His
      actual clergy are not many in number, for his faith demands not only
      a strong will but strength of spirit. Still, all sages, generals,
      historians and knowledge seekers all propitiate him at one time or
      another. Civilizations rise and fall, he teaches; war is ultimately
      meaningless, and time rights all wrongs. Might does not make right,
      but a righteous cause demands might to serve it, for only war can
      truly change the world. A wise warrior is the supreme force because
      he understands history and has the force of arms to craft what comes
      ahead to his will. Only a being with the personal strength to shape
      the future though violence can be fulfilled; only one with the wisdom
      to discern where war can be used to truly meaningful effect is worthy
      of leading armies. Asherath advocates fighting to protect and provide
      for the worthy (those of strong spirit, even if they are physically
      weak), to increase personal power and to leave a mark on history. He
      also demands that his followers fight to defend all practical
      knowledge, and promote its accessability to the common man. To
      Asherath, the only knowledge that has real value is that which has
      utility; he has no patience for the abstract studies, prefering
      applicable wisdom and hard numbers.
      \n__Asherath's clergy are an unusual lot. While thugs, bullies and
      murderers may pay homage to him, those who he sees fit to grant his
      blessings are neither sadistic nor compassionate, but simply scarred,
      resolute and unfeeling.  Asherath's ethos demands a certain
      callousness, a complete acceptance of the inherent brutality of life;
      his clergy tend to be bitter and more than a little nihilistic. They
      are among the strongest supporters of Empire, valuing the impact it
      has on history, but also show respect for and sometimes even aid
      resistance movements in distant provinces out of admiration for their
      fortitude.  Their services consist of battlefield blessings and
      recitations of ancient military sagas; while not scholarly per se,
      they are also incredible historians of both general and military
      history. Priests of Asherath tend to be older on average than other
      priests; the bitter experience and resolute callousness of the
      elderly veteran suit him far more than youthful exuberance and
      idealism.  Many orcs are turning away from Khasrach in order to
      worship the more studied, tactical Asherath -- especially those who
      see themselves as a grand general in their own eyes.
      \n__Asherath is the son of Abbadon and Erich. It is said he wrested
      the portfolio of time from Abbadon in a visceral, bloody duel at the
      edge of the Abyss; this fight also cost him his right eye. Asherath
      is said to have moved from the Outlands to the Grey Wastes and
      conquered a territory therein because he hated the moral indecision
      of the typical Outlander and favoured a harsher homeland. The other
      dieites often fear Asherath; he has a reputation for never losing,
      largely due to his proclivity for securing the outcome of any battle
      in his favour before he even enters it. Honour is something Asherites
      view as just delightful -- at least, as long as it is	something
      the enemy possesses that allows them to be easily manipulated.  This
      outlook has led the churches of Asherath and Erich into a
      centuries-old tradition of military conflict. 
      \n__Asherath is True Neutral in alignment, but places no alignment
      restriction on his priests or followers. His holy symbol is an iron
      gauntlet clasping the planet of Therya, with an open book behind it,
      and his chosen weapon is the long sword. He offers his priests the
      Domains of Knowledge, Planning, Strength, Time, Trickery and War.\n
      __<10>Worship:<2> Asherath is a pragmatic god who has little use for
      sacrifices. Worshippers gain favour with him when they triumph over their
      betters in combat, and as they improve their own inherent abilities (in
      the manner at which humans specifically excel). He is a lenient god, but 
      obvious stupidity draws anger from him (for example, the use of unidentified 
      items that turn out to be cursed). Followers of Asherath are sworn never to
      destroy knowledge, and a follower of Asherath allowing books to be
      damaged also angers this god. Finally, his followers are sworn to end every
      single day more experienced than they were when they awoke, and idleness
      in this regard offends Asherath. Since he does not desire sacrifices, his
      anger can be difficult to ease, but it does fade as a character's skill in
      their chosen calling increases.\n
      __<10>Blessings:<2> Asherath does not normally intercede on behalf of his followers:
      he expects them to succeed on their own skill, and thus usually does not
      answer prayers for aid, nor will he resurrect the fallen. While he is easy for most
      competant adventurers to stay in favour with, he is much less willing
      to offer aid or intervention to his followers, given his distinctly
      Darwinist approach to life. However, for very
      loyal followers he has been known to smite enemies, heal wounds or purify
      the body; asking these favours of him costs a follower greatly, however. He
      is very distant from lay worshippers.\n
      __He does not grant supernatural powers as permanent blessings as the other
      gods do; however, his theology places followers on a relentless path of self-
      testing and disciplined improvement, that allows them to gain certain subtle
      mundane benefits as favour with him rises. This philosophy allows a follower
      to develop an insight toward causing damage, increased strength and intellect,
      skill at finding others' weaknesses and greater proficiency with the magical
      schools of Divination and Evocation.";
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|Go forth; gain strength and knowledge to shape the world!|" 
          MSG_ANGER
            "You feel that Asherath is gravely displeased with you."
          MSG_BAD_PRAY
            "The air grows sharply cold, and you realize you have made a serious mistake."
          MSG_JEALOUSY
            "|Do you really believe I could not have predicted your betrayal? Fool.|"
          MSG_CONVERT
            "There is no response from Asherath, but you have a sense of acceptance."
          MSG_TIMEOUT
            "You know that Asherath expects His clerics to succeed with little
               aid, and you feel gravely uneasy about your frequent requests."
          MSG_PRAYER
            "Time seems to slow down around you briefly... or is it just the fog of war?"
          MSG_NOAID
            "As is often the case, Asherath apparently expects you to solve this
              matter yourself."
          MSG_OUT_OF_AID
            "Asherath will no longer aid you."
          MSG_NEARLY_OUT
            "You feel certain Asherath grows tired of your entreaties."
          
          /* Skipping 'Insight' messages */
                   
          MSG_BLESSING1
            "Your training in the Ways of Asherath teaches you to strike true
              against your enemies."
          MSG_BLESSING2
            "Your training in the Ways of Asherath helps you to preserve your
               mental and physical might." 
          MSG_BLESSING3
            "Your training in the Ways of Asherath brings you closer to mental
               and physical perfection. You also improve your knowledge of the
               arts of Divination and Evocation."
          MSG_BLESSING4
            "Your training in the Ways of Asherath expands your horizons."
          MSG_BLESSING5
            "Your training in the Ways of Asherath brings you closer to mental
               and physical perfection."
          MSG_BLESSING6
            "Your training in the Ways of Asherath allows you to push your body
              and mind beyond previously-understood limits. You also improve your 
              knowledge of the arts of Divination and Evocation."
          MSG_BLESSING7
            "Your training in the Ways of Asherath brings you closer to mental
               and physical perfection."
          MSG_BLESSING8
            "Your training in the Ways of Asherath allows you to push your body
              and mind beyond previously-understood limits."
          MSG_BLESSING9
            "Your training in the Ways of Asherath brings you closer to mental
               and physical perfection.  You also improve your knowledge of the
               arts of Divination and Evocation."
          MSG_CROWNED
            "|I crown you the Psyche of War!|",
      * GOD_RELATIONS
          REL_DEFAULT   1     0
          $"Erich"      5     1
          $"Hesani"     2     1
          $"Ekliazeh"   0     0
          $"Sabine"     0     0
          $"Khasrach"   0     0
          $"Zurvash"    0     0,          
      * CROWNING_GIFTS
          $"Nine Lives Stealer",
      * FAVOUR_CHART
          1250
          4500
          9600
          18000
          24000
          54000
          96000
          102000
          250000
          500000,
      * AID_CHART
          AID_SMITE     P_HIGH       2000
          AID_HEAL      P_HIGH       3000
          AID_PURIFY    P_HIGH       4000;    
    Constants:
      * VOICE_COLOUR CYAN,
      * ALTAR_COLOUR CYAN,
      * HOLY_SYMBOL $"Asherath;symbol",
      * CHOSEN_WEAPON $"long sword",
      * CHOSEN_WEAPON_QUALITY WQ_ACCURACY,
      * INTERVENTION_COST 20,
      * ALTAR_COST 10,
      * PRAYER_TIMEOUT 50,
      * MIN_CONVERT_FAVOUR 0,
      * PRAYER_DC 15,
      * LEVEL_BLEEDOFF 2,
      * TOLERANCE_VAL 3,
      * PERSONAL_ALIGN 0,
      * LAY_MULTIPLIER 15;
    Grants:
      Stati[ADJUST_INS,A_DMG,+1]          at every level starting at 1st,
      Stati[EXTRA_SKILL,SK_FIND_WEAKNESS] at 1st level,
      Stati[SUSTAIN,A_INT,5]              at 2nd level,
      Stati[SUSTAIN,A_STR,5]              at 2nd level,
      Stati[ADJUST_INS,A_STR,+1]          at 3rd level,
      Stati[ADJUST_INS,A_INT,+1]          at 3rd level,
      Stati[BONUS_SCHOOL_CASTING_LEVEL,SC_DIV,+1] at every 3rd level starting at 3rd,
      Stati[BONUS_SCHOOL_CASTING_LEVEL,SC_EVO,+1] at every 3rd level starting at 3rd,
      Feat[FT_NATURAL_APTITUDE]           at 4th level,
      Stati[ADJUST_INS,A_STR,+1]          at 5th level,
      Stati[ADJUST_INS,A_INT,+1]          at 5th level,
      Ability[CA_INHERANT_POTENTIAL,+1]   at 6th level,
      Stati[ADJUST_INS,A_STR,+1]          at 7th level,
      Stati[ADJUST_INS,A_INT,+1]          at 7th level,
      Ability[CA_INHERANT_POTENTIAL,+1]   at 8th level,
      Stati[ADJUST_INS,A_STR,+1]          at 9th level,
      Stati[ADJUST_INS,A_INT,+1]          at 9th level;
    int32 lastRestXP;
    On Event EV_GIVE_AID {
      hObj hEnemy;
      if (e.EParam == AID_SMITE)
        {
          for (hEnemy=EMap->FirstThing();hEnemy;hEnemy=EMap->NextThing())
            if (hEnemy->isCreature() && hEnemy->DistFrom(EActor) < 15)
              if (hEnemy->isHostileTo(EActor))
                {
                  ThrowEff(EV_EFFECT,$"Asherath Smite",EActor,hEnemy);
                }
          EActor->IPrint("Your devotion to Asherath gives you the strength to continue!");
          EActor->GainTempStati(ADJUST_COMP,NULL,150,SS_MISC,A_THP,max(40,EActor->mHP/2),
                                  $"Asherath");
          return DONE;
        }
      return NOTHING;
      },
    EV_RETRIBUTION {
      EActor->IPrint("You feel threatened.");
      if (EActor->HasEffStati(ADJUST_SAC,$"Asherath Smite",A_AID))
        EActor->IncEffStatiMag(ADJUST_SAC,$"Asherath Smite",SS_CURS,NULL,-2);
      else
        EActor->GainPermStati(ADJUST_SAC,NULL,SS_CURS,A_AID,-4,$"Asherath Smite");
      return DONE;
      },
    GODWATCH(POST(EV_DAMAGE)) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (EVictim->isType(T_BOOK))
        EActor->Transgress($"Asherath",EVictim->isDead() ? 2 : 1,false,
          "damaging books");
      return NOTHING; 
      },
    GODWATCH(EV_WIELD), GODWATCH(EV_DRINK), GODWATCH(EV_ZAP) {
      if (GetHandle(EItem) != NULL_OBJ)
        if (EItem->isCursed())
          if (!EItem->isKnown(KN_CURSE))
            EActor->Transgress($"Asherath", 2, false,
              "lack of caution");
      return NOTHING;
      },
    GODWATCH(POST(EV_DEATH)) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (EVictim->isCreature())
        if (EActor->getGod() == $"Asherath")
          /* HACKFIX */
          if (EVictim->ChallengeRating(true) > EActor->ChallengeRating(true))
            {
              EActor->IPrint("You feel challenged.");
              EActor->gainFavour($"Asherath",30*EVictim->ChallengeRating(),true,true);
            }
      return NOTHING;
      },
    EV_CALC_FAVOUR {
      int16 mult;
      mult = 50;
      mult += EActor->SumStatiMag(ADJUST_INH,-1,NULL);
      e.EParam = (e.EParam * mult) / 50;
      return NOTHING;
      },
    GODWATCH(EV_ADVANCE) {
      EActor->lowerAnger($"Asherath",3);
      return NOTHING;
      },
    GODWATCH(POST(EV_REST)) {
      if (!EActor->isCharacter())
        return NOTHING;
      if (EActor->getGod() != $"Asherath")
        return NOTHING;
      if (lastRestXP > EActor->TotalXP())
        EActor->Transgress($"Asherath",3,false,"lost experience");
      else if (lastRestXP == EActor->TotalXP())
        EActor->Transgress($"Asherath",1,false,"idleness");
      lastRestXP = EActor->TotalXP();
      return NOTHING;
      },
    PRE(EV_SACRIFICE) {
      e.EParam = SAC_UNWORTHY;
      return NOTHING;
      };
  }

Effect "Asherath Smite" : EA_INFLICT
  { xval: ADJUST_LUCK; yval: A_AID; pval: -6; 
    Flags: EF_DLONG;
    On Event EV_MAGIC_HIT
        "You feel threatened." / 
        "The <EVictim> suddenly seems vulnerable.";
  }

AI_SYMBOL Effect "Ekliazeh;symbol" : EA_GENERIC
   { Flags: EF_NOGEN; 
    Desc: "Ekliazeh's holy symbol is a tiny adamant anvil." ; } 

God "Ekliazeh"
  {
    Domains: $"Craft", $"Community", $"Earth", $"Law", 
      $"Strength", $"Protection;domain"; 
    Desc: "<15>God of Stone and Strength<11>
      \n__Craft, Community, Earth, Law, Strength, Protection. The
      Warhammer. Lawful Weapons. <2>
      \n__Ekliazeh, the patron diety of the dwarves, is a resolute and
      stubborn being who has endured unchanging for millenia. Devoted
      to preserving the dwarven race and heritage, Ekliazeh is often
      seen as a harsh and unfeeling god. Defensive to the point of
      being xenophobic, the dogma of Ekliazeh demands that the dwarven
      people endure whatever hardships the world throws at them -- 
      Ekliazeh is a firm believer in growth through ordeal. Ekliazeh
      is prayed to by members of all the goodly races who want strength 
      and endurance (mental or physical) in a coming trial, but his favour 
      is won only by those who have lived truly in accord with the ways
      of their people and honoured all who have come before them. Ekliazeh
      is not a bigoted god, and has shown his favour to humans, halflings,
      gnomes and even rare elves in the past, but the standards he holds
      people to are exacting and unforgiving.
      \n__In dwarven mythology, it is Ekliazeh who hammers the soul of every
      newborn child from the primal energies of creation at his great forge
      beneath the earth, tempering it to endure whatever hardships the world
      will throw at it, and it is the chosen warriors of Ekliazeh who hold
      the line against the primordial forces of chaos that dwell deep below
      even the citadels of the dwarves, striving to tear their way up to the
      surface world. Unsurprisingly, clerics of Ekliazeh tend to have
      something of a martyr complex, and hold surface peoples in a degree
      of contempt -- they are fighting an ageless war against the darkness
      below so that the 'soft' surface folk could live in decadance, after
      all!
      \n__Ekliazeh takes obligations to family very seriously -- a son is
      expected to obey his father in all things, and to follow the same
      career path as his father did before him; individuality is not a
      virtue that Ekliazeh rates highly. Ekliazeh is also highly patriarchal;
      while he has a very healthty respect for the physical and spiritual
      strength that women may possess, he does expect them to defer to
      men wherever there is not a good reason to do otherwise. Ekliazeh
      is prayed to by all who must delve beneath the earth, and miners,
      spelunkers and demihuman underdwellers all propitiate him, regardless
      of their patron diety. There is a distinct mystical branch to
      Ekliazeh's priesthood that focuses on mystical kinship to stone,
      dealing frequently with pech and learning to sing the great Earthsong.
      Clerics of this tradition tend to be more liberal than most Ekliazites,
      and many become geomancers at some point in their career.  
      \n__Ekliazeh's holy symbol is a tiny adamant anvil, and he offers
      his clerics the domains of Craft, Community, Earth, Law, Strength and
      Protection. His chosen weapon is the warhammer. Ekliazeh accepts the 
      sacrifice of rare gemstones gladly, and also favours the blood of evil 
      creatures of the deep Underdark -- both the monstrous aberrations and 
      more recognizable races like drow, goblins and mind flayers. He is Lawful 
      Neutral in alignment, and his priests may be of any non-Chaotic alignment.\n
      __<10>Worship:<2> All dwarves have the option to worship Ekliazeh, even if
      they do not follow a normally religious path. Ekliazeh delights in the sacrifce
      of drow, goblinoids and giants -- the traditional enemies of the dwarven
      people -- but also accepts the sacrifce of any evil creatures (other than
      dwarves). He is angered when his followers commit unlawful acts or attack
      non-hostile creatures that are not traditional enemies of the dwarves. He
      is also gravely angered when a follower kills a dwarf or a member of their
      family, for any reason. Any character (other than goblinoids, elves, drow or 
      lizardfolk) can worship Ekliazeh, but dwarves receive the greatest favour in 
      his eyes.\n
      __<10>Blessings:<2> Ekliazeh will heal his followers, purify their bodies,
      cure blindness or maiming quite casually and lift curses or smite enemies with
      only a little more devotion. For more deeply favoured followers, he can identify
      weapons, armour and shields. It requires a great deal of both personal 
      accomplishment and favour with Ekliazeh for him to raise a fallen hero.\n
      __His more permanent blessings bring a follower closer to the earth: increased
      health and endurance, skill with craftwork and even a kind of natural resistance
      to harm wrought by hardening of the skin.";
    Flags: GF_NO_CHAOTIC, GF_FORCE_TURN;
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|By the forge and the hammer, we stand united!|"
          MSG_ANGER
            "A deep voice thunders, |Thou hast broken the ancient Law!|"
          MSG_PLEASED
            "A deep voice thunders, |Great riches are these!|"
          MSG_PROVE_WORTH
            "A deep voice intones, |Any aspirant must first prove <EActor:his> mettle!|"
          MSG_NOT_WORTHY
            "A deep voice scorns, |Thou art no child of mine!|"
          MSG_BAD_PRAY
            "A deep voice thunders, |Unclean creature! Betrayer of the Law!|"
          MSG_JEALOUSY
            "A deep voice thunders, |Thou turns back on our covenant? Then suffer!|"
          MSG_CONVERT
            "|Uphold my Law, and I will carry you through all of life's hardships.
              Honour the ways of my people, and you will discover tremendous strength!|"
          MSG_FORSAKE
            "A deep voice thunders, |Thou art a traitor to the Law, and art forever
              anathema to all my people!|"
          MSG_TIMEOUT
            "A deep voice intones, |<EActor>, you rely overmuch on my aid! You must
               survive on your own.|"
          MSG_PRAYER
            "The earth seems to rumble in time to your heartbeat!"
          MSG_NOAID
            "A deep voice speaks sorrowfully, |I have no further aid to grant unto
               you, my child.|"
          MSG_OUT_OF_AID
            "A deep voice speaks sorrowfully, |I have given you all the aid even a
               champion may receive in one lifetime!|"
          MSG_NEARLY_OUT
            "A deep voice speaks sorrowfully, |Soon I will no longer be able to aid
               you, my child. Be ready!|"
          MSG_SACRIFICE
            "Your sacrifice dissolves in a rich golden light!"
          MSG_INSUFFICIENT
            "A deep voice thunders, |This is the paltry portion you reserve for 
              your god?!|"
          MSG_SATISFIED
            "A deep voice thunders, |You honour the Law with your offering.|"
          MSG_IMPRESSED
            "A deep voice thunders, |Great glory be upon you for the sacrifice 
               you have wrought!|"
          MSG_LESSENED
            "You feel as though your sins have been lessened in Ekliazeh's eyes." 
          MSG_MOLLIFIED
            "You feel as though your sins have been washed away in Ekliazeh's eyes."
          MSG_BADSAC1
            "A deep voice thunders, |You dare to offer me the blood of my chosen 
              people?!|"
          MSG_BADSAC2
            "A deep voice thunders, |You dare to offer me the blood of goodly folk?!|"
          MSG_OFFER_RAISE
            "I offer you the chance to return to life, to me my champion and guide
              my people on the path to righteousness!"
          MSG_BLESSING1
            "|I gift you with the fortitude to endure all of life's ordeals!"
          MSG_BLESSING2
            "|I gift you with the endurance of a perfect worker-soldier!"
          MSG_BLESSING3
            "|I gift you with the ability to shape metal, and to speak with the
                spirits of the earth!|"
          MSG_BLESSING4
            "|I gift you with unearthly resilience!|"
          MSG_BLESSING5
            "|I shall render your flesh as hard as the stone itself!|"
          MSG_BLESSING6
            "|I gift you with unearthly resilience!|"
          MSG_BLESSING7
            "|I shall render your flesh as hard as the stone itself!|"
          MSG_BLESSING8
            "|I gift you with unearthly resilience!|"
          MSG_BLESSING9
            "|I shall render your flesh as hard as the stone itself!|"
          MSG_CROWNED
            "|I crown you the Warrior of the Law!|"
            
          MSG_CUSTOM1
            "|You whose people have slain my children for millenia now
                appeal to me? Suffer!|"
          MSG_CUSTOM2
            "|Your people are too distant from the Earth to follow my ways.|"
          MSG_CUSTOM3
            "|I bless thy workings of the earth!|";
      * SACRIFICE_LIST
          MA_DWARF       SAC_ABOMINATION
          MA_CHOICE1     SAC_ANGRY
          MA_DROW        15
          MA_GOBLINOID   15
          MA_GIANT       15
          MA_EVIL        7
          MA_EVIL        7,
      * GOD_RELATIONS
          REL_DEFAULT   3     1
          $"Immotian"   0     0
          $"Asherath"   0     0
          $"Zurvash"    6     1
          $"Xel"        6     1
          $"The Multitude" 6  1
          $"Maeve"      6     1,
      /* * CROWNING_GIFTS
          $"Dwarven Thrower"
          $"Flame Tongue"
          $"Glauramong"
          $"Magellin"
          $"Magicbane", */
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          54000
          96000
          102000
          250000,
      * AID_CHART
          AID_HEAL      P_LOW        100
          AID_PURIFY    P_LOW        100
          AID_CURE      P_LOW        100
          AID_UNCURSE   P_LOW        300
          AID_DEFLECT   P_LOW        300
          AID_SMITE     P_LOW        500
          AID_IDENTIFY  T_WEAPON     2000
          AID_IDENTIFY  T_ARMOUR      2000
          AID_IDENTIFY  T_SHIELD     2000
          AID_RESURRECT 0            3000;    
    Constants:
      * VOICE_COLOUR BROWN,
      * ALTAR_COLOUR BROWN,
      * HOLY_SYMBOL $"Ekliazeh;symbol",
      * CHOSEN_WEAPON $"warhammer",
      * CHOSEN_WEAPON_QUALITY WQ_LAWFUL,
      * INTERVENTION_COST 12,
      * RESURRECTION_COST 20,
      * ALTAR_COST 4,
      * PRAYER_TIMEOUT 12,
      * MIN_RAISE_LEVEL 8,
      * MIN_CONVERT_FAVOUR 300,
      * PRAYER_DC 15,
      * LEVEL_BLEEDOFF 3,
      * TOLERANCE_VAL 2,
      * GODPULSE_INTERVAL 20,
      * GODANGER_INTERVAL 25,
      * PERSONAL_ALIGN (AL_LAWFUL),
      * LAY_MULTIPLIER 7;
    Grants:
      Stati[SUSTAIN,A_CON]        at 1st level,
      Stati[EXTRA_FEAT,FT_ENDURANCE] at 2nd level,
      Stati[SKILL_BONUS,SK_CRAFT,+4] at 3rd level,
      Ability[CA_INNATE_SPELL,$"stone tell"] at 3rd level,
      Ability[CA_GRANT_ITEM,$"spellbook [Earthsong]"] at 3rd level,
      Stati[ADJUST_SAC,A_CON,+2] at every 2nd level starting at 4th,
      Stati[ADJUST_SAC,A_ARM,+2] at every 2nd level starting at 5th;
    On Event EV_GIVE_AID {
      hObj hEnemy;
      if (e.EParam == AID_SMITE)
        {
          for (hEnemy=EMap->FirstThing();hEnemy;hEnemy=EMap->NextThing())
            if (hEnemy->isCreature() && hEnemy->DistFrom(EActor) < 15)
              if (hEnemy->isHostileTo(EActor))
                {
                  ThrowEff(EV_EFFECT,$"Earthmaw",EActor,hEnemy);
                }
          if (EActor->isThreatened())
            {
              EActor->IPrint("Ekliazeh gifts you with a burst of strength!");
              EActor->GainTempStati(ADJUST_SAC,NULL,150,SS_MISC,A_STR,8,$"Asherath");
            }
          return DONE;
        }
      return NOTHING;
      },
    EV_RETRIBUTION {
      ThrowEff(EV_EFFECT,$"Earthmaw",EActor,EActor);
      return DONE;
      },
    EV_GODPULSE {
      hObj h; int16 i; bool fixed;
      fixed = false;
      for (h=EActor->FirstInv();h;h=EActor->NextInv())
        if (h->GetHP() != h->MaxHP())
          if (h->isMetallic())
            {
              h->MendHP(3000);
              EActor->IPrint("Your <hObj> looks as if it was never damaged!", h);
              fixed = true;
            }
      if (fixed)
        return DONE;
      for (i=0;i!=50;i++)
        {
          h = EActor->RandInv();
          if (h == NULL_OBJ)
            return DONE;
          if (h->isMetallic() &&
              h->GetInherentPlus() &&
              h->GetInherentPlus() <
                min(5,EActor->getGodLevel($"Ekliazeh") - 2))
            {
              h->SetInherentPlus(h->GetInherentPlus() + 1);
              EActor->IPrint("Your <hObj> glows with a brilliant silver light!", h);
              EActor->GodMessage($"Ekliazeh",MSG_CUSTOM3);
              return DONE;
            }
        }
      return DONE;
      },
    EV_ANGER_PULSE {
      hObj h;
      h = EActor->RandGoodInv(1000);
      if (h == NULL_OBJ)
        return NOTHING;
      EActor->IPrint("Your <hObj> dissolves into a pile of gravel!");
      h->Remove(true);
      },
    GODWATCH(PRE(EV_HIT)) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (!EVictim->isHostileToPartyOf(EActor))
        if (!(EVictim->isMType(MA_DROW) || EVictim->isMType(MA_GIANT) ||
              EVictim->isMType(MA_GOBLINOID) || EVictim->isMType(MA_EVIL))) 
          EActor->Transgress($"Ekliazeh",1,false,"unprovoked attack");
      return NOTHING;
      },
    GODWATCH(EV_DEATH) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (EVictim->isMType(MA_DWARF) && !(EVictim->isMType(MA_UNDEAD)
           || EVictim->isMType(MA_CONSTRUCT)) && EVictim->isMType(MA_SAPIENT))    
        EActor->Transgress($"Ekliazeh",5,false,"killing a dwarf");
      if (EVictim->isMType(MA_DROW) || EVictim->isMType(MA_GIANT) ||
          EVictim->isMType(MA_GOBLINOID))
        EActor->gainFavour($"Ekliazeh",EVictim->ChallengeRating() * 25,false,true);
      return NOTHING;
      },
    GODWATCH(EV_ALIGNED) {
      if (e.EParam & AL_NONLAWFUL)
        EActor->Transgress($"Ekliazeh",e.vMag,false, "unlawful act");
      return NOTHING;
      },
    EV_PREREQ {
      if (EActor->isMType(MA_GOBLINOID) || EActor->isMType(MA_DROW))
        {
          EActor->GodMessage($"Ekliazeh", MSG_CUSTOM1);
          return NOMSG;
        }
      if (EActor->isMType(MA_ELF) || EActor->isMType(MA_LIZARDFOLK))
        {
          EActor->GodMessage($"Ekliazeh", MSG_CUSTOM2);
          return NOMSG;
        }
      return NOTHING;
      },
    PRE(EV_SACRIFICE) {
      if (EItem->HasStati(WAS_FRIENDLY))
        e.EParam = MA_CHOICE1;
      return NOTHING;
      }, 
    EV_CALC_FAVOUR {
      if (EActor->isMType(MA_DWARF))
        e.EParam = ((e.EParam*4)/3) + 200;
      e.EParam = (e.EParam * (40 + EActor->SkillLevel(SK_CRAFT))) / 40;
      return NOTHING;
      };
  }

AI_SYMBOL Effect "Erich;symbol" : EA_GENERIC
   { Flags: EF_NOGEN; 
    Desc: "Erich's holy symbol is a stylized iron scepter." ; } 

God "Erich"
  {
    Desc: "<15>God of Chivalry, Honour and Social Hierarchy<11>\n
      __Domination, Guardian, Law, Nobility, Protection, War. The
      Light Lance. Adamant Items.<2>\n
      __Erich is a deceptively honest diety, for though he stands proudly
      amidst the ranks of the Pantheon of Light, he is at his core as evil
      as any horror spawned by the Sorcery Wars. Erich's most commonly
      preached teachings include moral rigor and honesty in war -- he is
      the patron of knights, and demands support of one's nation unto death,
      absolute obedience to one's liege, the defense of the innocent from
      creatures of darkness and the exposure of any and all hidden sins to
      the light of day. Yet, his theology also demands unquestioning obedience
      to authority, the willingness to commit the blackest acts in service
      to a higher power and the advancement of nobility, militarism and
      commerce at the expense of the common man -- essentially, Erich is
      the god of fascism.\n
      __All men are not born equal in Erich's eyes -- one's social station
      is determined at birth, and attempting to question that order is among
      the greatest crime one can commit. Peasants exist to perform manual
      labour and die on the fields of war, and any attempt to transcend that
      station must be punished with a painful death. For a priest of Erich
      to even speak to a commoner, let alone support them, is viewed by the
      church as a sin. Erich's theology calls the Good-Evil alignment axis the
      'peasant morals', and is based almost entirely upon the Law-Chaos axis.
      A disturbing number of paladins revere Erich, at least until their
      theology comes into conflict with their alignment requirement and they
      must choose between Erich and Good.\n
      __Erich's holy symbol is a stylized iron scepter. He is Lawful Evil, 
      though neither he nor his priests fully comprehend this fact. His 
      clerics may be of any Lawful alignment -- many are Good, emphasizing
      the honesty, chivalry and nobility aspects of his portfolio. His weapon 
      of choice is the light lance, and his Domains are Domination, Guardian,
      Law, Nobility, Protection and War. He appreuciates the offerings of the 
      bodies of ignoble enemies (chaotic thinking beings or unnatural beasts) 
      slain in fair combat. Followers of Erich can always claim the right of hospitality, 
      sleeping in a castle or lordly manor, resting the night without cost. Erich 
      is a demanding and inflexible god, but has been known to reward his most 
      honourable followers lavishly, even lending out powerful magical weapons and 
      armour.\n
      __<10>Worship:<2> Erich accepts the sacrifice of dragons, beasts, chaotic 
      demihumans and evil outsiders (which must be live-sacrified, since they
      do not leave corpses). He is gravely offended by the sacrifice of goblinoids,
      since he considers them to be vermin; their extermination is a chore, not an
      accomplishment worthy of chivalrous accord. Cowing enemies earns favour with
      him, however; he considers it part of the enforcement of the natural order
      of the world.\n
      __He places a very strict code of conduct upon his followers: they must not be 
      craven (by being afraid, or by skulking in the shadows), nor may they use poison, 
      utilize base trickery such as distractions or fast-talking or surrender -- especially
      not to base creatures. They may not enlist the aid of non-demihumans, especially
      not goblinoids, chaotics or evil outsiders, nor may they attempt to resolve
      their differences peacefully with such creatures. Finally, unlawful acts in
      general offend Erich, and his followers must always follow the code of chivalry,
      even when unmounted and unarmoured.\n
      __Goblinoids are not considered people in Erich's theology, and thus certain
      strictures are lifted when fighting them: they may be attacked while fleeing,
      poisoned or defeated with base trickery. In Erich's cosmology, the ideals of
      chivalry and law apply only to humans, demihumans and similarly refined
      creatures. Note that Erich's worldview does not influence a worshipper's
      objective alignment, only their standing with Erich.\n
      __<10>Blessings:<2> Erich will heal, ease hunger or smite enemies
      for any follower. More loyal servants find that he will (in order
      of increasing favour) purify the body, remove fatigue, identify
      weapons, armour and shields, lift curses, replace lost spellbooks,
      replenish mana and even raise the dead.\n
      __Erich's more permanent blessings include courage and protection
      from treacherous attacks, skill at horsemanship, landkeeping and
      cowing the peasantry, the ability to conjure a phantom steed
      and a fearsome warcry.";
    Domains: $"Domination", $"Guardian", $"Law", $"Nobility", $"Protection;domain", $"War";
    Flags: GF_LAWFUL, GF_FORCE_TURN;
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|Let there be zeal in your heart, truth in your words, honour in 
               your deeds and blood upon your sword!|",
          #if 0
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          MSG_BADSAC1
          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
          
          
          MSG_BLESSING1
          MSG_BLESSING2
          MSG_BLESSING3
          MSG_BLESSING4
          MSG_BLESSING5
          MSG_BLESSING6
          MSG_BLESSING7
          MSG_BADSAC5
            "A proud voice booms, |Thou stains my altar with the blood of
              that trash?! Suffer, churl!|"
              
          MSG_CUSTOM1
            "A proud voice booms, |I will cleanse this filth from your presence!|"
          MSG_CUSTOM2
            "A proud voice intones, |I cannot aid you against worthy foes. You must
               fight your own battles, with my blessing.|"
          MSG_CUSTOM3
            "A proud voice proclaims, |Use this and find glory in my name!|"
          MSG_CUSTOM4
            "A proud voice scorns, |Vile cur, suffer for thy cowardice!|"
          MSG_CUSTOM5
            "An angry voice declades, |I deal not with filth and base creatures!|"
          
          MSG_CROWNED
          #endif
      * SACRIFICE_LIST
          MA_DRAGON                       20
          (MA_OUTSIDER + (MA_EVIL*256))   20
          MA_BEAST                        10
          (MA_DEMIHUMAN + (MA_CHAOTIC*256)) 10
          MA_GOBLINOID                    SAC_ABOMINATION,
      * GOD_RELATIONS
          REL_DEFAULT   3     0
          $"Immotian" $"Xavias" $"Mara" $"Ekliazeh" 0 0
          $"Kysul" $"Xel" $"Khasrach" $"The Multitude" 7 1,
      * CROWNING_GIFTS
          $"Nine Lives Stealer",
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          54000
          96000
          102000
          250000,
      * AID_CHART  
          AID_HEAL        P_HIGH       0   
          AID_FEED        P_MODERATE   0        
          AID_SMITE       P_LOW        0   
          AID_PURIFY      P_MODERATE   100  
          AID_REFRESH     P_LOW        100      
          AID_IDENTIFY    T_WEAPON     200
          AID_IDENTIFY    T_ARMOUR      200
          AID_IDENTIFY    T_SHIELD     200
          AID_UNCURSE     P_LOW        500
          AID_NEWBOOK     P_HIGH       500
          AID_MANA        P_MODERATE   1000
          AID_RESURRECT   P_MODERATE   2000;    
    Constants:
      * VOICE_COLOUR PURPLE,
      * ALTAR_COLOUR PURPLE,
      * HOLY_SYMBOL $"Erich;symbol",
      * CHOSEN_WEAPON $"light lance",
      * CHOSEN_WEAPON_QUALITY IQ_ADAMANT,
      * INTERVENTION_COST 7,
      * RESURRECTION_COST 15,
      * ALTAR_COST 5,
      * PRAYER_TIMEOUT 12,
      * MIN_RAISE_LEVEL 8,
      * MIN_CONVERT_FAVOUR 200,
      * PRAYER_DC 10,
      * LEVEL_BLEEDOFF 7,
      * TOLERANCE_VAL 0,
      * GODPULSE_INTERVAL 30,
      * GODANGER_INTERVAL 10,
      * PERSONAL_ALIGN (AL_LAWFUL|AL_EVIL),
      * LAY_MULTIPLIER 10;
    Grants:
      Ability[CA_NOBLE_AEGIS,+1] at every 2nd level starting at 1st,
      Stati[SAVE_BONUS,SN_FEAR,+4] at 1st level,
      Stati[EXTRA_SKILL,SK_RIDE] at 2nd level,
      Stati[EXTRA_SKILL,SK_SENESCHAL] at 2nd level,
      Stati[EXTRA_SKILL,SK_INTIMIDATE] at 2nd level,
      Stati[SUSTAIN,A_CHA] at 3rd level,
      Stati[SUSTAIN,A_CON] at 3rd level,
      Ability[CA_INNATE_SPELL,$"Phantom Steed"] at 4th level,
      Stati[EXTRA_FEAT,FT_WARCRY] at 5th level,
      Stati[SKILL_BONUS,SK_INTIMIDATE,+4] at 6th level,
      Ability[CA_INNATE_SPELL,$"Righteous Might"] at 7th level,
      Stati[EXTRA_FEAT,FT_BATTLEFIELD_INSPIRATION] at 8th level,
      Stati[EXTRA_FEAT,FT_CLEAVE] at 8th level,
      Ability[CA_INNATE_SPELL,$"Order's Wrath"] at 9th level;
    On Event EV_GIVE_AID {
      bool found; hObj hMon;
      found = false;
      if (e.EParam == AID_SMITE) {
        for (hMon=EMap->FirstThing();hMon;hMon=EMap->NextThing())
          if (hMon->isCreature() && EActor->DistFrom(hMon) <= 12)
            if (hMon->isHostileTo(EActor) && hMon->isMType(MA_GOBLINOID))
              {
                if (!found)
                  EActor->GodMessage($"Erich",MSG_CUSTOM1);
                found = true;
                hMon->IDPrint("You are consumed in a column of searing flame!",
                   "The <hObj> is consumed in a column of searing flame!", hMon);
                ThrowDmg(EV_DAMAGE,AD_FIRE,(EActor->ChallengeRating()+3)d10,
                            "the wrath of Erich", hMon, hMon);
              }
        if (!found)
          EActor->GodMessage($"Erich",MSG_CUSTOM2);
        return DONE;
        }
      return NOTHING;
      },
    EV_RETRIBUTION {
      EActor->IDPrint("A great, spectral mailed fist appears and smites you!",
                        "A great, spectral mailed fist appears and smites the <hObj>!",EActor);
      ThrowDmg(EV_DAMAGE,AD_BLUNT,(e.EParam)d10,"the fury of Erich",
                  EActor, EActor);
      return DONE;
      },
    EV_GODPULSE {
      hObj hItem; rID iID;
      switch (1d20)
        {
          case 1: case 2: case 3:
            iID = $"long sword";
           break;
          case 4:
            iID = $"field plate armour";
           break;
          case 5:
            iID = $"plate mail";
           break;
          case 6: case 7: case 8:
            iID = $"kite shield";
           break;
          case 9:
            iID = $"ring mail";
           break;
          case 10:
            iID = $"scale mail";
           break;
          case 11:
            iID = $"banded mail";
           break;
          case 12:
            iID = $"greatsword";
           break;
          case 13: case 14:
            iID = $"light lance";
           break;
          case 15:
            iID = $"morningstar";
           break;
          case 16:
            iID = $"heavy mace";
           break;
          case 17:
            iID = $"bastard sword";
           break;
          case 18:
            iID = $"broadsword";
           break;
          case 19:
            iID = $"bolas";
           break;
          case 20:
            iID = $"long bow";
           break;
        }
      hItem = GenDungeonItem(IG_GOOD,iID,EActor->ChallengeRating()+4,20);
      EActor->GodMessage($"Erich", MSG_CUSTOM3);
      EActor->GainItem(hItem,false);
      return DONE;
      },
    EV_ANGER_PULSE {
      if (EActor->HasEffStati(ADJUST_SAC,$"Erich's Disfavour"))
        return NOTHING;
      EActor->GodMessage($"Erich", MSG_CUSTOM4);
      ThrowEff(EV_EFFECT,$"Erich's Disfavour",EActor,EActor);
      return DONE;
      },
    EV_PREREQ {
      if (EActor->isMType(MA_GOBLINOID))
        {
          EActor->GodMessage($"Erich", MSG_CUSTOM5);
          return NOMSG;
        }
      return NOTHING;
      },
    GODWATCH(EV_GAIN_STATI) {
      if (e.EParam == AFRAID)
        EActor->Transgress($"Erich",2,false,"becoming afraid");
      if (e.EParam == HIDING)
        EActor->Transgress($"Erich",2,false,"skulking in shadows");
      return NOTHING;
      },
    GODWATCH(PRE(EV_STRIKE)) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (GetHandle(EItem) != NULL_OBJ)
        if (EItem->HasStati(POISONED) && !EVictim->isMType(MA_GOBLINOID))
          EActor->Transgress($"Erich",1,false,"using poison");
      if (GetHandle(EItem2) != NULL_OBJ)
        if (EItem2->HasStati(POISONED) && !EVictim->isMType(MA_GOBLINOID))
          EActor->Transgress($"Erich",1,false,"using poison");
      return NOTHING;
      },
    GODWATCH(EV_ALIGNED) {
      if (e.EParam & AL_NONLAWFUL) {
        if (GetHandle(EVictim) != NULL_OBJ)
          if (EVictim->isCreature() && !(EVictim->isMType(MA_DEMIHUMAN) ||
              EVictim->isMType(MA_HUMAN) || EVictim->isMType(MA_CELESTIAL) ||
              EVictim->isMType(MA_DRAGON) || EVictim->isMType(MA_MYTHIC)))
            return NOTHING;
        EActor->Transgress($"Erich",(e.vMag+1)/2,false,"unlawful act");
        }
      return NOTHING;
      },
    GODWATCH(EV_FAST_TALK), GODWATCH(EV_DISTRACT) {
      if (!EVictim->isMType(MA_GOBLINOID)) 
        EActor->Transgress($"Erich",2,false,"base treachery");
      return NOTHING;
      },
    GODWATCH(EV_SURRENDER) {
      if (EVictim->isMType(MA_GOBLINOID) || EVictim->isMType(MA_OUTSIDER+(MA_EVIL*256)) ||
             EVictim->isMType(MA_CHAOTIC)) 
        EActor->Transgress($"Erich",10,false,"surrendering to filth");
      else
        EActor->Transgress($"Erich",3,false,"surrendering");
      return NOTHING;
      },       
    GODWATCH(EV_QUELL), GODWATCH(EV_ENLIST) {
      if (EVictim->isMType(MA_GOBLINOID) || EVictim->isMType(MA_OUTSIDER+(MA_EVIL*256)) ||
             EVictim->isMType(MA_CHAOTIC))
        EActor->Transgress($"Erich",7,false,"showing mercy to filth");
      else if (!EVictim->isMType(MA_DEMIHUMAN))
        EActor->Transgress($"Erich",2,false,"showing mercy to subhumans");
      return NOTHING;
      },
    GODWATCH(POST(EV_REQUEST)) {
      switch (e.EParam) 
        {
          case SK_INTIMIDATE:
            break;
          case SK_BLUFF:
            if (!EActor->isMType(MA_GOBLINOID))
              EActor->Transgress($"Erich",2,false,"base treachery");
           break;
          case SK_DIPLOMACY:
            if (EVictim->isMType(MA_GOBLINOID) || EVictim->isMType(MA_OUTSIDER+(MA_EVIL*256)) ||
                   EVictim->isMType(MA_CHAOTIC))
              EActor->Transgress($"Erich",5,false,"associating with filth");
           break;
        }
      return NOTHING;
      },
    GODWATCH(POST(EV_COW)) {
      if (EVictim->HasStati(AFRAID) && !EVictim->HasEffStati(EFF_FLAG1,$"Erich"))
        {
          EVictim->GainPermStati(EFF_FLAG1,EActor,SS_MISC,0,0,$"Erich");
          EActor->gainFavour($"Erich",10*max(1,EVictim->ChallengeRating()));
        }
      return NOTHING;
      };
    Flags: GF_COMBAT_ANGER;
  }

Effect "Erich's Disfavour" : EA_INFLICT
  { xval: ADJUST_SAC; yval: A_AID; pval: -4; 
    Flags: EF_PERSISTANT;
    Desc: "Erich's disfavour causes you to suffer a -4 penalty on all
      rolls while in combat.";
    On Event EV_MAGIC_HIT
        "You feel threatened.";
  }   

/* Both Essiah and Maeve had roses! Oops! */
AI_SYMBOL Effect "Essiah;symbol" : EA_GENERIC
   { Flags: EF_NOGEN; 
    Desc: "Essiah's holy symbol is a tiny clay statue of two humanoid figures 
      (of any combination of genders) intertwined in an erotic embrace." ; } 

God "Essiah"
  {
    Domains: $"Beauty", $"Good", $"Liberation", $"Luck", $"Passion", $"Travel"; 
    Desc: "<15>Goddess of Life, Journeys, Joy and Erotic Love<11>
      \n__Beauty, Good, Liberation, Luck, Passion, Travel. The Scourge. Warning Weapons.<2>
      \n__Portrayed as a jovial and nurturing (albiet carnally-minded and
      crass-mouthed) older woman, Essiah is the goddess who governs all the
      parts of life which are most worth treasuring. Existance is too short
      and too valuable, she teaches, to squander it upon banalities like
      status games, provincial tunnel-vision or complacent obedience.  She
      favours those who choose to take risks in pursuit of a dream or
      desire, as long as those risks aren't foolhardy enough to show a lack
      of respect for life. She is the patron goddess of gnomes (along with
      Xavias) and
      adventurers -- especially those who choose to adventure simply for
      the joy of seeing wonderous things rather than more mercenary souls.
      Her clerics are free spirits that cannot be tied down to any one
      locale, seeing a new adventure on every horizon and having a man (or
      woman) waiting in every port.
      \n__Essiah is Mara's older sister, and her counterpoint in all
      things.  The two goddesses, extreme extrovert and extreme introvert,
      have very different viewpoints on love, and on what is valuable in
      life, but support each other loyally none the less. Essiah is also a
      staunch ally of Semirath, and frequently defends him against the
      harsh accusations of Erich in Immotian's grand celestial palace.
      Maeve favours Essiah, but Essiah does not return that friendship --
      Essiah's brood take responsibility for their actions, while Maeve's
      could care less. Her priesthood has no formal temples or ranks,
      gathering together in the wilderness on nights of a full moon for
      wild baccanals where stories of exotic lands are shared and priests
      drive themselves into an ecstatic state in the hopes of receiving a
      vision from their goddess.
      \n__Essiah asks that her clerics constantly seek out new experiences,
      always yearning for the land that can be seen on the horizon. The
      greatest sin in Essiah's theology is the betrayal of a true friend,
      and the greatest virtue is embracing (and, equally importantly,
      understanding) one's own passions. Essiah does not deny the darker
      passions like hate, grief, hurt or anger, nor does she sugar-coat
      them. She encourages her followers to embrace their feelings, dark or
      light, and to act on and through them (within the bounds of moral
      conduct), provided that the darker passions are never allowed to
      overwhelm or extinguish joy or delight. Sometimes even the nicest
      people have to do something ugly, after all.
      \n__Essiah's holy symbol is a tiny statue of two humanoid figures (of any
      combination of genders) intertwined in an erotic embrace. Her chosen weapon is
      the scourge -- her clerics do not do violence lightly, but when they do
      they aim to <10>hurt<2>! She grants access to the domains of Beauty,
      Good, Liberation, Luck, Passion and Travel. She is Chaotic Good,
      and accepts followers of any Good alignment.\n
      __<10>Worship:<2> Essiah accepts as sacrifices anything evil that is
      killed in accordance with the strictures of a Good alignment, though
      she especially glories in the offering of the bodies of creatures
      who degrade sexuality or represent sexual predation, such as
      vampires, succubi and incubi, evil nymphs or satyrs and so forth.
      She is pleased when her followers engage in activities that
      push them to their personal limits and leave them hot and sweaty,
      even in the unusual case where they don't take place in the
      bedroom. She is also pleased by exploration and discovery; the
      very act of traversing a lost city or ancient ruins pleases her.
      (Characters can monitor what percent of an area they've explored
      by checking their Journal). Finally, simple acts of goodness also
      please Essiah, as does resolving conflicts without violence.\n
      __Essiah is angered by evil acts, especially attacking non-hostile 
      creatures. She also dislikes her followers remaining in one place 
      for too long -- in game terms, her favour can be lost if a character 
      levels up more than twice in the same geographic area. (This clause 
      is not implemented in <9>Halls of the Goblin King<2>, for obvious 
      reasons.)\n
      __<10>Blessings:<2> Essiah cheerfully aids her followers after
      only a nominal sacrifice, healing their wounds, purifying their
      bodies, lifting curses, transporting them to safety, easing hunger,
      removing fatigue, replenishing the spirit, curing blindness and
      permanent wounds and deflecting especially lethal blows. She will
      also ressurrect the rare follower who has served her ethos with
      exceptional devotion.\n
      __Essiah grants her followers tutelage in alchemy and the physician's
      arts (that they might manufacture herbal contraceptives and 
      abortifacients to gain control over their own bodies), and the 
      ability to understand other people, making them better able to give 
      and receive consent and be empathetic lovers. She gifts more
      experienced followers with magically swift movement and freedom
      of action, preventing them from being restrained or paralyzed.
      (Since she has already given this gift as a racial blessing to
      the gnomish race, gnomes receive bonus feats instead.) She is
      also known to grant beauty, wisdom and influence over dreams.";
    Flags: GF_GOOD; 
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|The horizon awaits...|"
          #if 0
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          MSG_BADSAC1
          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
          
          
          MSG_BLESSING1
            "|I teach thee now to honour the feelings of thy lovers, and the
                crafts of herbs to control thine own body.|"
          MSG_BLESSING2
            "|May all thy journeys be swift and clear, if not uninteresting.|"
            
          MSG_BLESSING3
            "|I grant to thee the beauty to lead an entertaining life, and 
                further the wisdom to lead a good one.|"
          MSG_BLESSING4
            "|Let nothing impede thy freedom to move!|"
          MSG_BLESSING5
          MSG_BLESSING6
          MSG_BLESSING7
          MSG_CROWNED
          #endif
          ,
      * SACRIFICE_LIST
          MA_EVIL      5
          MA_EVIL      10
          MA_EVIL      10
          MA_CHOICE1   20
          MA_CHOICE1   20,
      * GOD_RELATIONS
          REL_DEFAULT   0 0
          $"Zurvash" $"Xel" $"Maeve" $"The Multitude" 5 1,
      * CROWNING_GIFTS
          $"Nine Lives Stealer",
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          54000
          96000
          102000
          250000,
      * AID_CHART  
          AID_HEAL       P_LOW       100
          AID_PURIFY     P_LOW       100
          AID_UNCURSE    P_LOW       100 
          AID_TELEPORT   P_MODERATE  100
          AID_FEED       P_LOW       100         
          AID_REFRESH    P_LOW       100
          AID_RESTORE    P_LOW       100
          AID_CURE       P_LOW       100
          AID_DEFLECT    P_LOW       100
          AID_RESURRECT  P_LOW       2500;    
    Constants:
      * VOICE_COLOUR MAGENTA,
      * ALTAR_COLOUR AZURE,
      * HOLY_SYMBOL $"Essiah;symbol",
      * CHOSEN_WEAPON $"scourge",
      * CHOSEN_WEAPON_QUALITY WQ_WARNING,
      * INTERVENTION_COST 4,
      * RESURRECTION_COST 15,
      * ALTAR_COST 5,
      * PRAYER_TIMEOUT 4,
      * MIN_RAISE_LEVEL 8,
      * MIN_CONVERT_FAVOUR 100,
      * PRAYER_DC 10,
      * LEVEL_BLEEDOFF 3,
      * TOLERANCE_VAL 5,
      * GODPULSE_INTERVAL 20,
      * GODANGER_INTERVAL 20,
      * PERSONAL_ALIGN (AL_CHAOTIC|AL_GOOD),
      * LAY_MULTIPLIER 4;
    Grants:
      Stati[EXTRA_SKILL,SK_APPRAISE] at 1st level,
      Stati[EXTRA_SKILL,SK_ALCHEMY] at 1st level,
      Stati[EXTRA_SKILL,SK_HEALING] at 1st level,
      Stati[SKILL_BONUS,SK_APPRAISE,+4] at 1st level,
      Stati[ADJUST_SAC,A_MOV,+4] at 2nd level,
      Ability[CA_RAPID_RIDING,+4] at 2nd level,
      Stati[ADJUST_SAC,A_MOV,+1] at every level starting at 3rd,
      Ability[CA_RAPID_RIDING,+1] at every level starting at 3rd,
      Stati[ADJUST_SAC,A_CHA,+1] at every 2nd level starting at 3rd,
      Stati[ADJUST_SAC,A_WIS,+1] at every 2nd level starting at 3rd,
      Stati[IMMUNITY,AD_PLYS] at 4th level,
      Stati[IMMUNITY,AD_STUK] at 4th level,
      Stati[IMMUNITY,AD_SLOW] at 4th level,
      Stati[IMMUNITY,AD_STON] at 4th level,
      Ability[CA_INNATE_SPELL,$"Dream"] at 5th level,
      Stati[EXTRA_FEAT,FT_SOULBLADE] at 6th level,
      Ability[CA_INNATE_SPELL,$"Lifesight"] at 7th level,
      Stati[EXTRA_FEAT,FT_GREATER_SOULBLADE] at 8th level;
    int32 oldExploreFavour;
    On Event EV_RETRIBUTION {
        EActor->IPrint("You feel afflicted.");
        EActor->GainPermStati(ADJUST_SAC,NULL,SS_CURS,A_CHA,-6,$"Essiah");
        EActor->GainPermStati(ADJUST_SAC,NULL,SS_CURS,A_FAT,-4,$"Essiah");
        return DONE;
      },
    EV_GODPULSE, EV_ANGER_PULSE {
      if (EActor->HasEffStati(EFF_FLAG1,$"Essiah Dream"))
        return ABORT;
      EActor->GainPermStati(EFF_FLAG1,NULL,SS_MISC,0,0,$"Essiah Dream");
      return DONE; 
      },
    POST(EV_REST) {
      if (EActor->isThreatened())
        return NOTHING;
      if (!EActor->HasEffStati(EFF_FLAG1,$"Essiah Dream"))
        return NOTHING;
      EActor->RemoveEffStati($"Essiah Dream");
      if (EActor->getGodAnger($"Essiah"))
        {
          EActor->IPrint("In your dreams, you relive all the suffering
            you have wrongfully brought to others!");
          ThrowDmg(EV_DAMAGE,AD_DACO,1d4,"the wrath of Essiah", EActor, EActor);
          EActor->cFP = -2;
          EActor->LoseMana(EActor->cMana()/2);
          EActor->Abuse(A_CON,3d10);
          EActor->CalcValues();
        }
      else if (1d12 <= EActor->getGodLevel($"Essiah"))
        {
          EActor->IPrint("Essiah appears to you in your dreams in the form
            you find most appealing, and beckons seductively.");
          if (!EActor->yn("Accept the embrace?"))
            { 
              EActor->IPrint("The goddess shrugs, smiles warmly without
                condemnation to you, and vanishes.");
              return DONE;
            }
          EActor->IPrint("You experience a feverish, erotic dream of
            great intensity. That was certainly a learning experience!");
          EActor->GainXP(10 * EActor->TotalLevel() *
                               (EActor->getGodLevel($"Essiah") + 4));
          EActor->Exercise(A_CHA,5d12,ECHA_ESSIAH,70);
          EActor->Exercise(A_CON,5d12,ECON_ESSIAH,70);
        }
      return DONE;
      },
    EV_CALC_FAVOUR {
      int32 newExploreFavour;
      newExploreFavour = EActor->TotalExploreFavour();
      if (newExploreFavour > oldExploreFavour)
        {
          EActor->gainFavour($"Essiah", newExploreFavour - 
            oldExploreFavour, false, true);
          oldExploreFavour = newExploreFavour;
        }
      e.EParam = (e.EParam * (10 + EActor->Mod(A_CHA))) / 10;
      return NOTHING;
      },
    EV_SACRIFICE {
      if (GetHandle(EVictim) == NULL_OBJ)
        return NOTHING;
    
      if (!EVictim->isMType(MA_EVIL))
        return SAC_ANGRY;
      
      if (EVictim->isMType(MA_VAMPIRE) ||
          EVictim->tmID == $"succubus" ||
          //EVictim->tmID == $"erinyes" ||
          EVictim->tmID == $"nymph" ||
          EVictim->tmID == $"grey nymph" ||
          EVictim->tmID == $"satyr")
        { e.EParam = MA_CHOICE1;
          return NOTHING; }
      
      if ( EVictim->HasStati(WAS_FRIENDLY) &&
           !EVictim->HasMFlag(M_IALIGN) )
        return SAC_ANGRY;
      
      return NOTHING;
      }, 
    GODWATCH(EV_ALIGNED) {
      if (e.EParam & AL_GOOD)
        EActor->gainFavour($"Essiah",25*e.vMag);
      if (e.EParam & (AL_NONGOOD|AL_EVIL))
        EActor->Transgress($"Essiah",(e.vMag + 1)/2,false,
          "evil act");
      return NOTHING;
      },
    /* Note Hardcoded Essiah Favour Fatigue clause elsewhere */
    GODWATCH(PRE(EV_HIT)) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      /* Stacks with Alignment Transgression */
      if (EVictim->isFriendlyTo(EActor) && !EVictim->HasMFlag(M_MINDLESS))
        EActor->Transgress($"Essiah",6,false,"betraying a friend"); 
      return NOTHING;
      },
    GODWATCH(POST(EV_QUELL)) { 
      if (!EVictim->isHostileTo(EActor))
        if (!(EVictim->isMType(MA_EVIL) && EVictim->HasMFlag(M_IALIGN)))
          EActor->gainFavour($"Essiah",max(1,EVictim->ChallengeRating())*20);
      return NOTHING;
      },
    EV_BLESSING {
      /* Gnomes already have innate free action, so give them
         something else to conpensate for the duplication. */
      if (EActor->getGodLevel($"Essiah") == 4)
        if (EActor->isMType(MA_GNOME))
          EActor->GainFeat(FT_FULL_LIST);
      return NOTHING;
      };
  }
  
Effect "Essiah Dream" : EA_GENERIC { }

AI_SYMBOL Effect "Hesani;symbol" : EA_GRANT
   { Flags: EF_NOGEN; Level: PLUS_3PER1;
    Desc: "Hesani's holy symbol is a topaz carved with the image of a moebius
      strip. This symbol shields its wearer from negative energy, granting
      +2 levels of necromantic damage resistance and a +1 bonus to save versus 
      death effects per magical plus it is imbued with. It also grants a +1 
      bonus to Turn checks for every two plusses. The symbol only functions
      for a worshipper of Hesani."; 
    xval: RESIST; yval: AD_NECR; pval: PLUS_2PER1; Flags: EF_NEEDS_PLUS; }
and EA_GRANT
  { xval: SAVE_BONUS; yval: SN_DEATH; pval: PLUS_1PER1; }
and EA_GRANT
  { xval: TURN_ABILITY; yval: MA_UNDEAD; pval: LEVEL_1PER2; } 
and EA_GRANT
  { xval: GTURN_ABILITY; yval: MA_UNDEAD; pval: LEVEL_1PER2; 
    On Event EV_MAGIC_HIT {
      if (EActor->getGod() != $"Hesani" &&
          !(EActor->HasAbility(CA_TRICK_MAGIC) &&                  
           ((EActor->SkillLevel(SK_USE_MAGIC) +          
             EActor->SkillLevel(SK_BLUFF)) > 20)))
        return DONE;
      return NOTHING;
      };
  } 


#define INCREASE_TENSION                                          \
  tension++;                                                      \
  switch(tension)                                                 \
    {                                                             \
      case 5:                                                     \
        EActor->IPrint("You feel a certain tension.");            \
        break;                                                     \
      case 10:                                                    \
        EActor->IPrint("You feel somewhat out of sync with the harmonies of the world."); \
        break;                                                     \
      case 15:                                                    \
        EActor->IPrint("You feel strongly out of sync with the harmonies of the world."); \
       break;                                                     \
    }                                                             


God "Hesani"
  {
    Domains: $"Fate", $"Weather", $"Healing;domain", 
             $"Magic", $"Succor", $"Sun"; 
    Desc: "<15>God of Light, Balance and Cycles<11>
      \n__Fate, Healing, Magic, Succor, Sun, Weather. Positive Energy.<2>
      \n__Everything, Hesani argues, is a cycle. Life, magic, seasons,
      sunrise and sunset -- all must have balance. Hesani is a compassionate
      god, perhaps the one diety most truly empathic to the sufferings of
      mortal beings. He seeks to preserve life at all costs, though undead
      are anathema to him. Hesani's power waxes an sunrise and sunset, when
      the cycle of the day comes to its natural zeniths. Clerics of Hesani
      often preside over childbirth, seeing it as the ultimate expression
      of the cyclic nature of human life.
      \n__Hesani was the patron of midwives in the years past, but his
      relation with the Midwives Guild and their politics has soured
      in recent years. He protects and provides for any who seek to
      preserve life, whether physician or midwife, though his clerics
      do not discuss this policy overly vocally. Hesani has a close
      relationship with Mara, and teaches his clergy that death is a
      necessary element of life -- to simply be accepted rather than 
      feared or sought out. Her practice of creating undead is highly
      distasteful to the god of life, however. Hesani's pacifistic morals,
      combined with his clerics' vocal opposition to the use of mindless
      undead in industry and civic maintenance, tends to cause his church
      to be seen as a fringe faith with ideals far out of touch with 
      reality.
      \n__Hesani's holy symbol is a topaz carved with the image of a moebius
      strip. He has no chosen weapon, but offers his priests the Domains of
      Fate, Healing, Magic, Succor, Sun and Weather. Hesani is Neutral Good 
      in alignment, and accepts clerics of any Good alignment.\n
      __<10>Worship:<2> Hesani does not accept the sacrifice of any living
      things, but treasures offerings of gold based on their symbolic
      similarity to the sun. Unlike most gods, repeated sacrifices of gold
      increasingly please Hesani. He is also pleased when his followers
      destroy undead (in a manner not contradicting a good alignment) or 
      peacefully resolve conflicts with other living things.\n
      __Hesani expects his followers to move in harmony with the natural
      flows of the world rather than fighting against them in dissonance.
      Violence against any living things increases this dissonance so 
      Hesani's worshippers are very reluctant to engage in it. Certain
      kinds of magic are more harmonious than others as well. Divination,
      Abjuration and Theurgy are naturally balanced arts and do not create
      disharmony. Enchantment, Thaumaturgy and Arcana are reasonably easy
      to perform in a manner harmonious with the interconnectedness of
      all things, assuming that the practicioner has taken time to gain
      knowledge of the natural world and its balances. Evocation, Weavecraft
      and Illusion are more difficult to perform in a balanced manner, but
      a very knowledgable mage can use them safely. Necromancy and spells
      with the Force descriptor, however, will always increase disharmony.\n
      __Hesani does not become angry over the creation of minor disharmony;
      a worshipper will feel increasing tension around him as he slips out
      of balance with the world, until finally the situation becomes serious
      enough that Hesani is angered. Growing tension dissipates as the
      follower spends days contemplating his place in the world and realigning
      himself with the harmonious flow of vital energies.\n
      __Hesani also expects his followers not to be reckless by moving 
      forward to quickly and challenging tasks beyond their level of skill.
      Patience and knowledge of limitations is highly valued by Hesani's
      clergy.\n
      __Though some very careful warriors can find favour with Hesani, he
      would never patronize those whose lives are ruled by rage and barbarity.
      Blind anger offends Hesani greatly.\n
      __<10>Blessings:<2> Hesani is quick to intervene on any petitioner's
      behalf, and will heal the injured, purify the body, carry followers
      away from harm, amelorate hunger, deflect especially deadly blows,
      clear the mind and replenish mana for any follower. After relatively
      minor sacrifices in his name, he will also remove curses, restore
      spent fatigue and cure blindness or permanent wounds, and slightly
      later replace lost spellbooks as well. His veteran followers can
      expect him to replenish the spirit and even resurrect them should
      they die. Hesani gives aid very casually in contrast with other
      gods; asking aid costs a petitioner comparatively very little favour.
      Being raised from the dead is far more costly, however, given the
      extent to which it disrupts the natural cycle.\n
      __Loyal followers of Hesani find that their lifestyle of natural
      harmony greatly increases the volume of mystical energy they can
      channel through their bodies. All Hesani worshippers also are
      exposed to his teachings concerning nature, interacting peacefully
      with other poeple, meditation and healing living things. Moving in
      harmony with the world also leads to the world upraising you in
      kind, and those who follow Hesani's path well find benefit from many
      lucky coincidences and general good fortune. More experienced 
      followers defend themselves through intuition, study alchemy and
      magical devices, learn spells to end conflict without violence and
      find themselves in increasing harmony with the natural world.";
    Flags: GF_GOOD; 
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|Walk in harmony with the world, and your prosperity shall
               multiply a thousand-fold. Fight against its tides, and
               they will tear your life asunder.|"
          MSG_CUSTOM1
            "|To embrace the path of harmony, one must first turn away
                from barbarism.|"
          #if 0
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          MSG_BADSAC1
          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
          
          
          MSG_BLESSING1
          MSG_BLESSING2
          MSG_BLESSING3
          MSG_BLESSING4
          MSG_BLESSING5
          MSG_BLESSING6
          MSG_BLESSING7
          MSG_CROWNED
          #endif
          ,
      * SACRIFICE_LIST
          (-T_COIN )   20
          MA_CHOICE1   SAC_UNWORTHY,
      * GOD_RELATIONS
          REL_DEFAULT   0     0
          $"Khasrach" $"Sabine" $"Zurvash" $"Xel" $"The Multitude"
             $"Asherath" $"Erich" 3 0,
      * CROWNING_GIFTS
          $"Nine Lives Stealer",
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          48000
          64000
          92000
          128000,
      * AID_CHART  
          AID_HEAL         P_LOW       0
          AID_PURIFY       P_LOW       0
          AID_UNCURSE      P_LOW       100
          AID_TELEPORT     P_LOW       0
          AID_FEED         P_LOW       0
          AID_DEFLECT      P_LOW       0         
          AID_REFRESH      P_LOW       100
          AID_RESTORE      P_LOW       1000
          AID_CURE         P_LOW       100         
          AID_CLARITY      P_LOW       0
          AID_RESURRECT    P_LOW       1500
          AID_NEWBOOK      P_MODERATE  250
          AID_MANA         P_LOW       0;    
    Constants:
      * VOICE_COLOUR YELLOW,
      * ALTAR_COLOUR SKYBLUE,
      * HOLY_SYMBOL $"Hesani;symbol",
      * INTERVENTION_COST 1,
      * RESURRECTION_COST 10,
      * ALTAR_COST 3,
      * PRAYER_TIMEOUT 4,
      * MIN_RAISE_LEVEL 5,
      * MIN_CONVERT_FAVOUR 100,
      * PRAYER_DC 10,
      * LEVEL_BLEEDOFF 12,
      * TOLERANCE_VAL 5,
      * GODPULSE_INTERVAL 10,
      * GODANGER_INTERVAL 10,
      * PERSONAL_ALIGN (AL_GOOD),
      * LAY_MULTIPLIER 5;
    Grants:
      Stati[ADJUST_SAC,A_MAN,+4] at every level starting at 1st,
      Stati[EXTRA_SKILL,SK_KNOW_NATURE] at 1st,
      Stati[EXTRA_SKILL,SK_DIPLOMACY] at 1st,
      Stati[EXTRA_SKILL,SK_HEAL] at 1st,
      Stati[EXTRA_SKILL,SK_CONCENTRATION] at 1st,
      Stati[ADJUST_SAC,A_LUC,+1] at 1st,
      Ability[CA_INNATE_SPELL,$"Sanctuary"] at 2nd,
      Stati[EXTRA_FEAT, FT_ZEN_DEFENSE] at 2nd,
      Ability[CA_ARCANE_TRICKERY,+1] at every 3rd level starting at 3rd,
      Ability[CA_INNATE_SPELL,$"Deep Slumber"] at 3rd,
      Stati[SUSTAIN,A_LUC,+1] at every level starting at 3rd,
      Stati[EXTRA_SKILL,SK_USE_MAGIC] at 4th,
      Stati[EXTRA_SKILL,SK_ALCHEMY] at 4th,
      Stati[NEUTRAL_TO,MA_PLANT] at 4th,
      Stati[NEUTRAL_TO,MA_ANIMAL] at 4th,
      Ability[CA_INNATE_SPELL,$"Ethereal Jaunt"] at 5th,
      Ability[CA_INNATE_SPELL,$"Benevolence"] at 5th,
      Ability[CA_WEAPON_IMMUNITY,+1] at 6th,
      Ability[CA_INNATE_SPELL,$"Cure Serious Wounds"] at 7th,
      Ability[CA_WEAPON_IMMUNITY,+1] at 8th;
    int32 tension;
    
    #define HANDLE_TENSION \
      if (tension >= 20) EActor->Transgress($"Hesani",1,false,"living out of harmony");
        
    On Event EV_RETRIBUTION {
      EActor->IPrint("You feel very depleted.");
      EActor->LoseMana(2000,true);
      EActor->cFP = min(EActor->cFP,-2);
      EActor->GainTempStati(ADJUST_SAC,NULL,SS_MISC,-2,A_STR,-6);
      return DONE;
      },
    EV_GODPULSE, EV_ANGER_PULSE {
      if (EMap->Depth > 1 && EActor->TotalLevel() < 11)
        if (EMap->Depth > (EActor->TotalLevel() - 2))
          EActor->Transgress($"Hesani",1,false,"lack of patience");        
      if (e.Event == EV_GODPULSE)
        {
          EActor->IPrint("Natural flows replenish you.");
          EActor->GainMana(10d10);
        }
      else
        {
          EActor->IPrint("Moving against the currents of the world, you
                    feel depleted.");
          EActor->LoseMana(EActor->cMana()/2,true);
          EActor->cFP = max(EActor->cFP-2,-2);
        }
      return DONE;
      },
    EV_SACRIFICE {
      if (GetHandle(EItem) != NULL_OBJ)
        if (EItem->Material() != MAT_GOLD)
          e.EParam = MA_CHOICE1;
      return NOTHING;
      },
    EV_PREREQ {
      if (EActor->LevelAs($"barbarian") == EActor->TotalLevel())
        {
          EActor->GodMessage($"Hesani", MSG_CUSTOM1);
          return NOMSG;
        }
      return NOTHING;
      },
    GODWATCH(EV_DEATH) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (EVictim->isMType(MA_UNDEAD) &&
          EVictim->isMType(MA_EVIL) &&
          EVictim->HasMFlag(M_IALIGN))
        EActor->gainFavour($"Hesani",25*max(1,EVictim->
                  ChallengeRating()), false, true);
      if (EActor->GodID != $"Hesani")
        return NOTHING;
      if (EVictim->isMType(MA_LIVING))
        {
          INCREASE_TENSION
          INCREASE_TENSION
          if (EVictim->isMType(MA_SAPIENT))
            { INCREASE_TENSION }
          HANDLE_TENSION
        }
      return NOTHING;
      },
    GODWATCH(EV_ALIGNED) {
      if (e.EParam & AL_NONGOOD)
        EActor->Transgress($"Hesani",e.vMag,false,"evil act");
      return NOTHING;
      },
    GODWATCH(EV_CAST), GODWATCH(EV_INVOKE) {
      if (EActor->GodID != $"Hesani")
        return NOTHING;
      if (e.eID->Schools & (SC_NEC|SC_FORCE))
        {
          INCREASE_TENSION
          INCREASE_TENSION
          INCREASE_TENSION
          HANDLE_TENSION
        }
      else if (e.eID->Schools & (SC_EVO|SC_WEA|SC_ILL))
        {
          if (!EActor->SkillCheck(SK_KNOW_NATURE,15,false))
            { INCREASE_TENSION
              INCREASE_TENSION
              HANDLE_TENSION }
        }
      else if (e.eID->Schools & (SC_ENC|SC_THA|SC_ARC))
        {
          if (!EActor->SkillCheck(SK_KNOW_NATURE,10,false))
            { INCREASE_TENSION
              HANDLE_TENSION }
        }
      else
        {
          /*
          White Magic:
            Divination
            Abjuration
            Theurgy
          */
        }
      return NOTHING;
      },
    GODWATCH(POST(EV_REST)) {
      if (tension && !EActor->isThreatened() &&
           !(EActor->getGodFlags($"Hesani") & (GS_FORSAKEN|GS_ANATHEMA)))
        {
          tension = max(0,tension-6);
          EActor->IPrint("You feel <hText>your equilibrium return.",
                 tension ? "some of " : "");
        }
      return NOTHING;  
      },
    GODWATCH(POST(EV_QUELL)) { 
      if (!EVictim->isHostileTo(EActor))
        EActor->gainFavour($"Hesani",max(1,EVictim->ChallengeRating())*40);
      return NOTHING;
      },
    EV_GAIN_STATI {
      if (e.EParam == RAGING)
        EActor->Transgress($"Hesani",2,false,"entering a rage");
      return NOTHING;
      },
    EV_CALC_FAVOUR {
      /* Favour penalty for characters with barbarian levels */
      e.EParam = (e.EParam * (EActor->TotalLevel()*2 - EActor->LevelAs($"barbarian")))
                    / EActor->TotalLevel()*2;
      return NOTHING;
      };
  }

AI_SYMBOL Effect "Immotian;symbol" : EA_GENERIC
   { Flags: EF_NOGEN; 
    Desc: "Immotian's holy symbol is a ruby (or red glass globe, for peasants)
      encased in a thick band of cold-wrought iron."; }


God "Immotian"
  {
    Domains: $"Community", $"Fire", $"Knowledge", $"Law", $"Protection;domain", $"Succor";
    Desc: "<15>God of Purity and Community Cleanliness<11>\n
      __Community, Fire, Knowledge, Law, Protection, Succor. The Heavy Mace. Flaming Weapons.<2>\n
      __An austere and distant deity, Immotian is the head of the Kinlands
      pantheon, and his (or, on alternating occasions, her) worship has
      grown beyond a simple priesthood to become an integral part of the
      existance of every Kinlander. All good peoples must pay homage to
      the immaculate purity and correctness of Immotian -- to do otherwise
      is heresy, and Immotian's church has enough political power to force
      even the clergy of other gods to toe the line, at least on the
      surface. Demanding and judgemental, the core theology of Immotian's
      worship is a set of rigorous codes governing hygene, dietary restrictions,
      sexual practices and agricultural standards. Immotian's theology
      places him above all other gods not only in terms of power, but in
      the sense of being a qualitatively different being -- most gods are
      fallible servants of true divinity, but Immotian itself is perfect,
      having been generated by the union of fire and light, never having
      been tainted by the touch of matter (or, metaphorically, worldly
      desires of any kind).\n
      __Immotian has no humanoid form, and his church is strictly aniconic,
      viewing any attempt to anthropomorphize their diety as blasphemy.
      He is metaphorically represented by the consuming power of flame,
      and fire plays a central part in his worship, from the vast bonfire
      that burns eternally at the heart of every one of his temples to the
      red-hot irons his clergy use to burn impurities bothh from themselves
      and from any sinners they can convince to undergo this 'purification'.
      More than anything, Immotian hates Maeve, who represents deviance from
      the Law, selfish desires and chaos. While the church officially condemns
      such acts, individual clerics of Immotian have been known to commit hate
      crimes against elves, and to openly advocate the genocide of all the
      darkling races (drow, orcs, goblins, kobolds, etc). Clerics of Immotian
      adventure in the hopes of scouring (whatever they perceive as) evil from
      the planet utterly and relentlessly.\n
      __The church of Immotian is centered around the ideal of community, and
      attempts to involve everyone nearby in its services and rituals. The
      strength (and homogenity) of a community is very important to Immotian,
      and his clerics are always expected to think in terms of doing what is
      best for the group, rather than the individual. Filial piety is very
      important to Immotites; the purpose of a child is to serve the agenda
      of his parents to the best of his ability, without quention. It is the
      duty of every member of the community to excise any impure elements
      from the body of the community as a whole, before they can lead the
      whole group into sin. The most famous aspect of this is the church's
      continual attempt to force cities to bring about a prohibition on
      mead and ales.\n
      __Immotian's holy symbol is a ruby (or red glass globe, for peasants)
      encased in a thick band of cold-wrought iron. Immotian is (barely) Lawful
      Neutral, though his church frequently veers to the darker side of the
      alignment scale in its politics. His chosen weapon is the heavy mace,
      and his Domains are Community, Fire, Knowledge, Law, Protection and Succor.\n
      __<10>Worship:<2> As a being of perfect purity, Immotian does not accept 
      the sacrifice of living things on his altars. Instead, he encourages his 
      clerics to sacrifice arcane spellbooks, wands, staves and other instruments 
      of sorcery or profane magic. He is also pleased when his followers destroy
      undead, fiends and aberrations, though even these are not to be given as
      sacrifices. His clerics must adhere to a very strict code -- they must 
      remain chaste, free of diseases, never cast arcane spells, avoid gambling 
      or drinking and preferably enforce these values on anyone else around them. 
      Creatures with ties to elemental fire (other than dragons and fiends) are 
      sacred to Immotian, and worshippers should also avoid destroying them
      under any circumstances. Finally, disease is deeply anathema to Immotian,
      and his followers must never become diseased.\n
      __<10>Blessings:<2> Immotian will purify the body of anyone who prays to
      him, provided they haven't angered him by violating his ethos. He will
      heal and cure blindness or permanent wounds for a casual follower, and
      replenish the spirit or restore fatigue for a mire loyal one. True 
      devotees can expect him to, in order, lift curses, raise them should
      they die, protect them from deadly blows and smite their enemies.\n
      __Immotian grants a loyal follower kinship to flame, allowing them to
      resist injury from it and wield flame magic more skillfully. Devoted
      worshippers also gain healing powers, allowing them to heal wounds as
      paladins do, as well as curing disease and poison. Curing the disease
      of a neutral creatures pleases Immotian, though using magic or weapons
      which cause disease conversely angers him greatly.";
    Flags: GF_LAWFUL, GF_FORCE_TURN;
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|The flame of purity lights the path to righteousness!|"
          MSG_CUSTOM7
            "You feel Immotian is pleased with the community you have built
              and will not strain it further by enlarging it."
          MSG_BADSAC8
            "|Barbarian! Thou hast stained My altar with blood! This is an
               abomination of the highest order!|"
          
          MSG_CUSTOM3
            "|Blessed is thee who shares kinship with the spirits of flame!|"
          MSG_CUSTOM4
            "|Let no unlawful villain lay hands upon my follower!|" 
          MSG_CUSTOM1
            "|Accursed be those who strike at believers!|"
          MSG_CUSTOM5
            "|I curse thee, wayward follower: let thy sweetest water taste as
                bitter as a clotted blood of thine enemies!|"
          MSG_CUSTOM6
            "|I curse thee, wayward follower: a plague upon thy fields!|"
          #if 0
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          MSG_BADSAC1
          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
                    
          MSG_BLESSING1
            "|Walk in the light of My truth, and no flames shall burn thee!|"
          MSG_BLESSING2
          MSG_BLESSING3
          MSG_BLESSING4
          MSG_BLESSING5
          MSG_BLESSING6
          MSG_BLESSING7
          MSG_CROWNED
          #endif
          ,
      * SACRIFICE_LIST
          (-T_BOOK)          20
          (-T_BOOK)          20
          (-T_BOOK)          20
          (-T_WAND)          20
          (-T_WAND)          20
          MA_CHOICE1         10
          MA_CHOICE1         10
          MA_HAS_BLOOD       SAC_ABOMINATION,
      * GOD_RELATIONS
          REL_DEFAULT   3 0
          $"Asherath" $"Aiswin" $"Xel" 1 0
          $"Xavias" $"Erich" $"Ekliazeh" $"Hesani" 0 0,
      * CROWNING_GIFTS
          $"Nine Lives Stealer",
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          54000
          96000
          102000
          250000,
      * AID_CHART  
          AID_PURIFY         P_LOW       0
          AID_HEAL           P_LOW       100
          AID_CURE           P_LOW       100
          AID_REFRESH        P_MODERATE  500
          AID_RESTORE        P_MODERATE  500
          AID_UNCURSE        P_LOW       1000
          AID_RESURRECT      P_LOW       1500
          AID_DEFLECT        P_LOW       1500
          AID_SMITE          P_HIGH      2500;
    Constants:
      * VOICE_COLOUR PINK,
      * ALTAR_COLOUR RED,
      * HOLY_SYMBOL $"Immotian;symbol",
      * CHOSEN_WEAPON $"heavy mace",
      * CHOSEN_WEAPON_QUALITY WQ_FLAMING,
      * INTERVENTION_COST 9,
      * RESURRECTION_COST 7,
      * ALTAR_COST 3,
      * PRAYER_TIMEOUT 7,
      * MIN_RAISE_LEVEL 6,
      * MIN_CONVERT_FAVOUR 100,
      * PRAYER_DC 15,
      * LEVEL_BLEEDOFF 4,
      * TOLERANCE_VAL 2,
      * GODPULSE_INTERVAL 10,
      * GODANGER_INTERVAL 15,
      * PERSONAL_ALIGN (AL_LAWFUL),
      * LAY_MULTIPLIER 3;
    Grants:
      Stati[RESIST,AD_FIRE,+5] at 1st level,
      Stati[RESIST,AD_FIRE,+2] at 2nd level,
      Stati[RESIST,AD_FIRE,+2] at 3rd level,
      Stati[RESIST,AD_FIRE,+2] at 4th level,
      Stati[RESIST,AD_FIRE,+2] at 5th level,
      Stati[BONUS_SCHOOL_CASTING_LEVEL,SC_FIRE,+1] at every 2nd level starting at 2nd,
      Ability[CA_LAY_ON_HANDS,+1] at every level starting at 2nd,
      Ability[CA_INNATE_SPELL,$"Cure Disease"] at 3rd level,
      Ability[CA_INNATE_SPELL,$"Neutralize Poison"] at 3rd level,
      Ability[CA_SACRED_AURA,+1] at every level starting at 4th,
      Ability[CA_INNATE_SPELL,$"Celestial Aid"] at 4th level,
      Ability[CA_INNATE_SPELL,$"Fire Shield"] at 5th level,
      Stati[IMMUNITY,AD_FIRE] at 6th level,
      Stati[ADJUST_SAC,A_MR,+5] at 7th level,
      Stati[ADJUST_SAC,A_MR,+3] at every level starting at 8th,
      Stati[IMMUNITY,AD_DISE] at 8th level,
      Stati[IMMUNITY,AD_POIS] at 9th level;
    On Event EV_GIVE_AID {
      hObj hMon; bool found;
      found = false;
      if (e.EParam == AID_SMITE) {
        for (hMon=EMap->FirstThing();hMon;hMon=EMap->NextThing())
          if (hMon->isCreature() && EActor->DistFrom(hMon) <= 12)
            if (hMon->isHostileTo(EActor))
              {
                if (!found)
                  EActor->GodMessage($"Immotian",MSG_CUSTOM1);
                
                found = true;
                if (hMon->ResistLevel(AD_STON) == -1)
                  hMon->IDPrint("You are unaffected.",
                                "The <hMon> is unaffected.");
                if (!hMon->SavingThrow(FORT,25,SA_DEATH|SA_MAGIC|SA_PETRI)) {
                  hMon->IDPrint("You are turned into a pillar of salt!",
                     "The <hObj> is transformed into a pillar of salt!", hMon);
                  hMon->Remove(true);
                  }
                else
                  hMon->IDPrint("You resist the transformation.",
                                "The <hMon> resists Immotian's wrath.", hMon);
              }
        return DONE;
        }
      return NOTHING;
      },
    EV_RETRIBUTION {
      /* Turn the granted fire resistance into cold resistance
         temporarily so that it doesn't protect you, but your
         Ring of Fire Resistance still does. */
      EActor->SetEffStatiVal(RESIST,$"Immotian",AD_COLD);
      EActor->SetEffStatiVal(IMMUNITY,$"Immotian",AD_COLD);
      EActor->IDPrint("You are enveloped in a pillar of flame!",
                        "The <hObj> is enveloped in a pillar of flame!",EActor);
      ThrowDmg(EV_DAMAGE,AD_FIRE,(e.EParam)d6,"the fury of Immotian",
                  EActor, EActor);
      EActor->SetEffStatiVal(RESIST,$"Immotian",AD_FIRE);
      EActor->SetEffStatiVal(IMMUNITY,$"Immotian",AD_FIRE);
      return DONE;
      },
    EV_GODPULSE {
      int16 enCR;
      if (EActor->isThreatened())
        {
          EActor->GodMessage($"Immotian",MSG_CUSTOM4);
          e.MM = MM_EMPOWER|MM_MAXIMIZE|MM_ENLARGE;
          e.isLoc = true;
          e.EXVal = EActor->x;
          e.EYVal = EActor->y;
          e.vCasterLev = 20;
          e.eID = $"Order's Wrath";
          ReThrow(EV_EFFECT, e);
          return DONE;
        }
      enCR = EActor->FixSummonCR(EActor->getGodLevel($"Immotian")+2,PHD_MAGIC);
      if (enCR <= 0) {
        EActor->GodMessage($"Immotian", MSG_CUSTOM7);
        EActor->gainFavour($"Immotian",4d50,false,true);
        return DONE; 
        }        
      e.vDuration = 30 + EActor->Mod(A_CHA)*5;
      EActor->GodMessage($"Immotian", MSG_CUSTOM3);
      
      EMap->thEnGenSummXY($"fire creatures", EN_CREATOR|EN_SUMMON|EN_SINGLE, 
        enCR, AL_NONEVIL, EActor, EActor->x, EActor->y);      
      return DONE;
      },
    EV_ANGER_PULSE
      {
        bool found; hObj it;
        switch (1d2)
          {
            case 1:
              /* Later, Terraform all nearby water squares into 
                 blood as well. */
              found = false;
              for (it=EActor->FirstInv();it;it=EActor->NextInv())
                if (it->isType(T_POTION))
                  {
                    if (!found) {
                      EActor->GodMessage($"Immotian",MSG_CUSTOM5);
                      found = true;
                      }
                    it->ieID = $"vial of blood;potion";
                    it->SetKnown(0);
                  }
              if (found)
                return DONE;
              /* If no potions left, drop through... */
            case 2:
              EActor->GodMessage($"Immotian",MSG_CUSTOM3);
              ThrowEff(EV_EFFECT,$"Insect Plague",EActor,EActor);
              return DONE;
          }
        return DONE;
      },
    GODWATCH(EV_ALIGNED) {
      if (e.EParam & AL_NONLAWFUL)
        EActor->Transgress($"Immotian",(e.vMag + 1)/2,false,"unlawful act");
      return NOTHING;
      },
    GODWATCH(EV_DEATH) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (EVictim->isMType(MA_FIRE) && !(EVictim->isMType(MA_EVIL) &&
              (EVictim->HasMFlag(M_IALIGN) || EVictim->isMType(MA_DRAGON))))
        EActor->Transgress($"Immotian",EVictim->HasStati(WAS_FRIENDLY) ? 5 : 2,
                  false, "harming a sacred fire creature");
      
      if (EVictim->isMType(MA_UNDEAD) || EVictim->isMType(MA_ABERRATION) ||
          EVictim->isMType(MA_DEMON) || EVictim->isMType(MA_DEVIL))
        EActor->gainFavour($"Immotian",max(1,EVictim->ChallengeRating())*10,false,true);
      return NOTHING;
      },
    GODWATCH(EV_CAST), GODWATCH(EV_INVOKE) {
      if (EActor->getSpellFlags(e.eID) & (SP_ARCANE|SP_SORCERY|SP_BARDIC))
        if (EActor->GodID == $"Immotian")
          EActor->Transgress($"Immotian",1,false,"using arcane magic");
          
      /* If you poison/infect someone, make sure you can't get favour for
         purifying them later. */
      if (e.eID == $"contagion" || e.eID == $"poison") {
        EVictim->GainPermStati(EFF_FLAG1,EActor,SS_MISC,0,0,$"Immotian");
        EActor->Transgress($"Immotian",3,false,"unclean magic");
        }
      return NOTHING;
      },
    EV_CALC_FAVOUR {
      int16 ml, tl;
      ml = EActor->LevelAs($"mage") +
           EActor->LevelAs($"loremaster") +
           EActor->LevelAs($"alienist") + 
           EActor->LevelAs($"bard") / 2;
      tl = EActor->TotalLevel();
      
      e.EParam = (e.EParam * (tl - ml)) / tl;
      return NOTHING;
      },
    GODWATCH(EV_HIT) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (GetHandle(EItem) != NULL_OBJ)
        if (EItem->HasStati(POISONED) || EItem->HasQuality(WQ_UNCLEAN))
          EVictim->GainPermStati(EFF_FLAG1,EActor,SS_MISC,0,0,$"Immotian");
      if (GetHandle(EItem2) != NULL_OBJ)
        if (EItem2->HasStati(POISONED) || EItem2->HasQuality(WQ_UNCLEAN))
          EVictim->GainPermStati(EFF_FLAG1,EActor,SS_MISC,0,0,$"Immotian");
      return NOTHING;
      },
    GODWATCH(EV_MAGIC_HIT) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            (GetHandle(ETarget) == NULL_OBJ) ||
            !ETarget->isCreature())
        return NOTHING;
      if ((e.eID == $"Cure Disease" && EVictim->HasStati(DISEASED)) || 
          (e.eID == $"Neutralize Poison" && EVictim->HasStati(POISONED)))
        if (!EVictim->HasEffStati(EFF_FLAG1,$"Immotian"))
      if (!(EVictim->isMType(MA_UNDEAD) || EVictim->isMType(MA_ABERRATION) ||
          EVictim->isMType(MA_DEMON) || EVictim->isMType(MA_DEVIL) ||
          EVictim->isMType(MA_GOBLINOID)))
          {
            EActor->gainFavour($"Immotian",EActor->
              ChallengeRating()*25,false,true);
            EVictim->GainPermStati(EFF_FLAG1,EActor,SS_MISC,0,0,$"Immotian");
          }
      return NOTHING;
      },
    GODWATCH(EV_GAIN_STATI) {
      if (e.EParam == DISEASED)
        EActor->Transgress($"Immotian",3,false,"becoming unclean");  
      return NOTHING;
      },
    EV_SACRIFICE {
      if (GetHandle(EItem) != NULL_OBJ)
        if (EItem->iID == $"staff")
          if (EItem->eID != NULL_ID)
            e.EParam = MA_CHOICE1;
      return NOTHING;
      };
  }
  
Effect "Celestial Aid" : EA_SUMMON
  { qval: Q_LOC; Purpose: EP_SUMMON; xval: MA_CELESTIAL;
    Flags: EF_DLONG, EF_SPECABIL, EF_XSUMMON;
    On Event EV_CALC_EFFECT {
      e.vDmg = EActor->getGodLevel($"Immotian") - 3 + 
                 EActor->Mod(A_CHA);
      return NOTHING;
      },
    PRE(EV_EFFECT) {
      if (!EActor->LoseFatigue(2,true))
        return ABORT;
      if (EActor->getGodAnger($"Immotian"))
        {
          EActor->IPrint("Nothing happens.");
          return DONE;
        }
      };
    Desc: "By invoking Immotian's name, a favoured follower can call
      upon the services of celestials in a time of need, at the cost
      of two Fatigue Points. Not all such creatures view Immotian's
      favourably, but they are compelled by His purity, and by ancient
      pacts, to obey the invoker.";  
  }

  
/* Just to get folks in trouble with the puritans... :) */
AI_POTION Effect "flask of fine mead" : EA_INFLICT
  {
    xval: CONFUSED; 
    Flags: EF_DLONG, EF_MUNDANE, EF_NAMEONLY;
    Desc: "Expensive stuff, this is.";
    On Event EV_MAGIC_HIT {
      EActor->IdentByTrial(EItem);
      EActor->Transgress($"Immotian",3,false,"drunkenness");
      EActor->Transgress($"Erich",1,false,"drunkenness");
      EActor->Transgress($"Hesani",1,false,"drunkenness");
      EActor->gainFavour($"Maeve", 50);
      EActor->gainFavour($"Essiah", 50);
      return NOTHING;
      };
  }

AI_POTION Effect "flask of fey wine" : EA_INFLICT
  {
    xval: ASLEEP; Level: 6; 
    Flags: EF_DLONG, EF_NAMEONLY;
    On Event EV_MAGIC_HIT {
      EActor->IdentByTrial(EItem);
      EActor->Transgress($"Immotian",3,false,"drunkenness");
      EActor->Transgress($"Erich",1,false,"drunkenness");
      EActor->Transgress($"Hesani",1,false,"drunkenness");
      EActor->gainFavour($"Maeve", 250);
      EActor->gainFavour($"Essiah", 250);
      return NOTHING;
      };
    Desc: "Fey wines are known to render into deep slumber any
      non-faerie who partakes of them.";
  }

AI_POTION Effect "vial of blood;potion" : EA_INFLICT
  {
    xval: NAUSEA;  
    Flags: EF_DSHORT, EF_NAMEONLY, EF_NOGEN;
    On Event EV_MAGIC_HIT {
      if (EItem->isKnown(KN_MAGIC))
        {
          EActor->IPrint("You have no desire to drink blood.");
          return ABORT;
        }
      EActor->IPrint("Bleagh! This tastes like blood!");
      SetSilence();
      EActor->IdentByTrial(EItem);
      UnsetSilence();
      EActor->Transgress($"Immotian",4,false,"drinking blood");
      return NOTHING;
      };
    Desc: "Once a potion, this vial has been transmuted into
      thick, worthless, clotted blood.";
  }
  

AI_SYMBOL Effect "Khasrach;symbol" : EA_GENERIC
  { Flags: EF_NOGEN; 
    Desc: "Khasrach's holy symbol is an iron hoop wrapped with tanned
      leather, with a splatter of the follower's own blood in the center.";
  }

God "Khasrach"
  {                                     
    /* WW: Khasrach's domains are basically identical to those of Zurvash
     * -- he's got Animal, she's got War, the rest overlap completely. So
     * we'll change her a bit.  
     * FJM: I want to pull these a little bit closer to being the classic
     * orc goddess, so I put strength and destruction back in, and tweaked
     * Zurvash so they'd still be sufficiently different. */
    Domains: $"Hatred",         // blind hatred
             $"Destruction",    // a violent people
             $"Mysticism",      // last vestige of old mystical nature
             $"Strength",       // survival of the strong
             $"Pain",           // bloodletting
             $"War";            // war with the dwarves
    Desc: "<15>Goddess of the Blood<11>
      \n__Destruction, Hatred, Mysticism, Strength, Pain, War. The
      Longspear. Weapons of Terror.<2>
      \n__Patron of the orcs and goblinoids, most civilized people view
      Khasrach as a scourge upon the land -- a bloodthirsty barbarian bitch
      who seeks only the downfall of the demihuman races. There is some
      truth to this -- Khasrach is a harsh diety who demands constant
      sacrifice in her name, but she is also nurturing and supportive to
      those who are strong enough to be worthy, regardless of their race or
      creed. At her basest, Khasrach is the patron diety of anyone who is
      willing to bleed for what they believe in. She demands that her
      followers never surrender their independance or their dignity, even
      upon pain of death. (Of course, what humans call dignity can be very
      different from the similar concept for orcs.) Her rites of worship
      are primitive and ecstatic, featuring frenzied blood-letting, wild
      tribal dances and even ritualistic combat. Khasrach demands that her
      followers 'stare down the world', shaping it to their desires through
      sheer force of will.
      \n__There is a strong dichotomy between Khasrach as she once was, and
      Khasrach as she is now. Some goblinoid shamans believe Khasrach has
      become somehow debased, aspects of her godhead having been worn away
      and lost over time in reflection of the degeneration of her patron
      peoples. There is evidence that the ancient Khasrach had a more
      mystical side to her spirituality, an element of nature worship and a
      much greater emphasis on cycles, prophecy and personal
      transformation. In the modern world, however, Khasrach is falling
      into the thrall of Abbadon, being slowly consumed from within by
      blind hatred and fits of insanity. Some even fear (or hope) that the
      goddess of the orcs is slowly dying from a kind of metaphysical
      decay.
      \n__Khasrach has an ancient and bloody emnity with Ekliazeh, the
      patron god of the dwarves, and their followers rarely miss a chance
      to make war upon each other. Essiah, however, has a guarded respect
      for Khasrach in her saner moments, and the two goddesses of primal
      passions share a kind of kinship. The rest of the Theryan pantheon
      just quietly wishes she would quit trying to tear down civilization
      and go finish dying in a corner somewhere.
      \n__Khasrach's theology would purport that she tries to be Chaotic
      Neutral, but in the depths of her insanity her actions place her more
      in line with being Chaotic Evil. She accepts followers of any
      alignment. Her chosen weapon is the longspear, and her clerics gain
      access to the domains of Destruction, Hatred, Mysticism, Strength, 
      Pain and War. Her holy symbol is an iron hoop wrapped with tanned
      leather, with a splatter of the follower's own blood in the center.\n
      __<10>Worship:<2> Khasrach accepts the sacrifice of any being of
      equal or greater personal power than the worshipper. The only
      exception is her own people, goblinoids and especially orcs; such
      sacrifices infuriate her. She is also pleased when her clerics
      manage to intimidate their enemies, but highly displeased when they
      surrender or are overtaken with fear on the battlefield. Khasrach
      accepts that orcs and goblinoids war among themselves, so does not
      become angered when her followers kill the rank and file of such.
      However, she demands that priests loyal to her not kill non-hostile orcs who
      have attained an exceptional level of prowess, as a deferance to
      racial unity.\n
      __Khasrach will not accept elves, dwarves or human mages as followers,
      since those groups have traditionally exploited her people. Humans
      who become mages after pledging to her are not rejected, however.\n
      __<10>Blessings:<2> Khasrach is, in her own violent way, a maternal
      goddess, and will aid her people in several ways. Casual followers
      can expect her to heal them in combat or purify their bodies, while
      slightly more loyal followers can expect that she will smite their
      enemies, remove fatigue, ease hunger and deflect especially deadly
      blows. For a truly exceptional follower, she will (in order)
      replenish the spirit, remove curses and raise the follower should
      he die, though the latter carries great cost in favour.\n
      __Khasrach's gifts increase a follower's strength of will, teach
      him to develop personal fearsomeness and give him a canny insight
      into other people. She teaches her petitioners to channel fearsome
      force into war-cries, gifts them with sacred strength and teaches
      them magic to vindictively curse (and later sense the presence of) 
      enemies.\n
      __Khasrach is known to metaphysically birth hordes of orcs, and
      often sends clutches to aid loyal followers in combat, or punish
      those who stray from her way. She also favours trial by ordeal
      when followers offend her, casting them into situations out of
      their depth."; 
    Flags: GF_COMBAT_PULSE; /* Kludge vs. Paladins */
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|Smite now your slave-chains with the primal fire of my wrath!|"
          MSG_BADSAC1
            "|Thou dares to offer me the blood of mine own people?! SUFFER!|"
          MSG_BADSAC2
            "|Thou dares to offer me the blood of our allies?!|"
          MSG_CUSTOM1
            "|Thou hast sinned against my way; now, prove thy loyalty in
                this trial by ordeal!|"
          MSG_CUSTOM2
            "|Know always that our people have strength in numbers!|"
          MSG_CUSTOM3
            "|Destroy the infidel, my children!|"
          MSG_CUSTOM4
            "|Thou art an enemy of my people! Suffer, infidel!|"
          
          MSG_BLESSING1
            "|So I bless thee: that thou shalt turn aside all charms and
                compulsions, and see clearly past the machinations of
                others to determine thy future!|"
          
          
          #if 0
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
          
          MSG_BLESSING2
          MSG_BLESSING3
          MSG_BLESSING4
          MSG_BLESSING5
          MSG_BLESSING6
          MSG_BLESSING7
          MSG_CROWNED
          #endif
          ,
      * SACRIFICE_LIST
          MA_ORC        SAC_ABOMINATION
          MA_GOBLINOID  SAC_ANGRY
          MA_ALL        10
          MA_ALL        10
          MA_ALL        10
          MA_ALL        10
          MA_ALL        10,
      * GOD_RELATIONS
          REL_DEFAULT   1     0
          
          /* Allied Gods */
          $"Aiswin" $"Essiah" $"Semirath" $"Sabine" $"Zurvash" $"Asherath" 0 0
          
          /* Want to Exterminate Orcs */
          $"Erich" $"Ekliazeh" 7 1
          $"Immotian" $"Maeve" 5 1
          
          /* Overly Civilized/Peaceful */
          $"Xavias" $"Hesani" $"Mara" 3 0,
      * CROWNING_GIFTS
          $"Bloodspear",
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          54000
          96000
          102000
          250000,
      * AID_CHART  
          AID_HEAL       P_LOW    100
          AID_PURIFY     P_LOW    100
          AID_SMITE      P_LOW    250
          AID_REFRESH    P_LOW    250  
          AID_FEED       P_LOW    250  
          AID_DEFLECT    P_LOW    250
          AID_RESTORE    P_HIGH   750
          AID_UNCURSE    P_LOW    1500
          AID_RESURRECT  P_LOW    2500;    
    Constants:
      * VOICE_COLOUR RED,
      * ALTAR_COLOUR RED,
      * HOLY_SYMBOL $"Khasrach;symbol",
      * CHOSEN_WEAPON $"longspear"
      * CHOSEN_WEAPON_QUALITY WQ_WOUNDING,
      * INTERVENTION_COST 3,
      * RESURRECTION_COST 20,
      * ALTAR_COST 3,
      * PRAYER_TIMEOUT 8,
      * MIN_RAISE_LEVEL 7,
      * MIN_CONVERT_FAVOUR 200,
      * PRAYER_DC 10,
      * LEVEL_BLEEDOFF 2,
      * TOLERANCE_VAL 5,
      * GODPULSE_INTERVAL 20,
      * GODANGER_INTERVAL 30,
      * PERSONAL_ALIGN (AL_CHAOTIC|AL_EVIL),
      * LAY_MULTIPLIER 10;
    Grants:
      Stati[ADJUST_SAC,A_SAV_WILL,+4] at 1st level,
      Stati[SKILL_BONUS,SK_APPRAISE,+4] at 1st level,
      Stati[EXTRA_SKILL,SK_INTIMIDATE] at 1st level,
      Stati[EXTRA_FEAT,FT_WARCRY] at 2nd level,
      Stati[ADJUST_SAC,A_STR,+1] at every 2nd level starting at 2nd,
      Ability[CA_INNATE_SPELL,$"Bestow Curse"] at 3rd,
      Stati[IMMUNITY,AD_BLND] at 4th level,
      Ability[CA_INNATE_SPELL, $"Primal Scream"] at 5th,
      Ability[CA_INNATE_SPELL, $"Detect Monsters"] at 6th,
      Stati[EXTRA_FEAT,FT_DIEHARD] at 7th level,
      Feat[FT_IMPROVED_CRIT] at 5th level,
      Ability[CA_INNATE_SPELL, $"Shadow Monsters"] at 8th,
      Ability[CA_INNATE_SPELL, $"Venom of Khasrach"] at 9th;
    On Event EV_GIVE_AID {
      hObj hEnemy;
      if (e.EParam == AID_SMITE)
        {
          for (hEnemy=EMap->FirstThing();hEnemy;hEnemy=EMap->NextThing())
            if (hEnemy->isCreature() && hEnemy->DistFrom(EActor) < 15)
              if (hEnemy->isHostileTo(EActor) && hEnemy->isMType(MA_HAS_BLOOD) &&
                    !hEnemy->isMType(MA_GOBLINOID))
                {
                  hEnemy->IDPrint("Your blood ruptures out of your body!",
                    "The <hObj>'s blood is torn out of <her:EVictim> body!", hEnemy);
                  ThrowDmg(EV_DAMAGE,AD_NORM,10d6,"the power of Khasrach",
                             hEnemy, hEnemy); 
                }
          if (EActor->isThreatened())
            {
              EActor->IPrint("Khasrach gifts you with divine invulnerability!");
              EActor->GainTempStati(EXTRA_ABILITY,NULL,3d6,SS_ENCH,
                    CA_WEAPON_IMMUNITY,+3,$"Khasrach's Aegis",30);
            }
          return DONE;
        }
      return NOTHING;
      },
    EV_RETRIBUTION, EV_GODPULSE {
      int16 n, i; hObj hOrc; rID tID;
      
      if (EActor->ChallengeRating() >= 9)
        tID = $"elite";
      else if (EActor->ChallengeRating() >= 7)
        tID = $"veteran";
      else if (EActor->ChallengeRating() >= 5)
        tID = $"experienced";
      else if (EActor->ChallengeRating() >= 3)
        tID = $"skilled";
      else
        tID = NULL_ID;
    
      n = (e.Event == EV_GODPULSE) ? 
            EActor->getGodLevel($"Khasrach") + 1 : 
            1 + e.EParam / 3;
      
      EActor->GodMessage($"Khasrach", (e.Event == EV_GODPULSE) ?
        MSG_CUSTOM2 : MSG_CUSTOM3);
      for (i=0;i!=n;i++)
        {
          switch (1d3)
            {
              case 1:
                hOrc = CreateMonster($"cave orc");
               break;
              case 2:
                hOrc = CreateMonster($"hill orc");
               break;
              case 3:
                hOrc = CreateMonster($"black orc");
               break;
            }
          if (i == 0 && n > 3) {
            hOrc->AddTemplate($"chieftan");
            hOrc->IdentifyTemp($"chieftan");
            }
          else if (i == 1 && n > 5) {
            hOrc->AddTemplate($"shaman");
            hOrc->IdentifyTemp($"shaman");
            }   
          if (tID != NULL_ID) {
            hOrc->AddTemplate(tID);
            hOrc->IdentifyTemp(tID);
            }  
          hOrc->PlaceAt(EMap,EActor->x,EActor->y);
          hOrc->Initialize();
          if (e.Event == EV_GODPULSE) {
            hOrc->GainPermStati(BONUS_PHD,NULL,SS_MISC);
            hOrc->MakeCompanion(EActor,PHD_FREEBIE);
            }
          else 
            hOrc->TurnHostileTo(EActor);
        }
      return DONE;
      },
    EV_ANGER_PULSE {
      if (EMap->Depth > min(9,EActor->TotalLevel()+2)) {
        e.EParam = EActor->getGodAnger($"Khasrach") / 2;
        ReThrow(EV_RETRIBUTION, e);
        return DONE;
        }
      EActor->GodMessage($"Khasrach", MSG_CUSTOM1);
      EActor->IPrint("You are cast down!");
      EActor->MoveDepth(min(10,EMap->Depth + 1 + 
        (EActor->getGodAnger($"Khasrach") - 3) / 5), true);
      return DONE;
      },      
    EV_SACRIFICE {
      if (GetHandle(EVictim) == NULL_OBJ)
        return NOTHING;
      if (!EVictim->isMType(MA_GOBLINOID) &&
           EVictim->ChallengeRating() <
           EActor->ChallengeRating())
        return SAC_UNWORTHY;
      return NOTHING;
      },
    EV_PREREQ {
      if (EActor->isMType(MA_ELF) || EActor->isMType(MA_DWARF) ||
          (EActor->isMType(MA_HUMAN) && EActor->LevelAs($"mage")))
        {
          EActor->GodMessage($"Khasrach", MSG_CUSTOM4);
          return NOMSG;
        }
      return NOTHING;
      },
    GODWATCH(POST(EV_DEATH)) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (!EVictim->isDead())
        return NOTHING;
      if (EVictim->isMType(MA_ORC) && EVictim->isMType(MA_SAPIENT) &&
          EVictim->HasStati(WAS_FRIENDLY,-1,EActor) &&
           (!EVictim->isMType(MA_CONSTRUCT)) && EVictim->ChallengeRating() >= 2) {
        EActor->Transgress($"Khasrach",1,false,"killing a skillful orc");
        return NOTHING;
        }
      if (EVictim->isMType(MA_ELF) || EVictim->isMType(MA_DWARF) ||
          (EVictim->isMType(MA_HUMAN) && 
             EVictim->HasStati(SPELL_ACCESS, SP_ARCANE)))
        EActor->gainFavour($"Khasrach",max(1,EVictim->ChallengeRating())*10,false,true);
      else
        EActor->gainFavour($"Khasrach",max(1,EVictim->ChallengeRating()),false,true);
      return NOTHING;
      },
    GODWATCH(EV_SURRENDER) {
      EActor->Transgress($"Khasrach",5,false,"surrendering");
      return NOTHING;
      },
    GODWATCH(EV_GAIN_STATI) {
      if (e.EParam == AFRAID)
        EActor->Transgress($"Khasrach",2,false,"cowardice");
      return NOTHING;
      },      
    EV_PREREQ {
      if (EActor->isMType(MA_ELF) || EActor->isMType(MA_DWARF) ||
          (EActor->isMType(MA_HUMAN) && EActor->LevelAs($"mage") &&
             EActor->GodID != $"Khasrach"))
        return ABORT;
      return NOTHING;
      };
  }

Effect "Khasrach's Aegis" : EA_GENERIC 
  { Flags: EF_SHOWNAME, EF_SPECABIL; }

Effect "Primal Scream" : EA_BLAST
  { Level: 7; aval: AR_GLOBE; cval: RED; lval: 8;
    Flags: EF_SPECABIL, EF_ALLIES_IMMUNE;
    xval: AD_SONI; pval: 2d6; sval: NOSAVE;
    Desc: "At the cost of a fatigue point, a favoured servant of Khasrach
      can emit a primal scream, which affects all hostile or neutral
      creatures within 80 feet -- the screamer and any allies are immune.
      The scream inflicts 2d6 points of sonic damage, stuns anyone who
      hears and fails a Will save and knocks down anyone who fails a 
      Fortitude save.";
    On Event 
      EV_EFFECT {
        if (!EActor->LoseFatigue(1,true))
          return ABORT;
        return NOTHING;
        },
      MSG_BLASTNAME 
        "primal scream",
      MSG_CAST
        "You scream a primal howl of fury with an almost physical
           force behind it!" /        
        "The <EActor> screams a primal howl of fury with an almost physical
           force behind it!";
  }
and EA_BLAST
  { xval: AD_STUN; pval: 3d6; sval: WILL; }
and EA_BLAST
  { xval: AD_TRIP; sval: FORT; }

Effect "Venom of Khasrach" : EA_BLAST
  { SC_EVO; Base: SP_EASY; Level: 6; aval: AR_BOLT; qval: Q_DIR|Q_TAR;
    xval: AD_ACID; lval: 4; sval: REF partial; pval: (LEVEL_1PER1)d10;
    Purpose: EP_ATTACK; cval: EMERALD;
    Desc: "The most favoured champions of Khasrach can spit a jet of acid --
      the metaphorical personification of Khasrach's rage -- at their
      enemies, inflicting 1d10 points of acid damage per character level
      and allowing the victim a saving throw for half damage. The cost is
      two fatigue points."; 
    On Event EV_EFFECT {
      if (!EActor->LoseFatigue(2,true))
        return ABORT;
      return NOTHING;
      };    
  }

AI_SYMBOL Effect "Kysul;symbol" : EA_GENERIC
   { Flags: EF_NOGEN; 
   Desc: "Kysul's holy symbol is a wide, lidless eye surrounded by a corona
   of tentacles."; }

God "Kysul"
  {
    Domains: $"Fate", $"Good", $"Mysticism", $"Planning", $"Slime", $"Water;domain";
    Flags: GF_NO_EVIL | GF_SANITY_BLASTING;
    Desc: "<15>The Watcher Beneath the Waves<11>
      \n__Fate, Good, Mysticism, Planning, Slime, Water. The Trident. Sleep
      Weapons.<2>
      \n__Unspeakably strange, Kysul is a god from a world long since forgotten,
      a truly timeless being. It has travelled the skies for millenia untold,
      and watched the whole universe it once knew be destroyed around it. Now,
      it is determined not to allow the same thing to happen to this new world 
      that is has adopted as its own. Kysul is the progenitor of many aberration
      races such as the beholders, mind flayers and avolakia, and has abandoned
      each as they fell into the grasp of wickedness and destructive, selfish
      impulses. Kysul is also revered by (and intricately involved in the history
      of) the lizardmen, though he did not create them and the majority of their 
      race worship nature in the abstract (as druids) rather than any one specific 
      god. Immotian hates and fears Kysul, considering it a great impurity and
      blemish upon the perfection of the world.
      \n__Kysul is nothing if not a long-term planner. Patient beyond human
      imagining, it has spent the last six milennia subtly nudging forward its
      eldritch master plan to save Therya from a metaphysical armageddon that most
      humans would not even perceive, let alone understand. Often, the actions
      and objectives of this plan are not comprehensible to Kysul's followers,
      let alone casual observers, but they are none the less necessary. The Watcher 
      has access to a font of gnosis from its old world, a source of secret 
      knowledge that, if conveyed directly, will shatter the mind of any human-like 
      being. Indeed, Kysul's mere presence, and the rituals and ceremonies of its 
      clergy, have been known to cause madness in the uninitiated. For this reason, 
      its clerics form tiny, secretive cults, dwelling in the shadows outside of 
      mundane sight, in order to receive Kysul's revelations at whatever rate their
      minds can withstand the strain. There is an extremely strict ethical code
      among followers of Kysul concerning exposing mundanes to the many things its
      followers deal with that could damage minds.
      \n__Kysul itself appears as a vast, tentacled horror with many eyes, vaguely
      resembling a cephalopod. It dwells, as its moniker suggests, deep beneath the
      sea somewhere on the prime material plane; Kysul has no ties to the Outer Planes
      or any other aspects of the human afterlife. He is stringently hostile to
      demons and devils, and his relations with celestials, surprisingly, are not
      that much better. The reason for its extreme mistrust of the Higher Planes
      is unknown. Sailors and seamen often use scraps of old chants and arcane
      gestures to propitiate Kysul, in the hopes of receiving smooth weather for
      a journey. When it perceives these, it obliges as best it can, but Kysul is
      a very alien, primordial being, and any interaction it has with humanity is
      severely limited by the radical differences in perspective.
      \n__Kysul is Lawful Good, and accepts worshippers of any non-evil alignment.
      Many evil creatures, especially aberrations, still practice ancient rituals
      and sacrifices in Kysul's name, harkening back to the ancient history of
      their race, even though Kysul no longer responds to such entreaties. It
      offers to its clerics the domains of Fate, Good, Mysticism, Planning, Slime
      and Water. Its holy symbol is a wide, lidless eye surrounded by a corona of
      tentacles, and its chosen weapon is the trident. It frequently grants its 
      chosen followers access to a wide variety of ancient artifacts long 
      forgotten by history.\n
      __<10>Worship:<2> Kysul accepts any evil creature as a sacrifice, but
      is most moved by the offering of evil aberrations and any hostile outsiders as 
      sacrifices. The latter do not leave corpses, and thus must be live-sacrificed. 
      The sacrifice of non-evil aberrations offends Kysul greatly. Damaging the
      sanity (mental attributes) of sapient creatures that are not evil
      angers Kysul, as does any evil act. Killing evil aberrations pleases
      Kysul; killing non-evil aberrations, hostile or otherwise, angers it.\n
      __<10>Blessings:<2> Kysul will clear any follower's mind, and will heal,
      purify the body, lift curses, teleport to safety or cure blindness and
      permanent wounds for followers after a nominal show of loyalty. For
      more devout followers, it will replenish mana, replace lost spellbooks,
      identify items and even raise an especially loyal follower from the
      dead. Kysul penalizes intervention very strongly, however, because it
      weakens the fabrics of reality when it reaches directly into the prime 
      material plane to help a worshipper.\n
      __Kysul grants many gifts to a loyal cultist. First, students are taught
      to discipline their mind, the better to withstand contact with such an
      alien god. Shortly after, they learn about the nature of magic, the
      planes of existance and many long-dead languages of arcane power. Their
      bodies transform into something ever so slightly inhuman, granting them
      the ability to breathe water. They also gain a preternatural awareness,
      allowing them to avoid blows through uncanny intuition. A truly devout
      follower of Kysul might gain the ability to melt space and time, unearthy
      senses and command over dreams and aberrations."; 
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|Seek now thine antediluvian progenitors that in sunken cities 
                for eons have lain.|"
          (MSG_AID + AID_TELEPORT)
            "Kysul guides you to safety through the cracks and flaws 
              between dimensions."
          MSG_CUSTOM1
            "An inhuman emanation vaguely imitates language: |This, my 
              child: a relic of civilizations long since engulfed by the 
              flow of eons!|"
          MSG_CUSTOM2
            "You feel profane."
          MSG_CUSTOM3
            "You feel you are surely facing the ire of Kysul..."
          
          
          #if 0
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          MSG_BADSAC1
          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
          
          
          MSG_BLESSING1
          MSG_BLESSING2
          MSG_BLESSING3
          MSG_BLESSING4
          MSG_BLESSING5
          MSG_BLESSING6
          MSG_BLESSING7
          MSG_CROWNED
          #endif
          ,
      * SACRIFICE_LIST
          (MA_ABERRATION + MA_NONEVIL*256) SAC_ABOMINATION
          MA_OUTSIDER                     15
          MA_OUTSIDER                     15
          MA_OUTSIDER                     15
          (MA_ABERRATION + MA_EVIL*256)   10
          (MA_ABERRATION + MA_EVIL*256)   10
          (MA_ABERRATION + MA_EVIL*256)   10
          MA_EVIL                         10,
      * GOD_RELATIONS
          REL_DEFAULT   0     0
          
          /* Evil Gods */
          $"Maeve" $"The Multitude" $"Xel" $"Zurvash" 5 1
          
          /* Corrupt Gods with Political Protection */
          $"Erich" $"Immotian" $"Ekliazeh" 2 0
          
          /* Vengeance & Destructiveness are Unhealthy */
          $"Aiswin" $"Sabine" $"Asherath" $"Khasrach" 1 0
          
          ,
      * CROWNING_GIFTS
          $"Nine Lives Stealer",
      * FAVOUR_CHART
          300
          750
          1500
          3000
          12000
          24000
          48000
          64000
          96000
          128000,
      * AID_CHART  
          AID_HEAL           P_MODERATE    100
          AID_PURIFY         P_MODERATE    100
          AID_UNCURSE        P_MODERATE    100
          AID_TELEPORT       P_MODERATE    100        
          AID_CURE           P_MODERATE    100
          AID_CLARITY        P_MODERATE    0      
          AID_IDENTIFY       T_ITEM        2500
          AID_RESURRECT      0             6000
          AID_NEWBOOK        P_LOW         400      
          AID_MANA           P_MODERATE    250;    
    Constants:
      * VOICE_COLOUR GREEN,
      * ALTAR_COLOUR GREEN,
      * HOLY_SYMBOL $"Kysul;symbol",
      * CHOSEN_WEAPON $"trident",
      * CHOSEN_WEAPON_QUALITY WQ_SLEEP,
      * INTERVENTION_COST 20,
      * RESURRECTION_COST 30,
      * ALTAR_COST 6,
      * PRAYER_TIMEOUT 12,
      * MIN_RAISE_LEVEL 8,
      * MIN_CONVERT_FAVOUR 300,
      * PRAYER_DC 17,
      * LEVEL_BLEEDOFF 5,
      * TOLERANCE_VAL 4,
      * GODPULSE_INTERVAL 20,
      * GODANGER_INTERVAL 10,
      * PERSONAL_ALIGN (AL_LAWFUL|AL_GOOD),
      * LAY_MULTIPLIER 30;
    Grants:
      Stati[SUSTAIN,A_INT,+1] at every 2nd level starting at 1st,
      Stati[SUSTAIN,A_WIS,+1] at every 2nd level starting at 1st,
      Stati[SUSTAIN,A_CHA,+1] at every 2nd level starting at 1st,
      Stati[EXTRA_FEAT,FT_IRON_WILL] at 1st level,
      Stati[WATER_BREATHING] at 2nd level,
      Stati[EXTRA_SKILL,SK_KNOW_MAGIC]  at 2nd level,
      Stati[EXTRA_SKILL,SK_KNOW_PLANES] at 2nd level,
      Stati[EXTRA_SKILL,SK_DECIPHER]    at 2nd level,
      Stati[SKILL_BONUS,SK_DECIPHER,+4] at 2nd level,
      Stati[ADJUST_INS,A_DEF,+4] at 3rd level,
      Ability[CA_INNATE_SPELL,$"Distance Distortion"] at 4th level,
      /* Ability[CA_INNATE_SPELL,$"Dissolving Touch"] at 4th level, */
      Stati[PERCEPTION,1,+3] at 5th level,
      Stati[PERCEPTION,1,+1] at every level starting at 6th level,
      Ability[CA_INNATE_SPELL,$"Nightmare"] at 6th level,
      Stati[COMMAND_ABILITY,MA_ABERRATION,+7] at 6th level,
      Stati[COMMAND_ABILITY,MA_ABERRATION,+3] at every level starting at 7th level,
      Ability[CA_INNATE_SPELL,$"Premonition"] at 7th level,
      Ability[CA_INNATE_SPELL,$"Phantasmal Killer"] at 7th level,
      Ability[CA_INNATE_SPELL,$"Pseudonatural Transformation"] at 8th level,
      Ability[CA_INNATE_SPELL,$"Banishment"] at 9th level;
    On Event EV_RETRIBUTION {
      if (!EActor->isMType(MA_EVIL))
        return DONE;
      EActor->IDPrint("Obscene, alien visions tear apart your mind!",
                        "The <hObj> screams as <her:hObj> mind is rent!",EActor);
      ThrowDmg(EV_DAMAGE,AD_DAIN,(e.EParam/3+1)d6,"the visage of Kysul",
                  EActor, EActor);
      if (!EActor->isDead())
        ThrowDmg(EV_DAMAGE,AD_DAWI,max(1,(e.EParam-1)/3+1)d6,"the visage of Kysul",
                    EActor, EActor);
      return DONE;
      },
    EV_GODPULSE {
      hObj hGift;
      bool isBad;
      if (EActor->getGodLevel($"Kysul") < 3)
        return NOTHING;
      EActor->GodMessage($"Kysul", MSG_CUSTOM1);
      do {
        isBad = false;
        hGift = GenDungeonItem(IG_GOOD,NULL_ID,EActor->getGodLevel($"Kysul")+3,20);
        if (hGift->isType(T_FOUNTAIN) ||
            /* hGift->isType(T_THRONE) || */
            hGift->isType(T_POTION) ||
            hGift->isType(T_SCROLL))
          isBad = true;
        if (hGift->isType(T_WEAPON) || 
            hGift->isType(T_ARMOUR) ||
            hGift->isType(T_SHIELD))
          if (EActor->WepSkill(hGift->iID) == WS_NOT_PROF)
            isBad = true;
        if (!hGift->isMagic())
          isBad = true;
        if (hGift->HasQuality(WQ_UNHOLY) ||
            hGift->HasQuality(WQ_CHAOTIC) ||
            hGift->HasQuality(WQ_CORROSIVE))
          isBad = true;
        
        if (hGift->isType(T_BOOK))
          if (!EActor->LevelAs($"mage"))
            isBad = true;
        if (isBad)
          hGift->Remove(true);
        }
      while (isBad);
      EActor->GainItem(hGift,false);
      return DONE;
      },
    EV_ANGER_PULSE {
      hObj hEnemy; bool first;
      first = false;
      for (hEnemy=EMap->FirstThing();hEnemy;hEnemy=EMap->NextThing())
        if (hEnemy->isCreature() && hEnemy->DistFrom(EActor) < 15)
          if (hEnemy->isHostileTo(EActor) && !hEnemy->isMType(MA_SAPIENT) &&
               (hEnemy->isMType(MA_BEAST) || hEnemy->isMType(MA_ANIMAL)) &&
               hEnemy->isMType(MA_NLIVING) && hEnemy->CanAddTemplate($"pseudonatural"))
            {
              if (!first) {
                first = true;
                EActor->GodMessage($"Kysul", MSG_CUSTOM3);
                }
              hEnemy->AddTemplate($"pseudonatural");
              hEnemy->IdentifyTemp($"pseudonatural");
            }
      if (first)
        return DONE;
      EActor->GodMessage($"Kysul", MSG_CUSTOM2);   
      EActor->GainTempStati(ENEMY_TO,NULL,-1,SS_MISC,MA_ALL);
      return DONE;
      },
    EV_SACRIFICE {
      if (GetHandle(EVictim) != NULL_OBJ)
        if (EVictim->isMType(MA_GOOD) || EVictim->HasStati(WAS_FRIENDLY,-1,EActor))
          return SAC_ABOMINATION;
      return NOTHING;
      },
    /* Add Sanity-Blasting clause in GodMessage, GF_SANITY_BLAST */     
    GODWATCH(EV_DEATH) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (EVictim->isMType(MA_ABERRATION) && !EVictim->isMType(MA_CONSTRUCT))
        {
          if (EVictim->isMType(MA_EVIL))
            EActor->gainFavour($"Kysul",EVictim->ChallengeRating()*10,false,true);
          else if (EVictim->HasStati(WAS_FRIENDLY,-1,EActor))
            EActor->Transgress($"Kysul",5,false,"killing a friendly aberration");
          else
            EActor->Transgress($"Kysul",1,false,"killing a non-evil aberration");
        }
      else if (EVictim->isMType(MA_OUTSIDER))
        if (!EVictim->HasStati(WAS_FRIENDLY,-1,EActor))
          EActor->gainFavour($"Kysul",EVictim->ChallengeRating()*5,false,true);
      return NOTHING;
      },
    GODWATCH(EV_ALIGNED) {
      if (e.EParam & (AL_NONGOOD|AL_EVIL))
        EActor->Transgress($"Kysul",(e.vMag + 1)/2,false, "evil act");
      return NOTHING;
      },
    GODWATCH(EV_DAMAGE) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (EVictim->isMType(MA_SAPIENT) && !EVictim->isMType(MA_EVIL))
        if (e.DType == AD_DAIN || e.DType == AD_DAWI || e.DType == AD_DACH)
          EActor->Transgress($"Kysul",6,false,"damaging others' sanity");
      return NOTHING;
      }, 
    GODWATCH(EV_ENTER) {
      if (EActor->getGod() != $"Kysul")
        return NOTHING;
      if (EActor->getGodAnger($"Kysul") == 0)
        return NOTHING;
      /* Let the PC reach the ecutemp on dlevel 2 to try and make up
         with an offended Kysul */
      if (EMap->Depth == 1)
        return NOTHING;
      if (GetHandle(ETarget) == NULL_OBJ)
        return NOTHING;
      if (!ETarget->EnterDir(DOWN))
        return NOTHING;
      EActor->IPrint("Overcome with an inexplicable alien dread, you
        find yourself unable to descend.");
      return ABORT;
      }, 
    GODWATCH(EV_MOVE) {
      int16 tx, ty;
      if (EActor->getGod() != $"Kysul")
        return NOTHING;
      if (EActor->getGodAnger($"Kysul") == 0)
        return NOTHING;
      tx = EActor->x + DirX(e.EDir);
      ty = EActor->y + DirY(e.EDir);
      if (EMap->FallAt(tx,ty) &&
           !EMap->FallAt(EActor->x, EActor->y))
        {
          EActor->IPrint("Overcome with an inexplicable alien dread, you
            find yourself unable to proceed.");
          return ABORT;
        }
      return NOTHING;
      };
  }
  
Effect "Pseudonatural Transformation" : EA_GENERIC
  {
    Cost: 75; Flags: EF_SPECABIL, EF_LOSEMANA; qval: Q_TAR;
    Desc: "Kysul grants his most trusted followers the ability to transform
      native living creatures into powerful pseudonatural servants touched
      by the Outer Realms. Kysul only allows non-sapient creatures to be so
      transformed, and the creature must be of an original Challenge Rating
      equal to or lower than half the follower's own Challenge Rating. The
      intended subject must also be an ally of the follower's.";
    On Event EV_ISTARGET {
      if (!EVictim->isMType(MA_NLIVING))
        return CANNOT_CAST_IT;
      if (EVictim->isMType(MA_SAPIENT))
        return CANNOT_CAST_IT;
      if (EVictim->HasEffStati(TEMPLATE,$"pseudonatural"))
        return CANNOT_CAST_IT;
      if (!EVictim->CanAddTemplate($"pseudonatural"))
        return CANNOT_CAST_IT;
      if (EVictim->ChallengeRating() > (EActor->ChallengeRating()/2))
        return CANNOT_CAST_IT;
      return SHOULD_CAST_IT;
      },
    EV_MAGIC_HIT {
      EVictim->AddTemplate($"pseudonatural");
      return DONE;
      };
  }

AI_SYMBOL Effect "Mara;symbol" : EA_GENERIC
   { Flags: EF_NOGEN; 
   Desc: "Mara's holy symbol is a tiny bag of dust worn around one's neck,
   drawn from the powdered bones on an ancestor."; }

God "Mara"
  {
    Domains: $"Beauty", $"Death", $"Good", $"Healing;domain", $"Night", $"Succor"; 
    Desc: "<15>Goddess of Death, Stillness and Romantic Love<11>
      \n__Beauty, Death, Good, Healing, Night, Succor. The Scythe. Keen
      Weapons.<2>
      \n__As the goddess of death and emotional closure, Mara is
      responsible for maintaining the Twilight Realm and ushering souls
      of the dead to the afterlife. Mara teaches that life exists so 
      that we may care about those around us, develop attachments, undertake 
      quests and experience joy; ultimately, however, unending life has 
      no meaning without death. Every goal must eventually be reached or 
      failed, every relationship must come to an end and every life must 
      pass on to make room for the new. It is crucial that one's goals and 
      emotional affairs be resolved peaceably by the time of death; to die 
      unfulfilled is a great tragedy. A compassionate soul will therefore 
      help others accept their feelings, achieve their goals and go into 
      the next cycle peacefully. It is not immoral acts that bind one's 
      soul to the hells as much as bitterness and unfinished affairs. War 
      and violence end many lives before they have the chance to fulfill 
      themselves; therefore these things are great horrors and a good being 
      will strive for the peace that allows people to reach spiritual and 
      emotional resolution. To fear death is to expend energy against 
      yourself, preventing closure; treasure life but understand that death 
      is the natural peace and relaxation that is just reward - and it is a 
      reward - for a life well lived.
      \n__Along with death, Mara has been given dominion over romantic love.
      Her ethos inclines her to the rituals and ceremonies of romance more
      than the more carnal or familial aspects -- many epic paeans have been
      written of comparatively chaste lovers making tremendous sacrifices in
      each other's names. Mara treasures all things of beauty, though as a death-goddess 
      her beauty is a pale and wan image of the world rather than the more vibrant 
      tones of her sister Essiah. Clerics of Mara often nurse great, unrequited crushes 
      on others that are never so much as vocalized; indeed, Mara teaches, unconsummated
      love can be the purest form, longing and loyalty untainted by the banalities
      of a real relationship. Unsurprisingly, critics accuse the faith of
      fetishizing the idea of love until it is out of touch with the real
      human condition -- often, clerics of Mara claim as their lover a
      figure who was dead centuries before they were born, or even an abstract
      ideal that does not exist in the corporeal world. Yet, the central point
      is that they accept perfect romance, just like immortality, as being
      unattainable, and are at peace with striving for the sake of striving. 
      \n__Mara's clerics are not all the black-shrouded mourners that stereotype 
      paints them - they treasure life and enjoy revelry and gaiety as much as 
      anyone around them, despite their serene anticipation of their own end. 
      They serve as diplomats, counsellors, confessors and advisors to nobles 
      and commoners alike, striving to teach people the acceptance that will 
      allow them to find closure by the time they die. Her clerics intentionally 
      expose themselves, and any others who are willing, to the physical aspects 
      of death - not to shock or disturb, but in the hopes that by acclimating 
      others to death they will learn not to fear it and even to welcome it when 
      its time has come. Because of this practice, many of her clergy earn wages 
      as gravediggers, embalmers, plague healers and vivisectionists. Finally, 
      clerics of Mara bring peaceful, painless death to those who have resolved 
      all of their ties to life - in the case of good-aligned members of her clergy, 
      this is always done with the subject's consent; with others, it depends on the 
      priest in question.
      \n__Mara is Lawful Good, and her clerics may be of any non-evil alignment.
      Her holy symbol is a tiny bag of dust worn around one's neck, drawn from the
      powdered bones of an ancestor; her chosen weapon is the scythe. She grants
      her clerics access to the Domains of Beauty, Death, Good, Healing, Night,
      and Succor.\n
      __<10>Worship:<2> Mara would never stain her altars with the blood
      of creatures killed by her clergy, but if an adventuring
      follower should discover the corpse of an innocent
      creature killed in a desolate locale far from its home
      (such as a dungeon), this corpse might be offered on
      one of her altars so that she might give it a proper
      burial in her Celestial Graveyard and escort the soul
      on to its proper afterlife, as is Her metaphysical duty.
      Respecting the dead in this manner pleases Mara greatly.\n
      __Mara is deeply offended by her clerics killing any friendly 
      creatures or desecrating corpses; however, she is pleased when her 
      clerics put to rest the tormented souls of inherently evil undead 
      (and gravely displeased if her clerics create such beings, though 
      she has no objection to undead in general). Evil acts in general also
      offend Mara, while good acts grant favour with her. Leading
      incorporeal undead to peaceful rest pleases Mara; this can be
      achieved by slaying them in a graveyard area, or by using
      special Marite training and the Diplomacy skill to Quell
      them. She likes her followers to be able to understand the
      natures of other thinking beings, but does not want them to
      cause fear, either mundanely or with magic.\n
      __Mara is a very exacting and unforgiving god -- she knows
      that the powers of death and necromancy can easily lead to
      tragedy, and as a result she sets an unwaveringly high moral
      standard for her followers to adhere to. Only the most
      responsible and ethical beings can be allowed to handle the
      powers of her domain.\n 
      __<10>Blessings:<2> Mara will heal any follower or transport
      them to safety, and will resurrect, grant mental clarity to
      or lift curses on the behalf of followers with even minimal
      favour. For more favoured followers, she will remove fatigue
      and restore the spirit, or even purify the body. Of all the
      gods in Incursion, Mara is the freest in resurrecting her
      followers (followed by Aiswin), as her entire ethos revolves
      around the opportunity to resolve issues left unresolved at
      one's time of death.\n
      __Her more permanent blessings include resistance to fear,
      the ability to understand other thinking creatures, resistance
      to necromantic and death magics, increased potency when using
      necromancy effects and the ability to calm others' feelings 
      and animate the dead. Her greatest champions are said to be
      able to befriend the dead, and to call upon the aid of powerful,
      intelligent undead called Mourners.";
    Flags: GF_GOOD, GF_FORCE_COMMAND, GF_FEMALE;
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|May you find beauty in endings.|"
          MSG_BADSAC1
            "A solemn voice thunders: |You have stained my altar with
              conquest-blood! You shall suffer for this grievous misjudgement!|"
          MSG_CUSTOM1
            "A solemn voice speaks crossly: |Learn now why death is never
                 to be lightly dispensed!|"
          MSG_CUSTOM2
            "A solemn voice intones: |This soul seeks to make atonement for past
                 misdeeds, and will travel with you to aid you on your quest.|"
          MSG_CUSTOM3
            "A solemn voice intones: |This soul seeks find closure lacking in life, 
              and will travel with you to aid you on your quest.|",
          
          
          #if 0
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          
          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
          
          
          MSG_BLESSING1
          MSG_BLESSING2
          MSG_BLESSING3
          MSG_BLESSING4
          MSG_BLESSING5
          MSG_BLESSING6
          MSG_BLESSING7
          MSG_CROWNED
          #endif
      * SACRIFICE_LIST
          MA_CHOICE1      5
          MA_CHOICE1      5
          MA_CHOICE1      5
          MA_CHOICE1      5
          MA_CHOICE1      5
          MA_CHOICE1      5
          MA_CHOICE1      5
          MA_CHOICE1      5
          MA_CHOICE2      SAC_ABOMINATION,
      * GOD_RELATIONS
          REL_DEFAULT   1     0
          $"Hesani"     0     0
          $"Essiah"     0     0
          $"Khasrach" $"Zurvash" $"Xel" $"Sabine" $"The Multitude" 7 1,
      /* * CROWNING_GIFTS
          $"Scythe of Death", */
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          48000
          64000
          92000
          128000,
      * AID_CHART
          AID_TELEPORT  P_LOW        0         
          AID_HEAL      P_LOW        0
          AID_RESURRECT P_LOW        100
          AID_CLARITY   P_LOW        100
          AID_UNCURSE   P_LOW        100
          AID_REFRESH   P_LOW        1000
          AID_RESTORE   P_LOW        1000
          AID_PURIFY    P_HIGH       2000;    
    Constants:
      * VOICE_COLOUR CYAN,
      * ALTAR_COLOUR WHITE,
      * HOLY_SYMBOL $"Mara;symbol",
      * CHOSEN_WEAPON $"scythe",
      * CHOSEN_WEAPON_QUALITY WQ_KEEN,
      * INTERVENTION_COST 5,
      * RESURRECTION_COST 3,
      * ALTAR_COST        5,
      * PRAYER_TIMEOUT    15,
      * MIN_RAISE_LEVEL   3,
      * MIN_CONVERT_FAVOUR 900,
      * PRAYER_DC         12,
      * LEVEL_BLEEDOFF    3,
      * TOLERANCE_VAL     2,
      * GODPULSE_INTERVAL 20,
      * GODANGER_INTERVAL 10,
      * PERSONAL_ALIGN (AL_LAWFUL|AL_GOOD),
      * LAY_MULTIPLIER    10;
    Grants:
      Stati[SAVE_BONUS,SN_FEAR,+2] at 1st level,
      Stati[EXTRA_SKILL,SK_APPRAISE] at 1st level,
      Stati[RESIST,AD_NECR,+2] at every level starting at 2nd,
      Stati[SAVE_BONUS,SN_DEATH,+1] at every level starting at 2nd,
      Ability[CA_INNATE_SPELL,$"calm emotions"] at 3rd level,
      Stati[BONUS_SCHOOL_CASTING_LEVEL,SC_NEC,+1] at every 3rd level starting at 2nd,
      Ability[CA_INNATE_SPELL,$"animate dead"] at 4th level,
      Stati[NEUTRAL_TO,MA_UNDEAD] at 5th level,
      Ability[CA_INNATE_SPELL,$"summon mourner"] at 6th level,
      Ability[CA_INNATE_SPELL,$"Dark Crossing"] at 7th level,
      Ability[CA_INNATE_SPELL,$"slay living"] at 8th level;
    On Event EV_RETRIBUTION, EV_ANGER_PULSE {
      if (!(EActor->isMType(MA_LIVING) || EActor->isMType(MA_UNDEAD)))
        return DONE; 
      EActor->GodMessage($"Mara", MSG_CUSTOM1);
      DPrint(e,"Your body decomposes!", "The <EActor>'s body decomposes!");
      ThrowDmg(EV_DAMAGE,AD_DAST,1d4+1,"the vengeance of Mara",
                  EActor, EActor);
      ThrowDmg(EV_DAMAGE,AD_DADX,1d4+1,"the vengeance of Mara",
                  EActor, EActor);
      ThrowDmg(EV_DAMAGE,AD_DACO,1d4+1,"the vengeance of Mara",
                  EActor, EActor);
      ThrowDmg(EV_DAMAGE,AD_DACH,1d4+1,"the vengeance of Mara",
                  EActor, EActor);
      return DONE;
      },
    EV_GODPULSE {
      hObj hComp; 
      if (EActor->calcFavour($"Mara") >= 1500)
        {
          hComp = CreateMonster($"revenant");
          if (EActor->ChallengeRating() >= 5)
            switch(1d10)
              {
                case 1:  hComp->AddTemplate($"barbarian;template"); break;
                case 2:  hComp->AddTemplate($"bard;template"); break;
                case 3:  hComp->AddTemplate($"druid;template"); break;
                case 4:  hComp->AddTemplate($"rogue;template"); break;
                case 5:  hComp->AddTemplate($"paladin;template"); break;
                case 6:  hComp->AddTemplate($"warrior;template"); break;
                case 7:  hComp->AddTemplate($"ranger;template"); break;
                case 8:  hComp->AddTemplate($"monk;template"); break;
                case 9:  hComp->AddTemplate($"mage;template"); break;
                case 10: hComp->AddTemplate($"priest;template"); break;
              }
          hComp->Initialize();
          hComp->RemoveStati(ALIGNMENT);
          hComp->GainPermStati(ALIGNMENT,NULL,SS_MISC,AL_LAWFUL|AL_GOOD);
          hComp->StateFlags |= MS_KNOWN;
          hComp->PlaceAt(EMap,EActor->x,EActor->y);
          hComp->MakeCompanion(EActor,PHD_FREEBIE);
          EActor->GodMessage($"Mara",1d2==1 ? MSG_CUSTOM2 : MSG_CUSTOM3);
        }
      return DONE;
      },      
    GODWATCH(EV_ALIGNED) {
      if (e.EParam & (AL_EVIL|AL_NONGOOD))
        EActor->Transgress($"Mara",(e.vMag+1) / 2,false,"evil act");
      else if (e.EParam & AL_GOOD) {
        EActor->gainFavour($"Mara",50*e.vMag,true,true);
        EActor->lowerAnger($"Mara",1);
        }
      return NOTHING;
      },
    GODWATCH(POST(EV_DEATH)) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (!EVictim->isDead())
        return NOTHING;
      if (EVictim->HasStati(WAS_FRIENDLY) && EVictim->isMType(MA_SAPIENT))
        if (!(EVictim->HasMFlag(M_IALIGN) && EVictim->isMType(MA_EVIL)))
          EActor->Transgress($"Mara",4,false,"murder");
      if (EVictim->isMType(MA_UNDEAD) && EVictim->HasMFlag(M_INCOR) &&
            !EActor->isMType(MA_EVIL))
        /* Later, change this to the VICTIM's x/y */
        if (EMap->TerrainAt(EActor->x,EActor->y) == $"Ancient Tomb" ||
            EMap->TerrainAt(EActor->x,EActor->y) == $"Graveyard" ||
            EMap->TerrainAt(EActor->x,EActor->y) == $"Orderly Graveyard")
          {
            if (EActor->getGod() == $"Mara")
              EActor->IPrint("You have allowed the restless spirit to find a
                              peaceful end. You feel Mara is most pleased.");
            EActor->gainFavour($"Mara",50*EVictim->ChallengeRating(),true,true);
          }
      return NOTHING;
      },
    GODWATCH(EV_CAST), GODWATCH(EV_INVOKE) {
      if (ResourceHasFlag(e.eID,EF_FEAR))
        EActor->Transgress($"Mara",1,false,"spreading fear");
      return NOTHING;
      },
    GODWATCH(EV_COW) {
      if (EVictim->isMType(MA_SAPIENT))
        EActor->Transgress($"Mara",2,false,"intimidation");
      return NOTHING;
      },
    GODWATCH(PRE(EV_DAMAGE)) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      
      /* Mark any creature damaged by the PC. */
      if (EVictim->isMType(MA_UNDEAD))
        if (e.DType == AD_NECR)
          return NOTHING;
      if (!EActor->HasEffStati(CORPSE_FLAG,$"Mara"))
        EActor->GainPermStati(CORPSE_FLAG,EVictim,SS_MISC,0,0,$"Mara",0);
      return NOTHING;
      },
    PRE(EV_SACRIFICE) {
      if (GetHandle(EVictim) == NULL_OBJ)
        return NOTHING;
      if (!EVictim->isMType(MA_SAPIENT))
        return NOTHING;
      if (EItem->HasEffStati(CORPSE_FLAG,$"Mara"))
        {
          e.EParam = MA_CHOICE2;
          return NOTHING;
        }
      e.EParam = MA_CHOICE1;
      return NOTHING;
      },
    EV_CALC_FAVOUR {
      e.EParam = (e.EParam * (10 + EActor->SkillLevel(SK_APPRAISE) -
                                   EActor->SkillLevel(SK_INTIMIDATE))) / 10;
      return NOTHING;
      },
    GODWATCH(EV_QUELL) {
      if (!EActor->isCharacter())
        return NOTHING;
      if (EActor->GodID != $"Mara")
        return NOTHING;
      
      if (EVictim->isHostileTo(EActor) &&
          EVictim->isMType(MA_UNDEAD) &&
          EVictim->HasMFlag(M_INCOR)) {
        if (EActor->getGodFlags($"Mara") & (GS_FORSAKEN|GS_PENANCE|GS_ANATHEMA))
          {
            EActor->IPrint("Your own spiritual status prevents you from
              offering succor to ghosts at this time.");
            return ABORT;
          }
        if (EVictim->HasEffStati(EFF_FLAG1,$"Mara"))
          {
            EActor->IPrint("You've already tried to put that creature to rest.");
            return ABORT;
          }  
        EActor->Timeout += 30;
        if (EActor->SkillCheck(SK_APPRAISE,10+EVictim->ChallengeRating()*2,true))
          {
            TPrint(e,"You speak softly to the <EVictim>, sensing its
                      desires and using the presence of Mara to put it to
                      peaceable rest.", "",
                   "The <EActor> speaks softly to the <EVictim>, sensing its
                      desires and using the presence of Mara to put it to
                      peaceable rest.");
            EVictim->Remove(true);
            EActor->KillXP(EVictim,100);
            EActor->gainFavour($"Mara",50*EVictim->ChallengeRating(),true,true);
          }
        else
          {
            EVictim->GainPermStati(EFF_FLAG1,EActor,SS_MISC,0,0,$"Mara");
            TPrint(e,"You try to put the <EVictim> to rest, but its rage
                        overcomes you!", "",
                     "The <EActor> tries to put the <EVictim> to rest,
                        but its rage overcomes <her:EActor>!");
            EActor->GainTempStati(STUNNED,NULL,3d4,SS_MISC);
            /* Trying still counts for something with Mara... */
            EActor->gainFavour($"Mara",25*EVictim->ChallengeRating(),false,true);
          }
        return DONE;
        }    
      return NOTHING;
      };
    Flags: GF_COMBAT_ANGER;
  }


Effect "Summon Mourner" : EA_SUMMON
  {
    rval: $"mourner"; pval: 6; Flags: EF_XSUMMON;
    On Event EV_MAGIC_HIT {
      if (!EActor->LoseFatigue(2,true))
        return DONE;
      if (EActor->getGodAnger($"Mara"))
        {
          EActor->IPrint("Nothing happens.");
          return DONE;
        }
      return NOTHING;
      };
    Desc: "This unique ability allows a character highly favoured by
      Mara to call upon the aid of a Mourner, a unique kind of undead
      creature created by Mara to mourn and avenge tragedy. Using
      this ability costs two Fatigue points.";
  }
   
Effect "Dark Crossing" : EA_INFLICT
  {
    Desc: "This power allows the most loyal champions of Mara to
      cross over into her domain -- the negative material plane --
      for a brief period of time, at the cost of two Fatigue
      Points.";
    xval: PHASED; yval: PHASE_NEGATIVE; 
    Flags: EF_CANCEL, EF_SHOWNAME; 
    On Event PRE(EV_EFFECT) {
      if (!EActor->LoseFatigue(2,true))
        return ABORT;
      if (EActor->getGodAnger($"Mara"))
        {
          EActor->IPrint("Nothing happens.");
          return DONE;
        }
      return NOTHING;
      },
    EV_MAGIC_HIT
      "You cross into the negative material plane.",
    EV_REMOVED
      "You return to the material plane.";
  }
    
AI_SYMBOL Effect "Maeve;symbol" : EA_GENERIC
   { Flags: EF_NOGEN; 
   Desc: "Maeve's symbol is a stylized rose."; }


God "Maeve"
  {
    Domains: $"Beauty", $"Chaos", $"Magic", $"Moon", $"Nobility", $"Trickery"; 
    Desc: "<15>Queen of the Faeries<11>
      \n__Beauty, Chaos, Domination, Magic, Moon, Nobility. The Short Bow.
      Chaotic Bows.<2>
      \n__Maeve, beautiful and terrible, holds dominion over all the
      realms of faerie. Her portfolio encompasses dreams, magic, awe,
      beauty, creativity, elvenkind... and utter, amoral chaos. She
      is the patron diety of all elves, and though most sincerely wish
      she wasn't, very few elves willingly pray to another diety for
      fear of evoking her wrath. Her aegis rests over the hearts and
      souls of the elven people like a shadow; a silent, private burden
      that all elves must bear in silence. The elven courts do not
      discuss their fealty to Maeve in modern society, and no formal
      records exist of the things done to pacify Maeve. Yet a few
      human souls dwell in insane asylums across Therya, screaming of
      how they were seduced by elves and stolen away to a realm where
      years pass in a day, taken as the playthings of the Shining Lady...
      \n__Maeve is not a true power, or at least not a true member of
      Therya's divine pantheon. Older than the world itself, she dwells
      on the fringes of the plane of Pandemonium, in a perfectly sculpted
      domain of bright colours, beautiful flowers, cheerful music and
      inhuman grandeur. To mortals, her motives are inscrutable and
      her hungers insatiable, and she might as well be a real god for
      all that it matters. Her temples are always richly decorated,
      elegantly beautiful and utterly deserted, for no one wishes to
      draw her eyes onto them. Her clerics are elves chosen against
      their will by the high elven council and groomed for this
      station, along with the rare members of other races -- artists,
      playwrights, dreamers and musicians -- who are for whatever
      reason willing to make a quite literal Devil's Deal and surrender
      their soul and their sanity in exchange for an inhuman, mind-searing
      muse, a channel of pure dreams and creativity quite unlike anything
      else a mortal could ever know.
      \n__Maeve's symbol is a stylized rose. Her alignment is Chaotic
      Evil, with the evil aspect representing not so much true malevolance
      as an utter disregard for anything other than her own desires. Her
      Domains are Beauty, Chaos,  Magic, Moon, Nobility and Trickery, and 
      her chosen weapon is the short bow. Her clerics must be Chaotic and 
      cannot be Good.\n
      __<10>Worship:<2> Maeve appreuciates the sacrifice of 
      art, gemstones, jewelry and cloaks, finely crafted adornments and anything 
      else that is beautiful, especially if the sacrifice is still screaming 
      as it is being given (i.e., the charismatic creature is killed while 
      standing directly on top of Maeve's altar). Drow are also especially
      pleasing to her as sacrifices, since they have turned their backs on
      her patronage. She is pleased when her children kill drow, displeased
      if the make peace with them or surrender to them, and gravely displeased
      if they try to enlist their aid. She is also angered by her followers
      committing unchaotic acts.\n
      __<10>Blessings:<2> For any follower, Maeve will replace lost spellbooks,
      replenish mana and use the Wyrdways to carry them to safety should they
      be in mortal danger. For the slightly more favoured, she will remove
      fatigue, imbuing the subject with a kind of feverish creativity so much
      coveted by artists. For those more loyal still, she will identify items
      of beauty (cloaks, rings and amulets), as well as bows. For truly favoured
      followers, she can replenish the spirit, and she has even been known to
      raise truly treasured playthings from the dead.\n
      __More permanent blessings from Maeve imclude increased grace and beauty,
      talent as a performer, magic being more difficult to resist, friendship
      from the Fair Folk and inherent magic for sowing discord, conjuring
      beautiful (but destructive) music and similat abilities. Some of her
      most treasured followers are said to be able to use any magic items
      regardless of restrictions, just as rogues do.\n
      __Maeve is mercurial and wild, however, and when she intervenes in a
      follower's life, the result may be either lavish blessings or 
      terrible fury, regardless of how much of her favour a worshipper 
      possesses or whether she is offended -- though of course negative
      interventions are more likely when she is angry, and positive ones
      when she is pleased."; 
    Flags: GF_CHAOTIC, GF_JEALOUS;
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|And there shall be laughter and magic and blood, and we shall dance 
              our dance until the end of time...|"
          MSG_CUSTOM1
            "A mellifluous voice titters, |Oh, what a pretty <hText>! I simply
                must have it!|"
          MSG_CUSTOM2
            "A mellifluous voice titters, |Now, my precious acolate, entertain 
                me with your wonderous displays of warcraft!|"
          MSG_CUSTOM3
            "A mellifluous voice titters, |Now, on this moonless eve, the Faerie 
                Queen works her wiles: so what's fair is foul, and foul's fair!|" 
          MSG_CUSTOM4
            "A mellifluous voice titters, |Let discord and misrule reign eternal!|"
          MSG_CUSTOM5
            "A mellifluous voice intones, |Now, my beautiful plaything, drink 
                deeply of my well of ancient fey dwenomers!|"   
          MSG_CUSTOM6
            "A mellifluous voice intones, |To you, my loyal knight of the trees, I 
                bequithe this ancient faerie magick!|"
          MSG_CUSTOM7
            "A mellifluous voice intones, |A gift I bequeath to thee, for my most
                loyal and <hText> of champions!|"
          MSG_CUSTOM8
            "A mellifluous voice titters, |Let their be dance and music and 
                merryment!|"
          MSG_CUSTOM9
            "A mellifluous voice howls, |Now, my loyal huntsm<hText>n, destroy the
              traitor!|"
          #if 0
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          MSG_BADSAC1
          

               

          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
          
          
          MSG_BLESSING1
          MSG_BLESSING2
          MSG_BLESSING3
          MSG_BLESSING4
          MSG_BLESSING5
          MSG_BLESSING6
          MSG_BLESSING7
          MSG_CROWNED
          #endif
          ,
      * SACRIFICE_LIST
          MA_ELF              SAC_ANGRY
          MA_DROW             10
          MA_DROW             10
          MA_CHOICE1          10
          MA_CHOICE2          5
          MA_CHOICE2          5
          MA_CHOICE2          5 
          MA_CHOICE2          5
          MA_CHOICE2          5,
      * GOD_RELATIONS
          REL_DEFAULT   3     1
          /* Maeve likes Essiah, even if Essiah does not like Maeve */
          $"Essiah" 0 0,
      * CROWNING_GIFTS
          $"Nine Lives Stealer",
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          48000
          96000
          128000
          256000,
      * AID_CHART  
          AID_NEWBOOK      P_LOW      0      
          AID_MANA         P_LOW      0
          AID_TELEPORT     P_LOW      0
          AID_REFRESH      P_LOW      200
          AID_IDENTIFY     T_CLOAK    500
          AID_IDENTIFY     T_RING     500
          AID_IDENTIFY     T_AMULET   500
          AID_IDENTIFY     T_BOW      500
          AID_RESTORE      P_LOW      1000
          AID_RESURRECT    P_MODERATE 1500;    
    Constants:
      * VOICE_COLOUR COL_RAINBOW,
      * ALTAR_COLOUR EMERALD,
      * HOLY_SYMBOL $"Maeve;symbol",
      * CHOSEN_WEAPON $"short bow",
      * CHOSEN_WEAPON_QUALITY WQ_CHAOTIC,
      * CHOSEN_ARMOUR_QUALITY  IQ_FEATHERLIGHT,
      * INTERVENTION_COST 2,
      * RESURRECTION_COST 6,
      * ALTAR_COST 5,
      * PRAYER_TIMEOUT 4,
      * MIN_RAISE_LEVEL 6,
      * MIN_CONVERT_FAVOUR 200,
      * PRAYER_DC 12,
      * LEVEL_BLEEDOFF 7,
      * TOLERANCE_VAL 2,
      * GODPULSE_INTERVAL 25,
      * GODANGER_INTERVAL 7,
      * PERSONAL_ALIGN (AL_CHAOTIC|AL_EVIL),
      * LAY_MULTIPLIER 2;
    Grants:
      Stati[ADJUST_SAC,A_CHA,+1] at 1st level,
      Stati[ADJUST_SAC,A_DEX,+1] at 1st level,
      Stati[EXTRA_SKILL,SK_PERFORM] at 1st level,
      Stati[SKILL_BONUS,SK_PERFORM,+2] at 1st level,
      Ability[CA_ARCANE_WILL,+1] at every 2nd level starting at 2nd,
      Ability[CA_INNATE_SPELL,$"sign of discord"] at 3nd level,
      Stati[ADJUST_SAC,A_CHA,+1] at 4th level,
      Stati[ADJUST_SAC,A_DEX,+1] at 4th level,
      Stati[NEUTRAL_TO,MA_FAERIE] at 4th level,
      Ability[CA_INNATE_SPELL,$"Music of the Spheres"] at 5th level,
      Stati[ADJUST_SAC,A_CHA,+1] at 6th level,
      Stati[ADJUST_SAC,A_DEX,+1] at 6th level,
      Ability[CA_TRICK_MAGIC,+1] at 6th level,
      Ability[CA_INNATE_SPELL,$"Immortal Grandeur"] at 7th level,
      Stati[ADJUST_SAC,A_CHA,+1] at 8th level,
      Stati[ADJUST_SAC,A_DEX,+1] at 8th level,
      Ability[CA_INNATE_SPELL,$"Othello's Irresistable Dance"] at 9th level;
    On Event EV_GODPULSE, EV_ANGER_PULSE {
      hObj h; rID mID, spID; bool first; int16 i;
      EActor->Exercise(A_LUC,4d12,ELUC_MAEVE,80);
      if (e.Event == EV_GODPULSE && EActor->isThreatened() && 1d2 != 1)
        {
          EActor->GodMessage($"Maeve", MSG_CUSTOM8);
          e.eID = $"Othello's Irresistable Dance";
          e.MM |= MM_ENLARGE;
          e.isLoc = true;
          e.EXVal = EActor->x;
          e.EYVal = EActor->y;
          ReThrow(EV_EFFECT,e);
          return DONE;
        }
      
      switch(e.Event == EV_GODPULSE ? 1d8 : 1d4)
        {
          case 1:
            ClearCandidates();
            if (EActor->InSlot(SL_CLOAK) != NULL &&
                EActor->InSlot(SL_CLOAK)->isMagic())
              AddCandidate((int32) EActor->InSlot(SL_CLOAK));
            if (EActor->InSlot(SL_LRING) != NULL &&
                EActor->InSlot(SL_LRING)->isMagic())
              AddCandidate((int32) EActor->InSlot(SL_LRING));
            if (EActor->InSlot(SL_RRING) != NULL &&
                EActor->InSlot(SL_RRING)->isMagic())
              AddCandidate((int32) EActor->InSlot(SL_RRING));
            if (EActor->InSlot(SL_AMULET) != NULL &&
                EActor->InSlot(SL_AMULET)->isMagic())
              AddCandidate((int32) EActor->InSlot(SL_AMULET));
            if (!nCandidates())
              return NOTHING;
            h = (hObj) RandCandidate();
            EActor->GodMessage($"Maeve",MSG_CUSTOM1,
              h->isType(T_RING)   ? "ring" :
              h->isType(T_AMULET) ? "amulet" : "cloak");
            EActor->IDPrint("Your <hObj> vanishes.",
                            "The <hObj2>'s <hObj> vanishes.",
                            h, EActor);
            h->Remove(true);
            return DONE;
          case 2:
            EActor->GodMessage($"Maeve",MSG_CUSTOM2);
            EMap->thEnGenSummXY($"mass summons", EN_HOSTILE|EN_SUMMON|EN_SINGLE, 
              EActor->ChallengeRating()+2, AL_NONGOOD|AL_NONLAWFUL, EActor, 
              EActor->x, EActor->y);      
            return DONE;
          case 3:
            EActor->GodMessage($"Maeve",MSG_CUSTOM3);
            e.eID = $"Maeve's Whimsy";
            ReThrow(EV_EFFECT,e);
            return DONE;
          case 4:
            first = false;
            for(h=EMap->FirstThing();h;h=EMap->NextThing())
              if (h->isCreature() && h->isFriendlyTo(EActor)
                   && h != GetHandle(EActor))
                {
                  if (!first) {
                    first = true;
                    EActor->GodMessage($"Maeve",MSG_CUSTOM4);
                    }
                  h->TurnHostileTo(EActor);
                  EActor->IPrint("The <hObj> turns on you in besotted anger!", h);
                }
            return first ? DONE : NOTHING;
          case 5:
            first = false;
            for (h=EActor->FirstInv();h;h=EActor->NextInv()) {
              if (h->isMagic() && (!h->isCursed()) && (h->GetInherentPlus() != 0) &&
                    (h->GetInherentPlus() < 5)) {
                if (h->ItemLevel() <= (3 + EActor->getGodLevel($"Maeve")*2 +
                                          EActor->Mod(A_CHA)))
                  {
                    if (!first) {
                      first = true;
                      EActor->GodMessage($"Maeve",MSG_CUSTOM4);
                      }
                    EActor->IPrint("Your <hObj> glows with a silvery light!", h);
                    h->SetInherentPlus(h->GetInherentPlus()+1);
                  }
                }
              }
            return first ? DONE : NOTHING;
          case 6:
            EActor->GodMessage($"Maeve", MSG_CUSTOM6);
            if (1d3 == 1)
              spID = theGame->GetEffectID(PUR_DUNGEON,0,
                (EActor->ChallengeRating()+3)/2,AI_DRUIDIC);
            else
              spID = theGame->GetEffectID(PUR_DUNGEON,0,
                (EActor->ChallengeRating()+3)/2,AI_WIZARDRY);
            EActor->IPrint("Knowledge of the dwenomer <Res> imprints itself
              on your mind!", spID);
            EActor->GainTempStati(EFF_FLAG1,NULL,-2,SS_ENCH,
              theGame->SpellNum(spID),0,$"Maeve's Lore",e.vCasterLev);
            EActor->setSpellFlags(spID, EActor->getSpellFlags(spID) 
                      | SP_KNOWN | SP_BARDIC);
            return DONE;
          case 7:
            EActor->GodMessage($"Maeve", MSG_CUSTOM7, (EActor->StateFlags & 
               MS_FEMALE) ? "beautiful" : "handsome");
            do {
              h = GenDungeonItem(IG_GOOD,NULL_ID,EActor->ChallengeRating() + 
                                    EActor->Mod(A_CHA) + 2, 10);
              if (h == NULL_OBJ)
                return DONE;
              if (h->isCursed() || !h->isMagic() || 
                  (h->Size() >= SZ_LARGE && EActor->isSmallRace()) ||
                  h->isType(T_COIN) || h->isType(T_POTION) || h->isType(T_SCROLL))
                {
                  h->Remove(true);
                  h = NULL_OBJ;
                }
              }
            while (h == NULL_OBJ);
            EActor->GainItem(h,false);
            return DONE;
          case 8:
            EActor->IDPrint("You are surrounded in a corona of rainbow
              light!", "The <hObj> is surrounded in a corona of rainbow
              light!", EActor);
            for (h=EMap->FirstThing();h;h=EMap->NextThing())
              if (h->isCreature() && h->isHostileTo(EActor))
                if (h->Perceives(EActor) && h->DistFrom(EActor) <= 12)
                  if (!h->isMType(MA_CONSTRUCT) && h->ResistLevel(AD_MIND) != -1)
                    {
                      h->IPrint("The <hObj>'s heart is forever ensnared!", h);
                      h->GainPermStati(PHD_FREEBIE,NULL,SS_MISC,0,0,$"Maeve");
                      h->MakeCompanion(EActor,PHD_PARTY);
                    }
            return DONE;
        }
      return DONE;
      },            
    EV_RETRIBUTION {
      int16 n, i; hObj hHuntsman;
      n = 1 + e.EParam / 3;
      EActor->GodMessage($"Maeve",MSG_CUSTOM9, n == i ? "a" : "e");
      for (i=0;i!=n;i++)
        {
          hHuntsman = CreateMonster($"elf");
          hHuntsman->AddTemplate($"twilight huntsman;temp");
          hHuntsman->PlaceAt(EMap,EActor->x,EActor->y);
          hHuntsman->TurnHostileTo(EActor);
        }
      },
    EV_PREREQ {
      if (EActor->isMType(MA_GOBLINOID) ||
          EActor->isMType(MA_LIZARDFOLK))
        return ABORT;
      if (EActor->isMType(MA_GOOD))
        if (EActor->LevelAs($"priest") ||
             !EActor->isMType(MA_ELF))
          return ABORT;
      return NOTHING;
      },
    GODWATCH(EV_DEATH) {
      if (EVictim->isMType(MA_DROW))
        EActor->gainFavour($"Maeve",EVictim->ChallengeRating() * 50,false,true);
      return NOTHING;
      },
    GODWATCH(EV_ALIGNED) {
      if (e.EParam & AL_NONCHAOTIC)
        EActor->Transgress($"Maeve",e.vMag,false,"unchaotic act");
      return NOTHING;
      },
    GODWATCH(EV_QUELL), GODWATCH(EV_SURRENDER) {
      if (EVictim->isMType(MA_DROW))
        EActor->Transgress($"Maeve",4,false,"yielding to drow");
      return NOTHING;
      },
    GODWATCH(EV_ENLIST) {
      if (EVictim->isMType(MA_DROW))
        EActor->Transgress($"Maeve",8,false,"befriending drow");
      return NOTHING;
      },
    EV_SACRIFICE {
      if (GetHandle(EVictim) == NULL_OBJ)
        {
          if (EItem->isType(T_CLOAK) || EItem->isType(T_RING) ||
              EItem->isType(T_GEM) || EItem->isType(T_AMULET))
            e.EParam = MA_CHOICE1;
          return NOTHING;
        }
      if (EVictim->GetAttr(A_CHA) <= 12)
        return NOTHING;
      if (EVictim->isMType(MA_ABERRATION) ||
          EVictim->isMType(MA_GOBLINOID) ||
          EVictim->isMType(MA_ELF) ||
          EVictim->isMType(MA_DROW))
        return NOTHING;
      e.vMag = 50 * (EVictim->GetAttr(A_CHA) - 12)
                 * (EVictim->GetAttr(A_CHA) - 12);
      if (e.DType > 0 || EVictim->isDead())
        e.vMag *= 3;
      e.EParam = MA_CHOICE2;
      return NOTHING;
      };
  }

Effect "Maeve's Whimsy" : EA_POLYMORPH
  { Flags: EF_PERSISTANT;
    On Event EV_MAGIC_HIT {
      do {
        e.rval = theGame->GetMonID(PUR_POLY, -4, 6, 1, MA_NLIVING);
        }
      while
        (ResourceHasFlag(e.rval,M_NOHANDS) ||
         (!ResourceHasFlag(e.rval,M_HUMANOID)) ||
         ResourceHasFlag(e.rval,M_BLIND));
      return NOTHING;
      };
    Desc: "A fit of whimsy of the part of Maeve, the Queen of the
      Faeries, has transformed this follower into a shape not his
      own until the next sunrise, when fae dwenomers traditionally
      shatter.";
  }

Effect "Maeve's Lore" : EA_GENERIC
  { SC_DIV; 
    Desc: "Maeve has blessed you with knowledge of a single specific
      dwenomer for one full day.";
    On Event EV_REMOVED {
      rID spID2;
      spID2 = theGame->SpellID(e.vVal);
      EActor->IPrint("The knowledge of <9><Res><7> fades from your mind.",spID2);
      EActor->setSpellFlags(spID2,EActor->getSpellFlags(spID2) & 
                              ~(SP_BARDIC|SP_KNOWN));
      return NOTHING;
      };
  }


AI_SYMBOL Effect "Sabine;symbol" : EA_GENERIC
   { Flags: EF_NOGEN; 
   Desc: "Sabine's holy symbol is a forking bolt of lightning, representing
	choice and the metaphorical 'road not taken'. " ; }

God "Sabine"
  {
    Domains: $"Air", $"Chaos", $"Destruction", $"Luck", $"Time", $"Weather";
	Desc: "<15>God of Storms, Athletics, Prophecy and Transformations<11>
        \n__Air, Chaos, Destruction, Luck, Time, Weather. The Javelin.
        Returning Weapons.<2>
	\n__Furious, capricious and destructive, Sabine blows away the old in
	order to make room for the new. Representing renewal and regeneration,
	Sabine's clerics tear apart their own lives and those of others in order
	to reinvent themselves continually. Sabine appreciates upheaval,
	revolution and schisms, but also grants those with foresight the luck
	they need to survive in such chaotic times. He is a capricious god, but
	unlike Maeve he at least has compassion for those souls his acts destroy.
	Still, Sabine's fury cannot be restrained or limited, only guided and
	channelled. Sabine is much hated by his younger brother Immotian, who
	never could control him, and the official doctrine of Immotian's church
	is that Sabine is a dangerous terrorist and his clergy should be purged
	whenever they are discovered. However noble their reasons might be, there
	is more truth in this than most Stormbringers would care to admit.
	\n__Sabine appears as an effeminate young man of pale skin, dark hair and
	great beauty, and he carries with him a crook that gives him absolute
	authority over the weather on Therya, both good and bad. His priests
	call themselves Stormbringers, and are most frequently either sailors
	or athletes of some kind. Sabine will grant visions of the future to
	those who are willing, but receiving these revelations from him requires
	great ordeal and physical exertion, driving one's body to its limits in
	order to induce a fugue state. In Theryan mythology, Sabine plays the
	role of Cassandra: he is predestined to destroy the world at the end of
	time, so that a new one may be born, but no one will heed his warnings
	of the end times until it is too late and his grimmest duty is upon him.
	\n__Sabine's holy symbol is a forking bolt of lightning, representing
	choice and the metaphorical 'road not taken'. He is Chaotic Neutral, and
	his clerics may be of any alignment. His chosen weapon is the javelin,
	and his priests may choose from the domains of Air, Chaos, Destruction,
	Luck, Time and Weather.\n
	__<10>Worship:<2> Sabine appreuciates the sacrifice of creatures killed
	in a state of shock (i.e., when off-guard), creatures killed by
	lightning, previously uninjured creatures killed with a single attack
	and creatures killed by a worshipper when the worshipper is in an
	altered state of consciousness (such as berserk rage, confusion or a
	trance). The more of these factors can be met in a single kill, the
	more pleasing the kill is to Sabine. He is pleased when his followers
	develop and use their athletic abilities -- running, jumping, climbing,
	swimming and tumbling -- and when they perform challenging feats of
	metamagic to increase the raw power output of their magic in times
	when they are in genuine danger.\n
	__Sabine expects his followers to be risk-takers, and is angered
	when they act overly cautiously. He is also angered when they perform
	unchaotic acts or rely on aid from allies -- followers of Sabine are
	expected to be independant and solitary.\n
	__<10>Blessings:<2> For a follower who has gained a minimal degree of
	favour, Sabine will strike at enemies with lightning, remove fatigue,
	replenish the spirit, clear the mind and offer resurrection in case 
	of death -- if the follower is sufficiently skilled, Sabine will
	raise her with even minimal favour. For more favoured worshippers, 
	Sabine will (in order of increasing favour) remove curses, refill mana
	and purify the body.\n
	__Sabine's more permanent blessings include athletic aptitude, the
	ability to use wands -- the most elementally destructive of magical
	devices -- more effectively, the ability to see clearly though fog
	and for the more experienced follower, the ability to change one's
	own shape. Sabine's most famous granted power, however, is the ability
	to throw bolts of lightning, which increase in power as the follower
	increases in favour with the god. The most treasured followers of Sabine
	find that if they push themselves to their limits, they can exceed what
	they would have previously thought possible.";
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|Life is a whirlwind. Cast free your tethers, dive forward
               and watch as you soar!|"
          MSG_BLESSING7
            "|I grant thee the potential for excellence!|"
          MSG_CUSTOM1
            "A resonant voice speaks: |Thou hast grown too static --
                 be changed!|"
          MSG_CUSTOM2
            "<11>You are struck by a bolt of inspiration!<7>"
            
          #if 0
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          MSG_BADSAC1
          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
          
          
          MSG_BLESSING1
          MSG_BLESSING2
          MSG_BLESSING3
          MSG_BLESSING4
          MSG_BLESSING5
          MSG_BLESSING6
            
            
          
          MSG_CROWNED
          #endif
          ,
      * SACRIFICE_LIST
          MA_CHOICE1     5
          MA_CHOICE1     5
          MA_CHOICE1     5,
      * GOD_RELATIONS
          REL_DEFAULT     1     0
          $"Ekliazeh" 7 1
          $"Hesani" $"Erich" $"Xel" $"The Multitude" 5 1
          $"Essiah" $"Semirath" $"Maeve" $"Khasrach" 0 0,
      * CROWNING_GIFTS
          $"Nine Lives Stealer",
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          48000
          64000
          92000
          128000,
      * FAVOURED_SKILLS SK_ATHLETICS SK_CLIMB SK_JUMP
                       SK_SWIM SK_TUMBLE,
      * AID_CHART  
          AID_SMITE        P_LOW    100           
          AID_REFRESH      P_LOW    100     
          AID_RESTORE      P_LOW    100
          AID_CLARITY      P_LOW    100
          AID_RESURRECT    P_LOW    100
          AID_UNCURSE      P_LOW    300 
          AID_MANA         P_LOW    500
          AID_PURIFY       P_LOW    750;    
    Constants:
      * VOICE_COLOUR COL_ELEC,
      * ALTAR_COLOUR SKYBLUE,
      * HOLY_SYMBOL $"Sabine;symbol",
      * CHOSEN_WEAPON $"javelin",
      * CHOSEN_WEAPON_QUALITY WQ_SHOCKING,
      * INTERVENTION_COST 3,
      * RESURRECTION_COST 14,
      * ALTAR_COST 5,
      * PRAYER_TIMEOUT 7,
      * MIN_RAISE_LEVEL 7,
      * MIN_CONVERT_FAVOUR 200,
      * PRAYER_DC 8,
      * LEVEL_BLEEDOFF 0,
      * TOLERANCE_VAL 3,
      * GODPULSE_INTERVAL 10,
      * GODANGER_INTERVAL 30,
      * PERSONAL_ALIGN (AL_CHAOTIC),
      * LAY_MULTIPLIER 4;
    Grants:
      Stati[EXTRA_SKILL,SK_ATHLETICS] at 1st level,
      Stati[EXTRA_SKILL,SK_CLIMB]     at 1st level,
      Stati[EXTRA_SKILL,SK_JUMP]      at 1st level,
      Stati[EXTRA_SKILL,SK_SWIM]      at 1st level,
      Stati[SKILL_BONUS,SK_ATHLETICS,+4] at 1st level,
      Stati[SKILL_BONUS,SK_USE_MAGIC,+4] at 2nd level,
      Ability[CA_INNATE_SPELL,$"lightning bolt;of sabine"] at 3rd level,
      Ability[CA_NATURE_SENSE] at 4th level,
      Ability[CA_INNATE_SPELL,$"polymorph self"] at 5th level,
      Ability[CA_INNATE_SPELL,$"premonition"] at 6th level,
      Ability[CA_INHERANT_POTENTIAL,+1] at 7th level,
      Ability[CA_INNATE_SPELL,$"polymorph other"] at 5th level,
      Ability[CA_INHERANT_POTENTIAL,+1] at 9th level;
    bool was_uninjured; int32 riskBalance;
    On Event EV_GIVE_AID {
      hObj hEnemy;
      if (e.EParam == AID_SMITE)
        {
          for (hEnemy=EMap->FirstThing();hEnemy;hEnemy=EMap->NextThing())
            if (hEnemy->isCreature() && hEnemy->DistFrom(EActor) < 15)
              if (hEnemy->isHostileTo(EActor))
                {
                  hEnemy->IDPrint("You are engulfed in a pillar of lightning!",
                    "The <hObj> is engulfed in a piller of lightning!", hEnemy);
                  ThrowDmg(EV_DAMAGE,AD_ELEC,10d6,"the fury of Sabine",
                             hEnemy, hEnemy); 
                }
          if (EActor->isThreatened())
            {
              EActor->IPrint("Sabine gifts you with a burst of divine speed!");
              EActor->GainTempStati(ADJUST_SAC,NULL,150,SS_MISC,A_MOV,20,$"Sabine");
              EActor->GainTempStati(ADJUST_SAC,NULL,150,SS_MISC,A_SPD,20,$"Sabine");
            }
          return DONE;
        }
      return NOTHING;
      },
    EV_RETRIBUTION {
      EActor->IDPrint("You are engulfed in a pillar of lightning!",
        "The <hObj> is engulfed in a piller of lightning!", EActor);
      ThrowDmg(EV_DAMAGE,AD_ELEC,(e.EParam)d6,"the fury of Sabine",
                  EActor, EActor); 
      return DONE;
      },
    GODWATCH(PRE(EV_DAMAGE)) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (EVictim->cHP >= EVictim->mHP + EVictim->GetAttr(A_THP))
        was_uninjured = true;
      else
        was_uninjured = false;
      return NOTHING;
      },
    GODWATCH(EV_DEATH) {
      int16 factor;
      factor = 0;
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (e.isSurprise && e.isFlatFoot)
        factor++;
      if (e.DType == AD_ELEC ||
          (GetHandle(EItem) != NULL_OBJ &&
            EItem->HasQuality(WQ_SHOCKING)) ||
          (GetHandle(EItem2) != NULL_OBJ &&
            EItem2->HasQuality(WQ_SHOCKING)))
        factor++;
      if (was_uninjured)
        factor++;
      was_uninjured = false;
      if (EActor->HasStati(RAGING) || EActor->HasStati(CONFUSED) ||
          EActor->HasStati(ANC_MEM) || EActor->HasStati(ENRAGED))
        factor++;
      if (factor) 
        EVictim->GainPermStati(CORPSE_FLAG,EActor,SS_MISC,factor,0,$"Sabine");
      return NOTHING;
      },
    EV_SACRIFICE {
      if (GetHandle(EVictim) == NULL_OBJ)
        return NOTHING;
      if (EVictim->HasEffStati(CORPSE_FLAG,$"Sabine"))
        {
          e.vMag = XCR(EVictim->ChallengeRating()) * 
              EVictim->GetEffStatiVal(CORPSE_FLAG,$"Sabine");
          e.EParam = MA_CHOICE1;
        }
      return NOTHING;
      }, 
    PRE(EV_CAST) {
      if (EActor->isThreatened() && e.eID->Purpose == EP_ATTACK)
        {
          if (e.MM & (MM_MAXIMIZE|MM_EMPOWER|MM_HEIGHTEN))
            EActor->gainFavour($"Sabine",XCR(MMFeatLevels(e.MM))/10,false,true);
        }
      return NOTHING;
      },
    EV_GODPULSE {
      hObj h; bool found_ally;
      
      found_ally = false;
      if (EActor->GodID == $"Sabine")
        for (h=EMap->FirstThing();h;h=EMap->NextThing())
          if (h->isCreature() && h != GetHandle(EActor) &&
              h->isFriendlyTo(EActor) && h->PartyID == EActor->PartyID)
            {
              EActor->Transgress($"Sabine",1,false,"relying on others");
              found_ally = true;
            }
      if (found_ally)
        return DONE;
        
      if (EActor->getGodLevel($"Sabine") < 3)
        return DONE;
      
      EActor->GodMessage($"Sabine", MSG_CUSTOM2);
      EActor->GainXP(10 * EActor->TotalLevel() *
                           EActor->getGodLevel($"Sabine"));
      EActor->Exercise(A_INT,5d12,EINT_SABINE,70);
      return DONE;
      },
    EV_ANGER_PULSE {
      EActor->GodMessage($"Sabine", MSG_CUSTOM1);
      EActor->SwapAttributes(1 + (EActor->getAnger($"Sabine")-3)/5);
      return DONE;
      },
    EV_CALC_FAVOUR {
      e.EParam = (e.EParam * (20 + EActor->
        SkillLevel(SK_ATHLETICS) + (
          EActor->SkillLevel(SK_SWIM) +
          EActor->SkillLevel(SK_JUMP) +
          EActor->SkillLevel(SK_CLIMB) +
          EActor->SkillLevel(SK_TUMBLE))/4))/20;
      return NOTHING;
      },
    GODWATCH(EV_ENLIST) {
      if (EActor->GodID == $"Sabine")
        EActor->Transgress($"Sabine",2,false,"relying on others");
      return NOTHING;
      },
    GODWATCH(EV_STRIKE) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (e.AType == A_GREA && EActor->isThreatened())
        EActor->gainFavour($"Sabine",10 * EVictim->ChallengeRating());
      return NOTHING;
      },
    GODWATCH(EV_ALIGNED) {
      if (e.EParam & AL_NONCHAOTIC)
        EActor->Transgress($"Sabine",(e.vMag + 1) / 2,false,"unchaotic act");
      return NOTHING;
      },
    GODWATCH(POST(EV_DAMAGE)) {
      if (!EActor->isCharacter())
        return NOTHING; 
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (EVictim->ChallengeRating() > EActor->TotalLevel())
        riskBalance += EVictim->ChallengeRating() - EActor->TotalLevel();
      else if (EActor->TotalLevel() - 2 >= EMap->Depth)
        riskBalance -= EActor->TotalLevel() - 2 >= EMap->Depth;
      return NOTHING;
      },
    GODWATCH(POST(EV_REST)) {
      if (riskBalance < -10) {
        if (EActor->GodID == $"Sabine") {
          EActor->IPrint("You fear you are working overly cautiously for
                    one seeking Sabine's favour.");
          EActor->Transgress($"Sabine",1 - riskBalance/20,false,
                   "overly cautious");
          }
        riskBalance = 0;
        }
      return NOTHING;
      };
  }
  
Effect "Lightning Bolt;of Sabine" : EA_BLAST
  { SC_EVO; Cost: 17; sval: REF partial; Flags: EF_SPECABIL, EF_HARDSAVE4;
    xval: AD_ELEC; pval: (LEVEL)d6; Purpose: EP_ATTACK;
    aval: AR_BEAM; qval: Q_DIR | Q_TAR; cval: YELLOW; lval: 15; 
    On Event PRE(EV_EFFECT) {
      e.vCasterLev = EActor->getGodLevel($"Sabine") * 3;
      if (EActor->getGodAnger($"Sabine"))
        {
          EActor->IPrint("Nothing happens.");
          return DONE;
        }
      return NOTHING;
      },
    EV_CALC_EFFECT {
      e.vCasterLev = EActor->getGodLevel($"Sabine") * 3;
      SetPVal(e,0,e.vCasterLev,6);
      return NOTHING;
      };
    Desc: "Sabine grants his followers the ability to cast lightning
      bolts inflicting a number of d6's worth of damage commensurate
      with that follower's favour with him. A Reflex saving throw
      halves the damage inflicted.";
  }


AI_SYMBOL Effect "Semirath;symbol" : EA_GENERIC
   { Flags: EF_NOGEN; 
     Desc: "Semirath's holy symbol is a crystalline chakram." ;
   } 
 
God "Semirath"
  {                                          
    Domains: $"Chaos", $"Good", $"Liberation", 
      $"Luck", $"Retribution", $"Trickery"; 
    Desc: "<15>God of Justice, Laughter and Freedom<11>
      \n__Chaos, Good, Liberation, Luck, Retribution, Trickery. The
      Chakram. Weapons of Distance.<2>
      \n__Much maligned by the more solemn dieties, Semirath is the
      patron deity of jesters, guards and anyone who appreuciates
      the joyful absurdity of life. He entreats his followers to
      protect the individual rights and freedoms of thinking creatures
      of every sort, irregardless of race, social station or outlook.
      Semirath is an incorrigable trickster, but his games always
      target those who have done something deserving, whether they
      take the form of gentle chastisement or brutal guerilla warfare.
      Beneath his casual demeanour, Semirath harbours a deep devotion to
      equal justice, and a desire to punish those who have wrongfully
      taken joy or freedom from others. His clergy work tirelessly to
      bring down corrupt autocracies, punish domination and liberate
      the oppressed, and their schismatic touch has collapsed more
      than one evil empire.
      \n__Optimism is a central virtue to the clergy of Semirath --
      his notion of freedom emcompasses not only the removal of
      external restrictions, but freedom from the limits that despair,
      pragmatism and cynicism place upon a soul. A very few paladins
      serve Semirath, though many find it difficult to reconcile the
      paladin's devotion to law with a god to whom dirty tricks are
      just a way of life.
      \n__Semirath's holy symbol is a crystalline chakram, and that
      is also his chosen weapon. He offers his clerics the powers and
      spells from the Domains of Chaos, Good, Liberation, Luck, Retribution
      and Trickery. He is Chaotic Good, though he cheerfully accepts 
      clerics of any Good alignment.\n
      __<10>Worship:<2> Semirath will accept any evil creature as a
      sacrifice, though he especially appreuciates the sacrifice of 
      creatures who embody tyrrany (such as illithids or beholders 
      and their creations) as well as common bandits, outlaws and 
      brigands that lurk in the shadows in cities, bringing fear to
      honest folk. He also accepts the sacrifice of magical items used
      to mentally enslave or control others.\n
      __Semirath is a tolerant and forgiving god, but can be angered
      if his followers commit evil acts repeatedly. He is also gravely
      angered if his followers kill a good member of a normally evil
      species, seeing this as essentially a hate crime. Killing any
      non-evil sapient creature is also to be avoided, though less
      serious -- Semirath prefers his followers to trick and finangle
      rather than slay when not dealing with evil. Outsiders (including
      elementals) are exempt from this restriction, because they can be
      exceptionally alien and difficult to communicate with, and do not
      truly 'die' when slain on the Prime Material Plane, instead 
      returning to their natural homes.\n 
      __Semirath approves of risk-takers and dislikes caution in the
      same sense that Sabine does.\n
      __It's said that a silver tongue and skill as an entertainer
      amplify favour with Semirath; in a more general sense, competance
      and skillfully larcenous solutions to problems please him.\n
      __<10>Blessings:<2> Semirath is more willing to come to the aid
      of his followers more frequently than most gods. He will heal,
      purify the body, teleport to safety, ease hunger or fatigue or
      replace spellbooks for followers with only minimal favour. For
      those who have followed him longer and done more in his name, he
      will cure blindness and permanent wounds, lift curses and grant
      incredible luck and grace in combat. He has also been known to
      resurrect those that have served him more loyally still.\n
      __His permanent blessings include the ability to develop certain
      larcenous skills, inherent magic suited to trickery and pranks
      and augmented agility and intellect.";
    Flags: GF_GOOD, GF_FORGIVING, GF_COMBAT_PULSE, GF_COMBAT_ANGER;
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|Now, my child, go forth and teach the legions of ignorance 
              that there are many fates worse than death, and some even 
              involve radishes!|"
          MSG_CUSTOM1
            "A boyish voice speaks: |Leave my follower alone, you cretins!|"
          MSG_CUSTOM2
            "A boyish voice speaks: |Gratuitous nudity is *always* appropriate!|",
          
          #if 0
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          MSG_BADSAC1
          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
          
          
          MSG_BLESSING1
          MSG_BLESSING2
          MSG_BLESSING3
          MSG_BLESSING4
          MSG_BLESSING5
          MSG_BLESSING6
          MSG_BLESSING7
          MSG_CROWNED
          #endif
      * SACRIFICE_LIST
          MA_ILLITHID      10
          MA_EYE           10
          MA_EVIL          5
          MA_EVIL          5
          MA_CHOICE1       15
          MA_CHOICE1       15
          MA_CHOICE2       12
          MA_CHOICE2       12,
      * GOD_RELATIONS
          REL_DEFAULT   0     0
          $"Erich" $"Immotian" $"Ekliazeh" 2 0
          $"Zurvash" $"Xel" $"The Multitude" 5 1,
      * CROWNING_GIFTS
          $"Nine Lives Stealer",
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          54000
          96000
          102000
          250000,
      * FAVOURED_SKILLS
          SK_BLUFF        10
          SK_PERFORM      10
          SK_DISGUISE     10
          SK_LOCKPICKING  5
          SK_HANDLE_DEV   5
          SK_BALANCE      5
          SK_JUMP         5
          SK_METAMAGIC    5
          SK_SPELLCRAFT   5
          SK_TUMBLE       5
          SK_USE_MAGIC    5,
      * AID_CHART  
          AID_HEAL      P_LOW       100
          AID_PURIFY    P_LOW       100
          AID_BERSERK   P_MODERATE  1000
          AID_UNCURSE   P_MODERATE  1000
          AID_TELEPORT  P_HIGH      100
          AID_FEED      P_LOW       100  
          AID_DEFLECT   P_LOW       100       
          AID_REFRESH   P_LOW       100
          AID_CURE      P_MODERATE  1000   
          AID_RESURRECT P_HIGH      2000   
          AID_NEWBOOK   P_LOW       100;    
    Constants:
      * VOICE_COLOUR MAGENTA,
      * ALTAR_COLOUR MAGENTA,
      * HOLY_SYMBOL $"Semirath;symbol",
      * CHOSEN_WEAPON $"chakram",
      * CHOSEN_WEAPON_QUALITY WQ_DISTANCE, /* Later, Velocity? */
      * INTERVENTION_COST 3,
      * RESURRECTION_COST 12,
      * ALTAR_COST 5,
      * PRAYER_TIMEOUT 5,
      * MIN_RAISE_LEVEL 5,
      * MIN_CONVERT_FAVOUR 100,
      * PRAYER_DC 8,
      * LEVEL_BLEEDOFF 6,
      * TOLERANCE_VAL 5,
      * GODPULSE_INTERVAL 10,
      * GODANGER_INTERVAL 20,
      * PERSONAL_ALIGN (AL_CHAOTIC|AL_GOOD),
      * LAY_MULTIPLIER 5;
    Grants:
      Stati[EXTRA_SKILL,SK_BLUFF] at 1st level,
      Stati[EXTRA_SKILL,SK_PERFORM] at 1st level,
      Stati[EXTRA_SKILL,SK_DISGUISE] at 1st level,
      Ability[CA_INNATE_SPELL,$"Change Self"] at 2nd level,
      Ability[CA_INNATE_SPELL,$"Stinking Cloud"] at 2nd level,
      Stati[ADJUST_SAC,A_DEX,+1] at 3rd level,
      Stati[ADJUST_SAC,A_INT,+1] at 3rd level,
      Stati[ADJUST_SAC,A_DEX,+1] at 4th level,
      Stati[ADJUST_SAC,A_INT,+1] at 4th level,
      Ability[CA_INNATE_SPELL,$"Dimension Door"] at 5th level,
      Stati[EXTRA_FEAT,FT_DODGE] at 6th level,
      Stati[EXTRA_FEAT,FT_BACKSTAB] at 7th level,
      Ability[CA_INNATE_SPELL,$"Othello's Irresistable Dance"] at 8th level,
      Ability[CA_INNATE_SPELL,$"Power Word: Stun"] at 9th level;
    int32 riskBalance, rbTimer;
    On Event EV_GIVE_AID {
        if (e.EParam == AID_BERSERK) {
          ThrowEff(EV_EFFECT,$"Semirath's Aid",EActor,EActor);
          return DONE;
          }
        return NOTHING;
      },
    EV_RETRIBUTION {
      EActor->IDPrint("Rancid milk and animal entrails rain down upon you!",
                        "Rancid milk and animal entrails rain down upon the <hObj>!",EActor);
      ThrowDmg(EV_DAMAGE,AD_SOAK,(e.EParam)d6,"the vengeance of Semirath",
                  EActor, EActor);
      EActor->GainTempStati(NAUSEA,NULL,3d6,SS_MISC);
      ThrowEff(EV_EFFECT,$"Bestow Curse",EActor,EActor);
      return DONE;
      },
    EV_GODPULSE {
      /* When we do /fumble/, we'll have it apply to all the combat enemies
         here, later. */
      bool found; hObj hMon;
      found = false;
      for (hMon=EMap->FirstThing();hMon;hMon=EMap->NextThing())
        if (hMon->isCreature() && EActor->DistFrom(hMon) <= 12)
          if (hMon->isHostileTo(EActor) && EMap->LineOfFire(
                 hMon->x, hMon->y, EActor->x, EActor->y, hMon) &&
              hMon->isMType(MA_SAPIENT) && hMon->HasMFlag(M_HUMANOID) &&
              !hMon->isMType(MA_GOOD))
            {
              if (!found)
                {
                  found = true;
                  EActor->GodMessage($"Semirath",MSG_CUSTOM1);
                }
              SetSilence();
              hMon->GainPermStati(PRONE,NULL,SS_MISC);
              hMon->GainTempStati(STUNNED,NULL,3d6,SS_MISC);
              UnsetSilence();
              hMon->IDPrint("You collapse in a fit of uncontrollable laughter!",
                            "The <hObj> collapses in a fit of uncontrollable 
                            laughter!", hMon);
            }
      return found ? DONE : NOTHING;
      },
    EV_ANGER_PULSE {
      hObj hItem; int16 x, y, n, i;
      if (EActor->getAnger($"Semirath") <= 10)
        ReThrow(EV_RETRIBUTION,e);
      EActor->GodMessage($"Semirath",MSG_CUSTOM2);
      ClearCandidates();
      for (hItem=EActor->FirstInv();hItem;hItem=EActor->NextInv())
        if (!(hItem == EActor->InSlot(SL_LIGHT) ||
              hItem == EActor->InSlot(SL_PACK)))
          AddCandidate((int32)hItem);
      n = nCandidates();
      for (i=0;i!=n;i++)
        {
          hItem = (hObj)GetCandidate(i);
          hItem->Remove(false);
          do {
            x = random(EMap->SizeX());
            y = random(EMap->SizeY());
            }
          while (EMap->SolidAt(x,y) || EMap->FallAt(x,y) ||
                 ResourceHasFlag(EMap->TerrainAt(x,y),TF_WARN) ||
                 ResourceHasFlag(EMap->TerrainAt(x,y),TF_WATER) ||
                 ResourceHasFlag(EMap->TerrainAt(x,y),TF_DEEP_LIQ));
          hItem->PlaceAt(EMap,x,y);
        }
      return DONE;
      },
    GODWATCH(EV_ALIGNED) {
      if (e.EParam & (AL_NONGOOD|AL_EVIL))
        EActor->Transgress($"Semirath",(e.vMag+1)/2,
          (1d6 == 1) && (EActor->getGod() == $"Semirath"),
          "evil act");
      return NOTHING;
      },
    GODWATCH(EV_DEATH) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (ResourceHasFlag(EVictim->mID,M_EVIL) &&
           !EVictim->isMType(MA_EVIL) &&
           EVictim->isMType(MA_SAPIENT) &&
           !EVictim->isMType(MA_CONSTRUCT))
        EActor->Transgress($"Semirath",8,false,
          "killing a heroic member of a normally evil race");
      else if (EVictim->isMType(MA_SAPIENT) &&
                !EVictim->isMType(MA_EVIL) &&
                !EVictim->isMType(MA_OUTSIDER) &&
                !EVictim->isMType(MA_ELEMENTAL))
        EActor->Transgress($"Semirath",4,false,
          "killing a non-evil, thinking creature");
      return NOTHING;
      },
    EV_CALC_FAVOUR {
      e.EParam = (e.EParam * (20 + EActor->GetSkillRanks(SK_PERFORM) +
                    EActor->GetSkillRanks(SK_BLUFF))) / 20;
      return NOTHING;
      },
    GODWATCH(POST(EV_STRIKE)) {
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (EVictim->isMType(MA_EVIL) && e.isSurprise)
        EActor->gainFavour($"Semirath",10*max(1,EVictim->
          ChallengeRating()),false,true);
      return NOTHING;
      },
    GODWATCH(POST(EV_DAMAGE)) {
      if (!EActor->isCharacter())
        return NOTHING; 
      if (GetHandle(EActor) == GetHandle(EVictim) || 
            !ETarget->isCreature())
        return NOTHING;
      if (EVictim->ChallengeRating() > EActor->TotalLevel())
        riskBalance += EVictim->ChallengeRating() - EActor->TotalLevel();
      else if (EActor->TotalLevel() - 2 >= EMap->Depth)
        riskBalance -= EActor->TotalLevel() - 2 >= EMap->Depth;
      return NOTHING;
      },
    GODWATCH(POST(EV_REST)) {
      if (riskBalance < -10) {
        if (EActor->GodID == $"Semirath")
          EActor->IPrint("You fear you are working overly cautiously for
                    one seeking Semirath's favour.");
        EActor->Transgress($"Semirath",1 - riskBalance/20,false,
          "overly cautious");
        riskBalance = 0;
        }
      return NOTHING;
      },
    PRE(EV_SACRIFICE) {
      if (GetHandle(EItem) != NULL_OBJ)
        if (EItem->ieID == $"Surtur" ||
            EItem->ieID == $"Beast Control" ||
            EItem->ieID == $"Undead Control" ||
            EItem->ieID == $"Elemental Control" ||
            EItem->ieID == $"Outsider Control" ||
            EItem->ieID == $"the Abyss" ||
            EItem->ieID == $"the Chameleon" ||
            EItem->ieID == $"Elemental Command (Air)" ||
            EItem->ieID == $"Elemental Command (Earth)" ||
            EItem->ieID == $"Elemental Command (Fire)" ||
            EItem->ieID == $"Elemental Command (Water)" ||
            EItem->ieID == $"Medallion of Mental Domination")
          e.EParam = MA_CHOICE1;
      if (GetHandle(EVictim) != NULL_OBJ)
        if (EVictim->isCreature())
          if (EVictim->HasEffStati(TEMPLATE,$"bandit"))
            e.EParam = MA_CHOICE2;
      return NOTHING;
      };
  }
  
Effect "Semirath's Aid" : EA_INFLICT
  {
    On Event MSG_CAST
      "You are overcome with a sublime feeling of grace and luck!",
    EV_ELAPSED
      "The feeling of grace and luck fades.";
    xval: ADJUST_SAC; yval: A_DEF; pval: +8;
  }
and EA_INFLICT
  { xval: ADJUST_SAC; yval: A_SAV; pval: +8; }


AI_SYMBOL Effect "Xavias;symbol" : EA_GENERIC
   { Flags: EF_NOGEN; 
     Desc: "The holy symbol of Xavias is a pyramid overlaid with an eye-like
      glyph." ; 
   } 

God "Xavias"
  {
    Domains: $"Craft", $"Fate", $"Knowledge", $"Magic", $"Mysticism", $"Planning";
    Desc: "<15>God of Science and the Mysteries<11>
      \n__Craft, Fate, Knowledge, Magic, Mysticism, Planning. The Arbalest. Quick-Loading Bows.<2>
      \n__If Erich is Immotian's mailed right fist of enforcement, then Xavias
      serves as his open left hand of revelation. Embodying the holiness in
      things which are unknowable as well as humanity's quest to understand all
      that can be known, Xavias is the patron of scientists, rationalists,
      architects and mystics -- and he sees no contradiction in this. While
      Xavias is strictly loyal to Immotian, he's certainly more open-minded
      and liberal than his superior, viewing arcane magic as a natural part
      of the world, albiet one that must be handled cautiously and patiently
      to avoid corruption. Xavias is rumoured to have been involved in the
      founding of the guilds, especially the stonecrafters' guild, but of
      course there are many secret and archaic legends surronding him, since
      his priesthood is essentially a large-scale mystery cult.\n
      __Outsiders accuse clergy of Xavias of using high ritual and mysticism
      to cow the masses into accepting Immotian's power and authority, and
      perhaps there is some truth in this. But Xavias wants nothing more than
      for his followers to examine, scrutinize and face the world with eyes
      wide open. Ineffibility certainly does play a part in his teachings,
      but only in the sense that some secrets cannot be told, only experienced.
      Xavias' priesthood is wealthy and influential, connected to the guilds
      far more closely than Immotian's is, and being possessed of a much more
      politically adept mindset. There is much ceremony for the sake of
      ceremony within Xavias' ranks, with great importance placed upon titles,
      initiation rites and concealed mysteries.\n
      __The holy symbol of Xavias is a pyramid overlaid with an eye-like
      glyph, and his chosen weapon is the arbalest. His Domains are Craft, Fate,
      Knowledge, Magic, Mysticism and Planning. Xavias is Neutral Good.\n
      __<10>Worship:<2> Xavias accepts the sacrifice of any evil creatures, 
      though what he truly delights in is the offering of blood from any 
      creature who embodies destructive ignorance, such as trolls or ogres. 
      He is also pleased when his followers perform alchemy or craftwork,
      evoke magical devices, translate old script or successfully gain insight
      into the true nature of other creatures. Xavias values knowledge very
      highly. He dislikes his priests destroying enchanted items or other works 
      of great craft, such as art or masterwork weapons. He is also, predictably,
      angered when his children commit evil acts, though he is also tolerant of
      occasional mistakes.\n
      __Xavias' church is an esoteric faith, and his worshippers must possess
      a certain minimum level of intellect and spiritual insight in order to
      be initiated into the higher mysteries. His priests sometimes try to
      altar their state of consciousness or enter an ecstatic trance to
      become closer to him.\n
      __<10>Blessings:<2> Xavias is quite free with aid, being willing to
      intercede with reasonable frequency and not holding pleas against
      followers for long provided they continue to progress in their lives.
      He will ease hunger, clear the mind, replace spellbooks and remove
      fatigue from anyone who petitions him. For a casual follower, he will
      identify magical items; for a moderately devoted disciple, he will
      purify the body; for a devoted student of his path he will uncurse
      items, replenish mana or grant resurrection. He has been known to 
      offer instantaneous transport away from danger for his followers; the
      more loyal the follower, the less severe the danger must be to warrant
      his aid.\n
      __Xavias' more permanent blessings include the ability to develop
      skill with craftwork, language and magical artifice, an occult veil
      to conceal his followers' mysteries from magical perceptions,
      augmented intellect and perception and the ability to see clearly
      past obscurements literal as well as metaphorical. His most loyal
      followers are said to be able to craft magical arms and armour in much
      the same way dwarves do, and to have access to occult hideaways outside
      the bounds of normal reality.";
    Flags: GF_NO_EVIL, GF_COMBAT_ANGER; 
        Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|And the path of the Golden Lion, the Philosopher's Treasure, the
               Glory of Transmutation shall soon be lain clear before thee!|"
          MSG_CUSTOM1
            "An elderly voice speaks sadly, |Forgive me, my child: thou lacks the
               depth of vision to truly explore the Holy Mysteries.|"
          MSG_CUSTOM2
            "An eldery voice speaks slowly: |I gift you with Hermetic wisdom!|" 
          MSG_CUSTOM3
            "An elderly voice speaks slowly: |Thy mind is too feeble to be 
                  initiated into thine Holy Mysteries.|"
          #if 0
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          
            /* bad Int/Wis */
          
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          MSG_BADSAC1
          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
          
          
          MSG_BLESSING1
          MSG_BLESSING2
          MSG_BLESSING3
          MSG_BLESSING4
          MSG_BLESSING5
          MSG_BLESSING6
          MSG_BLESSING7
          MSG_CROWNED
          #endif
          ,
      * SACRIFICE_LIST
          MA_CHOICE1        10
          MA_CHOICE1        10
          MA_EVIL            5
          MA_EVIL            5
          MA_EVIL            5,
      * GOD_RELATIONS
          REL_DEFAULT 1 0
          /* Allied Gods */
          $"Immotian" $"Erich" $"Ekliazeh" $"Kysul" $"Mara" $"Hesani" 0 0
          
          /* Minor Displeasure */
          $"Semirath" $"Xel" $"Essiah" $"Aiswin" $"Asherath" 1 0
          
          /* "Destructive Ignorance" */
          $"Sabine" $"Khasrach" 6 1
          
          /* Other Evil Gods */
          $"Zurvash" $"Maeve" $"The Multitude" 3 1,
      /* CROWNING_GIFTS
          $"Cubragol"
          $"Crown of Science", */
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          54000
          96000
          102000
          250000,
      * AID_CHART  
          AID_CLARITY      P_LOW        0
          AID_FEED         P_LOW        0         
          AID_REFRESH      P_LOW        0
          AID_NEWBOOK      P_LOW        0
          AID_IDENTIFY     T_ITEM       50
          AID_PURIFY       P_MODERATE   200
          AID_TELEPORT     P_HIGH       200
          AID_UNCURSE      P_MODERATE   750      
          AID_TELEPORT     P_MODERATE   1000
          AID_MANA         P_MODERATE   1750
          AID_RESURRECT    P_MODERATE   2000
          AID_TELEPORT     P_LOW        3500
          AID_DEFLECT      P_LOW        3500,
      * FAVOURED_SKILLS
          SK_ALCHEMY SK_CRAFT SK_DECIPHER SK_GATHER_INF
          SK_USE_MAGIC SK_KNOW_MYTH SK_KNOW_MAGIC
          SK_KNOW_THEO SK_KNOW_PLANES SK_APPRAISE;
    Constants:
      * VOICE_COLOUR SKYBLUE,
      * ALTAR_COLOUR GREY,
      * HOLY_SYMBOL $"Xavias;symbol",
      * CHOSEN_WEAPON $"arbalest",
      * CHOSEN_WEAPON_QUALITY WQ_QUICK_LOADING,
      * INTERVENTION_COST 4,
      * RESURRECTION_COST 10,
      * ALTAR_COST 5,
      * PRAYER_TIMEOUT 5,
      * MIN_RAISE_LEVEL 6,
      * MIN_CONVERT_FAVOUR 500,
      * PRAYER_DC 15,
      * LEVEL_BLEEDOFF 3,
      * TOLERANCE_VAL 5,
      * GODPULSE_INTERVAL 20,
      * GODANGER_INTERVAL 20,
      * PERSONAL_ALIGN (AL_GOOD),
      * LAY_MULTIPLIER 4;
    Grants:
      Stati[EXTRA_SKILL,SK_CRAFT] at 1st level,
      Stati[EXTRA_SKILL,SK_USE_MAGIC] at 1st level,
      Stati[EXTRA_SKILL,SK_DECIPHER] at 1st level,
      Stati[SKILL_BONUS,SK_DECIPHER,+1] at every level starting at 1st,
      Stati[NONDETECTION,(PER_SCENT|PER_BLIND|PER_TREMOR|PER_DETECT|PER_TELE|PER_PERCEPT)] at 2nd level,
      Stati[SUSTAIN,A_INT,+2] at 3rd level,
      Stati[SUSTAIN,A_WIS,+2] at 3rd level,
      Ability[CA_NATURE_SENSE,+1] at 4th level,
      Ability[CA_INNATE_SPELL,$"Rope Trick"] at 5th level,
      Ability[CA_INNATE_SPELL,$"Insightful Stroke"] at 6th level,
      Ability[CA_WEAPONCRAFT,+1] at 7th level,
      Stati[TRUE_SIGHT] at 8th level,
      Ability[CA_INNATE_SPELL,$"Dispel Evil"] at 9th level
      Ability[CA_INNATE_SPELL,$"Open the Third Eye"] at 9th level;
    On Event EV_RETRIBUTION {
      EActor->IDPrint("You feel marked.", 
        "The <hObj> seems inexplicably loathsome to you.",EActor);
      EActor->GainPermStati(ENEMY_TO,NULL,SS_CURS,MA_SAPIENT,0,$"Xavias",15);
      return DONE;
      },
    EV_GODPULSE {
      EActor->IPrint("<3>Your mind is filled with dreamlike images and cryptic 
        symbolism -- you are enlightened!<7>");
      EActor->Exercise(A_INT,5d12,EINT_XAVIAS,70);
      EActor->Exercise(A_WIS,5d12,EWIS_XAVIAS,70);
      EActor->GainXP(max(1,EActor->Mod(A_INT)+EActor->Mod(A_WIS))*100);
      return DONE;
      },
    EV_ANGER_PULSE {
      EActor->IPrint("<3>Your mind is filled with dreamlike images and cryptic 
        symbolism -- you can't comprehend it!<7>");
      EActor->Abuse(A_INT,5d12);
      EActor->Abuse(A_WIS,5d12);
      ThrowDmg(EV_DAMAGE,AD_DAWI,1d3,"a harrowing vision from Xavias", EActor, EActor);
      EActor->GainTempStati(CONFUSED,NULL,400,SS_MISC);
      return DONE;
      },
    EV_PREREQ {
      /* Attributes not chosen yet. */
      if (EActor->GetAttr(A_INT) <= 1)
        return NOTHING;
      if (EActor->GetAttr(A_INT) + EActor->GetAttr(A_WIS) < 26)
        {
          EActor->GodMessage($"Xavias", MSG_CUSTOM3);
          return NOMSG;
        }
      return NOTHING;
      },
    POST(EV_BLESSING) {
      rID bkID; hObj hBook;
      if (EActor->LevelAs($"mage") || EActor->LevelAs($"bard"))
        {
          do {
            bkID = theGame->GetItemID(PUR_DUNGEON,0,
              EActor->getGodLevel($"Xavias")+2,T_BOOK);
            }
          while (bkID == $"spellbook [Lore of Murder I]" ||
                 bkID == $"spellbook [Lore of Murder II]");
          if (bkID == NULL_ID)
            return NOTHING;
          hBook = CreateItem(bkID);
          EActor->GodMessage($"Xavias", MSG_CUSTOM2);
          EActor->GainItem(hBook,false);
        } 
      return NOTHING;
      },
    EV_SACRIFICE {
      if (GetHandle(EVictim) != NULL_OBJ)
        if (EVictim->isMType(MA_EVIL) && (EVictim->isMType(MA_TROLL) ||
              EVictim->isMType(MA_ORC) ||
              EVictim->mID == $"minotaur" ||
              EVictim->mID == $"ogre" ||
              EVictim->mID == $"merrow" ||
              EVictim->mID == $"hill giant" ||
              EVictim->mID == $"frost giant" ||
              EVictim->mID == $"saqualaminoi" ||
              EVictim->HasEffStati(TEMPLATE,$"barbarian;template") ||
              EVictim->HasEffStati(TEMPLATE,$"reaver")))
          e.EParam = MA_CHOICE1;
      return NOTHING;
      },
    GODWATCH(EV_DAMAGE) {
      if (EVictim->isType(T_ITEM)) {
        if (EVictim->HasIFlag(IF_MASTERWORK))
          EActor->Transgress($"Xavias",3,false,
            "damaging a masterwork");
        else if (EVictim->isMagic())
          EActor->Transgress($"Xavias",1,false,
            "damaging a magical item");
        }
      return NOTHING;
      },
    GODWATCH(EV_ALIGNED) {
      if (e.EParam & (AL_NONGOOD|AL_EVIL))
        EActor->Transgress($"Xavias",(e.vMag + 1) / 2,false,
          "evil act");
      return NOTHING;
      },
    GODWATCH(EV_GAIN_STATI) {
      /* Entering an ecstatic state -- but no confusion-scumming */
      if (e.EParam == CONFUSED && e.vDuration != 400) {
        if (EActor->HasEffStati(EFF_FLAG1,$"Xavias",-1,EVictim))
          return NOTHING;
        EActor->GainTempStati(EFF_FLAG1,EVictim,
          (GetHandle(EVictim) == NULL_OBJ) ? -2 : 0, SS_MISC,0,0,$"Xavias");
        EActor->gainFavour($"Xavias",50,false,true);
        }
      return NOTHING;
      },
    EV_PREREQ {
      if (EActor->IAttr(A_WIS) + EActor->IAttr(A_INT) < 28)
        return ABORT;
      return NOTHING;
      };
  }

AI_SYMBOL Effect "Xel;symbol" : EA_GENERIC
   { Flags: EF_NOGEN; 
     Desc: "Xel's holy symbol is a sheaf of wheat.";
   } 

God "Xel"
  {
    Domains: $"Community", $"Death", $"Evil", $"Plant", $"Pain", $"Trickery";
    Desc: "<15>God of the Harvest<11>\n
      __Community, Death, Evil, Pain, Plant, Trickery. The Sickle. Vampiric
      Weapons.<2>\n
      __Xel is an old, old thing that has been the patron diety of farmers
      and peasant families for as long as there have been farmers and peasant
      families. Predating the rest of the Theryan pantheon by about four
      millenia, Xel's formal holy scriptures are a compliation of folklore,
      elder rituals, wives' tales and even children's nursery rhymes whose
      history often equals that of the languages they were first written in.
      Much beloved by the peasantry, the clergy of Xel bring with them the
      tidings of good harvest, plentiful grain and merry celebration. While
      the majority of priests have a distinct bias toward nobility -- that's
      where the majority of the affluence is to be had, after all -- Xel's
      priests have always been the champions of the everyman, the poor and
      the downtrodden. Even lepers receive the favour of this diety -- indeed,
      Xel's followers have a very special place in their hearts for the
      diseased. Yet, in spite of all of this, there is a sinister meaning
      hidden within Xel's playful children's songs that does not escape the
      more educated scholar.
      \n__Xel is hungry, slavering with an insatiable need for the life
      force of sentient beings. While most of Theyra's gods, good and evil
      alike, accept the offering of a foe's body who needed to be slain for
      reasons in accord with the god's ethos and alignment, that is a very 
      different thing from randomly dragging innocent people to an altar to 
      be slain for the purpose of human sacrifice alone. Yet, the lot of a
      peasant remains harsh, and few heros are willing to stand up for the
      lower classes. Xel has become so much a staple of hearth wisdom that
      most villages see no wrong in the favours its clergy ask, and in return
      its clerics take very seriously their roles as village defenders,
      protectors of the downtrodden and the political muscle of rural 
      communities. The arrival of a travelling priest of 'the Old Goat in
      the Woods', as Xel is known, in a village is a cause for a festival
      and night of revelry not unlike Mardi Gras, and in truth everybody
      knows that the allegations of blood sacrifice are propaganda cooked
      up by manipulative nobles anyway -- at least, it's never been proven!
      Still, the fact remains that many villages have a crude basalt stone
      caked with blood in a shadowed valley a few miles outside their 
      boundry, and so long as the blood flows the crops will not fail.
      \n__Xel is nothing if not dependable, after all.
      \n__Xel's alignment is Lawful Evil; its followers can be of any non-Good
      alignment. Its holy symbol is a sheaf of wheat, though the symbols that
      Xel is most known for are the ancient stone circles its clerics congregate
      at, and its chosen weapon is the sickle. Xel itself is a weary
      diety, sleeping peacefully through the millenia, and does not keep
      a careful eye on its priests, as long as the blood flows. The clergy
      as an organization, however, expects every priest to always honour
      two central precepts: always help a peasant or peasant community in
      need, and never reveal the darker practices of the sect to those who
      cannot be trusted. In return for this, Xel grants its priests
      access to the Domains of Community, Death, Evil, Plant, Pain
      and Trickery.\n
      __<10>Worship:<2> In order to perform a proper sacrifice to Xel, a
      priest must kill a monster while that monster is standing directly
      over one of Xel's altars. While Xel is content with one sacrifice
      every new moon from its pedestrian rural followers, powerful adventurers
      who serve it must offer it fresh blood every night. Xel desires the
      blood of sapient creatures most of all, but will accept lesser beasts
      if need be. However, woe be to the worshipper who fails to offer Xel
      tribute for three nights, for at that point it will begin to consume 
      the follower's life in place of thte tribute, until the lives of 
      thinking, bleeding beings are offered in atonement. As long as the 
      blood flows, however, Xel has absolutely no concern for anything else 
      its followers do.\n
      __<10>Blessings:<2> Xel will heal, ease hunger, restore mana, dispel
      fatigue and replenish the spirit for any follower that gives it tribute
      as tradition demands. Followers who have sacrificed creatures with more
      powerful life force find that Xel will replace lost spellbooks, transport
      them to safety in times of need and purify their bodies. Xel has even
      been known to raise those offering truly impressive sacrifices from
      the dead!\n
      __Xel's cult offers rich supernatural rewards to those
      who sate the elder thing's thirst: the first lesson the cult teaches is
      social elegance and deception. Next the initiate is taught how to raise
      altars to Xel magically. More experienced cultists learn to paralyze
      their foes, drain their life energy to heal themselves and strike with
      deadly precision in combat. Those closest to Xel also find that the
      god's aegis prevents plants from harming them.";
    Flags: GF_NO_GOOD, GF_COMBAT_PULSE, GF_JEALOUS;
    int16 dailySac;
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "You feel an aching, primordial hunger. |Blood for the blood god!|"
          #if 0 
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          MSG_BADSAC1
          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
          
          
          MSG_BLESSING1
          MSG_BLESSING2
          MSG_BLESSING3
          MSG_BLESSING4
          MSG_BLESSING5
          MSG_BLESSING6
          MSG_BLESSING7
          MSG_CROWNED
          #endif
          ,
      * SACRIFICE_LIST
          (MA_SAPIENT+(MA_HAS_BLOOD*256))      10
          (MA_SAPIENT+(MA_HAS_BLOOD*256))      10
          (MA_SAPIENT+(MA_HAS_BLOOD*256))      10
          (MA_SAPIENT+(MA_HAS_BLOOD*256))      10
          MA_HAS_BLOOD                         5
          MA_HAS_BLOOD                         5
          MA_HAS_BLOOD                         5
          MA_CHOICE1                           SAC_UNWORTHY,
      * GOD_RELATIONS
          REL_DEFAULT   0     0,
      * CROWNING_GIFTS
          $"Nine Lives Stealer",
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          54000
          96000
          102000
          250000,
      * AID_CHART  
          AID_HEAL        P_LOW       1
          AID_FEED        P_LOW       1      
          AID_PURIFY      P_LOW       1000
          AID_TELEPORT    P_HIGH      1000 
          AID_REFRESH     P_LOW       1  
          AID_RESTORE     P_LOW       1
          AID_RESURRECT   P_HIGH      4000   
          AID_NEWBOOK     P_MODERATE  1000     
          AID_MANA        P_LOW       1;    
    Constants:
      * VOICE_COLOUR RED,
      * ALTAR_COLOUR RED,
      * HOLY_SYMBOL $"Xel;symbol",
      * INTERVENTION_COST 7,
      * RESURRECTION_COST 15,
      * ALTAR_COST 0,
      * PRAYER_TIMEOUT  10,
      * MIN_RAISE_LEVEL 7,
      * MIN_CONVERT_FAVOUR 10,
      * PRAYER_DC 10,
      * LEVEL_BLEEDOFF 3,
      * TOLERANCE_VAL 3,
      * GODPULSE_INTERVAL 10,
      * GODANGER_INTERVAL 10,
      * PERSONAL_ALIGN (AL_LAWFUL|AL_EVIL),
      * LAY_MULTIPLIER 3;
    Grants:
      Stati[EXTRA_SKILL,SK_BLUFF] at 1st level,
      Stati[EXTRA_SKILL,SK_DIPLOMACY] at 1st level,
      Ability[CA_INNATE_SPELL,$"Hallow"] at 2nd level,
      Ability[CA_INNATE_SPELL,$"Hold Person"] at 3rd level,
      Ability[CA_INNATE_SPELL,$"Vampiric Touch"] at 4th level,
      Feat[FT_IMPROVED_CRIT] at 5th level,
      Stati[NEUTRAL_TO,MA_PLANT] at 6th level,
      /* HACKFIX -- was verdant aid */
      Ability[CA_INNATE_SPELL,$"Spike Growth"] at 7th level,
      Ability[CA_INNATE_SPELL,$"Burning Blood"] at 8th level,
      Ability[CA_INNATE_SPELL,$"Earthmaw"] at 9th level;
    On Event EV_RETRIBUTION, EV_ANGER_PULSE {
      int16 oHP;
      EActor->IDPrint("Xel drinks your life!",
                        "The <hObj> looks deathly pale!",EActor);
      oHP = EActor->cHP;
      ThrowDmg(EV_DAMAGE,AD_NECR,(e.EParam)d6,"the hunger of Xel",
                  EActor, EActor);
      if (EActor->cHP == oHP) {
        EActor->IPrint("You feel Xel is angrier now.");
        EActor->Transgress($"Xel",1,false,"frusterating Xel");
        }
      return DONE;
      },
    EV_GODPULSE {
      if ((EActor->cHP * 4)/3 >= EActor->mHP + EActor->GetAttr(A_THP))
        return NOTHING;
      EActor->IDPrint("Stolen vitality heals your injuries!",
                     "The <hObj>'s wounds heal fully!", EActor);
      EActor->cHP = EActor->mHP + EActor->GetAttr(A_THP);
      return DONE;
      },
    GODWATCH(PRE(EV_REST)) {
      if (EActor->GodID != $"Xel")
        return NOTHING;
      if (!dailySac) 
        if (!EActor->yn("You have not yet offered tribute to Xel today. Continue?"))
          return ABORT;
      return NOTHING;
      },
    GODWATCH(POST(EV_REST)) {
      if (EActor->GodID != $"Xel")
        return NOTHING;
      if (!dailySac)
        EActor->Transgress($"Xel",1,false,
          "failing to offer blood to Xel daily");
      dailySac = 0;
      return NOTHING;
      },
    PRE(EV_SACRIFICE) {
      if (GetHandle(EVictim) == NULL_OBJ)
        return NOTHING;
      if (e.DType == 0 && !(EVictim->Flags & F_DELETE))
        {
          e.EParam = MA_CHOICE1;
          return NOTHING;
        }
      if (EVictim->isMType(MA_HAS_BLOOD)) {
        dailySac = 1;
        if (EVictim->isMType(MA_SAPIENT))
          EActor->lowerAnger($"Xel", 1);
        }
      return NOTHING;
      };
  }

AI_SYMBOL Effect "Zurvash;symbol" : EA_GENERIC
   { Flags: EF_NOGEN; 
     Desc: "Zurvash's holy symbol is a trophy necklace made of bones and
      teeth taken from all of the follower's greatest kills." ; 
   } 

God "Zurvash"
  {
    Domains: $"Animal", $"Night", $"Domination", 
             $"Passion", $"Pain", $"Strength";
    Desc: "<15>God of Animals and the Hunt<11>\n
      __Animal, Night, Domination, Passion, Pain, Strength. Vicious Weapons.<2>\n
      __Zurvash has been given dominion over all things that crawl upon the
      earth and fly through the skies -- and to him, man is just another
      animal, albiet a particulairly clever one. Zurvash's dogma denies the
      very existance of morality; his faith is one of indulgence, brutality
      and instinctive response. Zurvash is the patron diety of hunters,
      stalkers and evil rangers; his temples are located in distant
      wilderness areas secreted away from the public eye. His priesthood is
      charactized by license, but maintains a strict chain of dominance and
      submission, not unlike a wolf pack. The strong rule the weak until
      they no longer are able to assert dominance, at which time they are
      killed and devoured.
      \n__Zurvash's faith resembles that of the Multitude in many ways, but
      it is better organized and more philosophically grounded -- while the
      followers of the Multitude cheerfully embrace the idea that they are
      'evil', Zurvash's children see good and evil only as concepts created
      by Immotian to cheat people out of the things that are worth having
      in life. The clergy is very active in the slave trade, and often acts
      as bounty hunters for hire, given their skill in forestcraft and
      hunting. They are also responsible for breeding many dangerous and
      predatory creatures (such as bulettes, panthers or otyughs), most of
      which they breed and torture to increase their feral rage, then
      release upon the world for their own amusement or for sport hunting.
      \n__Zurvash is revered by different names by many barbarian tribes,
      while others shun him. His touch has a socially destructive impact on
      a barbarian tribe, leading to increasingly bloodthirsty raids and
      acts of depravity on nearby communities, until the tribe is either
      destroyed or, at minimum, has alienated many of it's former allies.
      Priests of Zurvash don't care, being creatures that live in the
      present and rarely consider long-term consequences; all that matters
      to them is satiation of their most immediate desires. In this, they
      are acting exactly as Zurvash desires, becoming more and more like
      the savage beasts he believes all men to be.
      \n__Zurvash's holy symbol is a trophy necklace made of bones and
      teeth taken from all of the follower's greatest kills. He is Chaotic
      Evil in alignment, and his followers can be Chaotic or Neutral Evil.
      He offers his clerics the Domains of Animal, Destruction, Domination,
      Pain, Passion and Strength, and is militant in his intervention on
      their behalf. His chosen weapon is a set of bolas,
      usually with razor-wire binding them together.\n
      __<10>Worship:<2> Zurvash most favours the sacrifice of wild, predatory
      beasts on his altars, and also the remains of other sapient beings 
      bested in fair combat. He is angered when his followers spare their 
      fallen enemies, or when they show self-restraint in any situation that 
      it is not in their immediate benefit to do so. He expects his followers
      to depend on their own personal might, and is angered when they rely
      on allies or summoned creatures (though illusions, as manifestation
      of magic, are fine). Animals are the only acceptable allies to Zurvash.
      Surrendering rather than fighting to the death angers Zurvash greatly, 
      whereas cowing enemies grants favour in his eyes.\n
      __<10>Blessings:<2> Zurvash will clear any follower's mind, as well
      as imbuing them with a kind of berzerk anger, both when they prey and
      when the whim strikes him; this quality makes him a difficult god for
      conventional mages. For a more favoured follower, he will purify the
      body, deflect deadly blows, remove fatigue, replenish the spirit,
      lift curses, heal injuries and raise the dead, in the order of 
      increasing favour required.\n
      __His more permanent blessings include increasing a folllower's
      toughness and agility, granting a preternaturally sharp sense of
      smell, mystical authority to command animals and a complete lack
      of scent. His most treasured servants are said to be blessed with
      constant regeneration of all injuries. Followers with claws and
      teeth are also said to be able to enchant them to bite deeper.
      Slashing wounds inflicted by the favoured of Zurvash are also said
      to bleed more profusely than normal.";
    Flags: GF_NO_LAWFUL, GF_EVIL, GF_COMBAT_PULSE, GF_COMBAT_ANGER; 
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "May your hunt be fruitful, and your plunder rich and succulent!"
          MSG_CUSTOM1
            "A growling voice hisses: |Destroy the infidel, my beautiful children!|"
          
          MSG_BLESSING1
            "A growling voice speaks: |Only the strong will survive!|" 
          MSG_BLESSING2
            "A growling voice speaks: |Be you the hunter and not the hunted!|"
          
          
          #if 0
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          MSG_BADSAC1
          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
          
          
          MSG_BLESSING3
          MSG_BLESSING4
          MSG_BLESSING5
          MSG_BLESSING6
          MSG_BLESSING7
          MSG_CROWNED
          #endif
          ,
      * SACRIFICE_LIST
          MA_BEAST      10
          MA_BEAST      10
          MA_BEAST      10
          MA_SAPIENT    10
          MA_SAPIENT    10
          MA_SAPIENT    10,
      * GOD_RELATIONS
          REL_DEFAULT   3     0
          $"Khasrach" $"Asherath" $"Aiswin" $"Xel" 0 0,
      * CROWNING_GIFTS
          $"Nine Lives Stealer",
      * FAVOUR_CHART
          100
          500
          1250
          4500
          12000
          24000
          54000
          96000
          102000
          250000,
      * AID_CHART  
          AID_BERSERK    P_LOW     0
          AID_CLARITY    P_LOW     0
          AID_PURIFY     P_LOW     100
          AID_DEFLECT    P_LOW     100
          AID_REFRESH    P_LOW     250      
          AID_RESTORE    P_HIGH    750  
          AID_UNCURSE    P_LOW     750
          AID_HEAL       P_LOW     2500    
          AID_RESURRECT  P_LOW     6000;
          
    Constants:
      * VOICE_COLOUR RED,
      * ALTAR_COLOUR RED,
      * HOLY_SYMBOL $"Zurvash;symbol",
      * CHOSEN_WEAPON $"bolas",
      * CHOSEN_WEAPON_QUALITY WQ_VICIOUS,
      * INTERVENTION_COST 12,
      * RESURRECTION_COST 20,
      * ALTAR_COST 5,
      * PRAYER_TIMEOUT 10,
      * MIN_RAISE_LEVEL 8,
      * MIN_CONVERT_FAVOUR 100,
      * PRAYER_DC 10,
      * LEVEL_BLEEDOFF 2,
      * TOLERANCE_VAL 3,
      * GODPULSE_INTERVAL 10,
      * GODANGER_INTERVAL 10,
      * PERSONAL_ALIGN (AL_CHAOTIC|AL_EVIL),
      * LAY_MULTIPLIER 3;
    Grants:
      Stati[EXTRA_FEAT,FT_TOUGHNESS] at 1st level,
      Stati[NONDETECTION,PER_SCENT] at 2nd level,
      Stati[ADJUST_SAC, A_DEX, +1] at every 3rd level starting at 3rd,
      Stati[ADJUST_SAC, A_CON, +1] at every 3rd level starting at 3rd,
      Ability[CA_COMMAND, MA_ANIMAL,+2] at every level starting at 3rd,
      // Cruelest Cut - 4th
      Ability[CA_INNATE_SPELL,$"Magic Fang"] at 4th level,
      Ability[CA_SCENT,+3] at 5th level,
      Ability[CA_SCENT,+1] at every level starting at 6th,
      Stati[REGEN,0,+1] at every level starting at 7th,
      Ability[CA_INNATE_SPELL,$"Divine Agility"] at 8th level,
      Ability[CA_INNATE_SPELL,$"Heroism"] at 9th level;
    On Event EV_GIVE_AID {
      int16 dur;
      if (e.EParam == AID_BERSERK)
        {
          EActor->IDPrint("You go berserk! You feel flush with a supernatural
            endurance!", "The <hObj> goes berserk!", EActor);
          dur = 5d8;
          EActor->GainTempStati(RAGING,NULL,dur,SS_MISC,8,20);
          EActor->GainTempStati(ADJUST_SAC,NULL,dur,SS_MISC,A_THP,100);
          return DONE; 
        }
      return NOTHING;
      },
    EV_BLESSING {
      if (EActor->getGodLevel($"Zurvash") == 4)
        EActor->GainPermStati(TRAP_EVENT,NULL,SS_BLES,0,
          POST(EV_DAMAGE),$"Cruelest Cut");
      return NOTHING;
      },
    EV_RETRIBUTION {
      hObj hBeast; int16 i;
      EMap->thEnGenMTypeXY($"mass summons", (MA_BEAST+(MA_NLIVING*256)),
        EN_HOSTILE|EN_MULTIPLE, EActor->ChallengeRating()+2, AL_NONGOOD, 
        EActor->x, EActor->y);      
      for (i=0;hBeast=EMap->GetEncounterCreature(i);i++)
        hBeast->AddTemplate($"fiendish");
      EActor->GodMessage($"Zurvash",MSG_CUSTOM1);
      return DONE;
      },
    EV_GODPULSE {
      int16 bonus, dur;
      hObj h; bool found_ally;
      
      found_ally = false;
      if (EActor->GodID == $"Zurvash")
        for (h=EMap->FirstThing();h;h=EMap->NextThing())
          if (h->isCreature() && h != GetHandle(EActor) && !h->isIllusion() &&
              h->isFriendlyTo(EActor) && !h->isMType(MA_ANIMAL))
            {
              EActor->Transgress($"Zurvash",1,false,
                "relying on others");
              found_ally = true;
            }
      if (found_ally)
        return DONE;

      if (EActor->AbilityLevel(CA_BERSERK_RAGE) >= 16)
        bonus = 8;
      else if (EActor->AbilityLevel(CA_BERSERK_RAGE) >= 10)
        bonus = 6;
      else if (EActor->AbilityLevel(CA_BERSERK_RAGE) >= 3 || 
                (EActor->LevelAs($"barbarian") == EActor->TotalLevel()))
        bonus = 4;
      else 
        bonus = 2;
      
      bonus += EActor->getGodLevel($"Zurvash") / 2;
     
      EActor->IDPrint("You go berserk! You feel flush with a supernatural
        endurance!", "The <hObj> goes berserk!", EActor);
      dur = 3d8;
      EActor->GainTempStati(RAGING,NULL,dur,SS_MISC,bonus,
                EActor->AbilityLevel(CA_BERSERK_RAGE) + 
                EActor->getGodLevel($"Zurvash") * 2);
      EActor->GainTempStati(ADJUST_SAC,NULL,dur,SS_MISC,A_THP,
                EActor->getGodLevel($"Zurvash") * 10);
      return DONE; 
      },
    EV_ANGER_PULSE {
      switch(1d3)
        {
          case 1:
            EActor->IPrint("You are stricken with fear!");
            EActor->GainTempStati(AFRAID,NULL,3d8,SS_MISC);
           break;
          case 2:
            EActor->IPrint("You are stricken with weakness!");
            EActor->GainTempStati(ADJUST_SAC,NULL,3d8,SS_MISC,A_STR,-8);
           break;
          case 3:
            EActor->IPrint("You are inexplicably struck blind!");
            EActor->GainTempStati(BLINDNESS,NULL,3d8,SS_MISC);
           break;
        }
      return DONE;
      },
    GODWATCH(EV_ENLIST) {
      if (EActor->GodID == $"Zurvash")
        EActor->Transgress($"Zurvash",2,false,
          "relying on others");
      return NOTHING;
      },
    GODWATCH(EV_SURRENDER) {
      EActor->Transgress($"Zurvash",5,false,
        "surrendering");
      return NOTHING;
      },
    EV_SACRIFICE {
      if (GetHandle(EVictim) == NULL_OBJ)
        return NOTHING;
      if (EVictim->ChallengeRating() <
           EActor->ChallengeRating())
        return SAC_UNWORTHY;
      return NOTHING;
      },
    GODWATCH(POST(EV_COW)) {
      if (EVictim->HasStati(AFRAID) && !EVictim->HasEffStati(EFF_FLAG1,$"Zurvash"))
        {
          EVictim->GainPermStati(EFF_FLAG1,EActor,SS_MISC,0,0,$"Zurvash");
          EActor->gainFavour($"Zurvash",10*max(1,EVictim->ChallengeRating()));
        }
      return NOTHING;
      };
  }
  
Effect "Cruelest Cut" : EA_GENERIC
  {
    Flags: EF_SPECABIL;
    On Event META(POST(EV_DAMAGE)) {
      if (e.DType == AD_SLASH && !EVictim->isDead())
        EVictim->GainTempStati(BLEEDING, EActor, 1d6+2, SS_ENCH, 0,
            (EActor->getGodLevel($"Zurvash") - 2) / 2);
      return NOTHING;
      };
  }  
   
AI_SYMBOL Effect "The Multitude;symbol" : EA_GENERIC
   { Flags: EF_NOGEN; 
     Desc: "The holy symbols used by demon ghosts of the Multitude are
     twisted runes with a strange, alien shape to them; each ghost has a
     unique rune all to itself. "; 
   } 

God "The Multitude"
  {
    Desc: "<15>Gods of Darkness, Blood, Cruelty, Power, Atrocity, Murder, etc.<11>\n
      __Evil, and 8 random Domains.<2>\n
      __The Multitude, also called the Demon Ghost Horde or the Thousand
      Voices, is not a single diety but a vast congregation of evil spirits
      once human -- incorporeal undead -- that have been imbued with the
      power to give out clerical magics by the demon Demogorgon, and have
      since swelled their ranks to become a plague upon the world. Hardly
      true divine beings, a single demon ghost is well within the capability
      of powerful mortals to slay, and the adventurers of legend could have
      decimated their ranks just as a master warrior might tear through a
      swarm of goblins. Worse, their priests live up to all the worst
      stereotypes of demon worshippers -- slovenly social outcasts with
      selfish and petty vendettas, unhealthily obsessive tendances and
      emotional insecurities that make them easy prey for any experienced
      demon hunter.\n
      __None of this matters.\n
      __The Multitude is just that, and for all their lack of concrete
      superenatural power or the incompetance of their average servitors,
      their influence is constantly growing. There's just so damned many
      of them, dwelling in vast cities in the Negative Energy Plane and
      roaming the howling void beyond, and there's always stupid, selfish
      demihumans willing to take them up on their offers of power, wealth
      and petty vengeance. When a cultist of the Multitude dies, he becomes
      a demon ghost himself, bound to decieve and cow the living into
      worshipping him or wither away in starvation in the depths of the
      Negative Plane. The Multitude has worshippers in a suprising number
      of places, and if they had any degree of organization (or even sanity)
      in their ranks, they would easily be a political power on the level
      of the High Guilds.\n
      __The holy symbols used by demon ghosts are twisted runes with a 
      strange, alien shape to them; each ghost has a unique rune all to
      itself. The demon ghosts are utterly and inherently Chaotic Evil,
      and unlike those true gods of Therya, they don't hide or whitewash
      that fact in any way. An aspiring cultist has better be ready to
      stomach what their worship entails. 
      The demon ghosts to not have enough of an established
      priesthood to have chosen weapons. Most demon ghosts have only
      one altar, reward their followers with potent, blasphemous gifts
      and appreuciate the sacrifice of good, friendly creatures who are
      significantly weaker than the worshipper.\n
      __Every demon ghost grants the Evil domain and two other domains.
      The two additional domains are chosen from a list of eight domains
      that are sacred to that demon ghost (and are, effectively, drawn at
      random from the complete list of domains).\n
      __<10>Worship:<2> The spirits of the Multitude will accept as
      sacrifices the corpse of any creature killed specifically to be a
      sacrifice -- in other words, a creature that was once friendly -- or
      any good creature. However, what the most glory in is the sacrifice
      of incorporeal undead -- the specific demon ghost can tear apart and
      consume the essence of other spirits, thereby increasing its own
      power. This can be difficult to achieve, since incorporeal undead
      do not leave corpses. They can be sacrificed by being killed while 
      standing directly on an altar, however.\n
      __Good acts anger the Multitude, while evil acts please them. They
      expect their cultists to not use magical healing, since the same
      channeling of positive energy which heals living creatures injures
      the demon ghosts through the sympathetic link between worshipper
      and diety. Cultists may use magical healing on creatures other
      than themselves, and may benefit from psionic or natural healing,
      or vampiric effects such as <9>vampiric touch<2> or regenerative
      effects such as a <9>ring of regeneration<2>.\n
      __<10>Blessings:<2> The demon ghosts offer several forms of aid to
      anyone who so much as pledges himself to them: healing, purifying
      the body and smiting enemies. More loyal followers can also gain
      the following types of aid, in order of increasing favour: replenishment
      of mana, replacement of lost spellbooks, deflection of especially
      lethal blows, identification of any items and even resurrection for
      a truly favoured follower.\n
      __The demon ghosts are truly diverse beings, no two alike. As such,
      the more permanent blessings they grant to followers are very
      diverse. These usually take the form of inherent magical abilities
      similar to spells, chosen randomly based on the areas a specific
      evil ghost has influence over. The more loyal the worshipper,
      however, the more powerful the granted abilities have the potential
      of becoming.";
    Domains: $"Evil", $0, $0, $0, $0, $0; 
    Flags: GF_EVIL; 
    Lists:
      * GODSPEAK_LIST
          MSG_SALUTATION
            "|killemflayemburnemhurtemmakeemscreammakeemBLEED...|"
          MSG_CUSTOM7
            "|Goodhordegrownhordebloodyhordeghostspleased...|"
          MSG_CUSTOM3
            "|aidhimservehimlovehimkillforhim...|"
          MSG_CUSTOM4
            "|traitortraitortraitorDIEtraitortraitor...|"
          #if 0
          MSG_ANGER
          MSG_PROVE_WORTH
          MSG_NOT_WORTHY
          MSG_BAD_PRAY
          MSG_JEALOUSY
          MSG_CONVERT
          
          MSG_UNEASY
          MSG_VUNEASY
          MSG_FORSAKE
          
          MSG_TIMEOUT
          MSG_PRAYER
          MSG_NOAID
          MSG_OUT_OF_AID
          MSG_NEARLY_OUT
          
          MSG_SACRIFICE
          MSG_INSUFFICIENT
          MSG_SATISFIED
          MSG_IMPRESSED
          MSG_UNINTERESTED
          MSG_LESSENED
          MSG_MOLLIFIED
          MSG_BADSAC1
          
          /* Skipping 'Insight' messages */
          
          MSG_AID + AID_
          MSG_OFFER_RAISE
          
          
          MSG_BLESSING1
          MSG_BLESSING2
          MSG_BLESSING3
          MSG_BLESSING4
          MSG_BLESSING5
          MSG_BLESSING6
          MSG_BLESSING7
          MSG_CROWNED
          #endif
          ,
      * SACRIFICE_LIST
          MA_CHOICE1     20
          MA_CHOICE1     20
          MA_CHOICE1     20
          MA_CHOICE1     20
          MA_NLIVING     7
          MA_NLIVING     7
          MA_NLIVING     7
          MA_NLIVING     7
          MA_CHOICE2     SAC_UNWORTHY,
      * GOD_RELATIONS
          REL_DEFAULT    0     0,
      * CROWNING_GIFTS
          $"Nine Lives Stealer",
      * FAVOUR_CHART
          50
          250
          500
          1250
          4500
          12000
          36000
          54000
          102000
          290000,
      * AID_CHART  
          AID_HEAL           P_LOW       0
          AID_PURIFY         P_LOW       0 
          AID_SMITE          P_MODERATE  0
          AID_DEFLECT        P_LOW       1500
          AID_IDENTIFY       T_ITEM      1500     
          AID_RESURRECT      P_LOW       3500
          AID_NEWBOOK        P_LOW       750      
          AID_MANA           P_LOW       125;    
    Constants:
      * VOICE_COLOUR COL_POISON,
      * ALTAR_COLOUR SHADOW,
      * HOLY_SYMBOL $"The Multitude;symbol",
      * CHOSEN_WEAPON_QUALITY WQ_UNHOLY,
      * INTERVENTION_COST 3,
      * RESURRECTION_COST 7,
      * ALTAR_COST 2,
      * PRAYER_TIMEOUT 5,
      * MIN_RAISE_LEVEL 9,
      * MIN_CONVERT_FAVOUR 50,
      * PRAYER_DC 15,
      * LEVEL_BLEEDOFF 3,
      * TOLERANCE_VAL 0,
      * GODPULSE_INTERVAL 7,
      * GODANGER_INTERVAL 7,
      * PERSONAL_ALIGN (AL_CHAOTIC|AL_EVIL),
      * LAY_MULTIPLIER 30;
    On Event EV_GIVE_AID {
      hObj hEnemy;
      if (e.EParam == AID_SMITE)
        {
          EActor->IPrint("You are infused with demonic resilience!");
          EActor->GainTempStati(EXTRA_ABILITY,NULL,3d6,SS_ENCH,
                    CA_WEAPON_IMMUNITY,+3,$"Demonic Resilience",30);
          for (hEnemy=EMap->FirstThing();hEnemy;hEnemy=EMap->NextThing())
            if (hEnemy->isCreature() && hEnemy->DistFrom(EActor) < 15)
              if (hEnemy->isHostileTo(EActor))
                ThrowEff(EV_EFFECT,1d2 == 1 ? $"Thornwrack" : $"Burning Blood",
                  EActor, hEnemy);
          return DONE;
        }
      return NOTHING;
      },
    EV_RETRIBUTION {
      ThrowEff(EV_EFFECT,1d2 == 1 ? $"Thornwrack" : $"Burning Blood",
                  EActor, EActor);
      return DONE;
      },
    EV_GODPULSE {
      int16 enCR;
      enCR = EActor->FixSummonCR(EActor->getGodLevel($"The Multitude")+1,PHD_MAGIC);
      if (enCR <= 0) {
        EActor->GodMessage($"The Multitude", MSG_CUSTOM7);
        EActor->gainFavour($"The Multitude",4d50,false,true);
        return DONE; 
        }       
      e.vDuration = 30 + EActor->Mod(A_CHA)*5;
      EActor->GodMessage($"The Multitude", MSG_CUSTOM3);

      EMap->thEnGenMTypeSummXY($"mass summons", MA_DEMON, EN_SUMMON|EN_MULTIPLE, 
         EActor->ChallengeRating()+2, AL_NONGOOD|AL_NONLAWFUL, EActor, 
         EActor->x, EActor->y);      

      return DONE;
      },
    EV_ANGER_PULSE {
      e.vDuration = 200;
      EActor->GodMessage($"The Multitude", MSG_CUSTOM4);
      EMap->thEnGenMTypeXY($"mass summons", MA_DEMON, EN_SUMMON|EN_MULTIPLE|EN_HOSTILE, 
         EActor->ChallengeRating()+2, AL_NONGOOD|AL_NONLAWFUL, 
         EActor->x, EActor->y);      
      return DONE;
      },      
    EV_BLESSING {
      rID spID;
      if (1d3 == 1)
        spID = theGame->GetEffectID(PUR_DUNGEON,0,
          EActor->getGodLevel($"The Multitude")+1,AI_THEURGY);
      else
        spID = theGame->GetEffectID(PUR_DUNGEON,0,
          EActor->getGodLevel($"The Multitude")+1,AI_WIZARDRY);
      EActor->setSpellFlags(spID, EActor->getSpellFlags(spID) 
                | SP_INNATE);
      return DONE;      
      },
    GODWATCH(EV_ALIGNED) {
      if (e.EParam & (AL_EVIL|AL_NONGOOD))
        EActor->gainFavour($"The Multitude",10*e.vMag,false,true);
      if (e.EParam & AL_GOOD)
        EActor->Transgress($"The Multitude",(e.vMag+1)/2,false,
          "good act");
      return NOTHING;
      },
    EV_SACRIFICE {
      if (GetHandle(EVictim) == NULL_OBJ)
        return NOTHING;
      if (EVictim->isMType(MA_UNDEAD) &&
          (EVictim->HasMFlag(M_INCOR) ||
           EVictim->isMType(MA_WRAITH)))
        {
          e.EParam = MA_CHOICE1;
          return NOTHING;
        }
      if (!(EVictim->isMType(MA_GOOD) ||
            EVictim->HasStati(WAS_FRIENDLY)))
        e.EParam = MA_CHOICE2;
      return NOTHING;
      },
    GODWATCH(EV_SACRIFICE), GODWATCH(EV_PRAY),
      GODWATCH(EV_IBLESSING) {
      /* No true gods, other than Xel, will respond to
         prayers from a Multitude cultist with anything
         other than anger. */
      if (EActor->GodID == $"The Multitude" &&
          e.eID != $"Xel" && e.eID != $"The Multitude")
        {
          EActor->Transgress(e.eID,5,true,
            "worshipping the Multitude");
          return DONE;
        }
      return NOTHING;
      },
    GODWATCH(POST(EVICTIM(EV_EFFECT))) {
      if (EVictim->getGod() == $"The Multitude")
        if (e.eID == $"cure light wounds" ||
            e.eID == $"cure moderate wounds" ||
            e.eID == $"cure serious wounds" ||
            e.eID == $"cure critical wounds" ||
            e.eID == $"heal;spell" ||
            e.eID == $"healing" ||
            e.eID == $"extra-healing" ||
            e.eID == $"true-healing")
          EActor->Transgress($"The Multitude",2,false,
            "using positive energy");
      return NOTHING;
      }; 
  }
  
Effect "Demonic Resilience" : EA_GENERIC 
  { Flags: EF_SHOWNAME, EF_SPECABIL; }


/* Potential New Gods:

   Shaundakul -- the Elder Elemental Eye
     (Earth, Air, Fire, Water, Slime, Mysticism
   Prosephene -- the Goddess of Opportunity
     Trade, Trickery, Knowledge, Nobility, Travel, Luck
   Nilvaz -- the Goddess of Malice and Fertility
     Trickery, Hatred, Luck, Evil, Chaos, Succor
   Shaana -- the God of Safety and Circumstance
     Protection, Community, Plant, Law, Succor, Trade
   Malgrave -- the God of Perfection and Peace
     Strength, Thought, Succor, Animal, Travel, Knowledge

   Potential New Domains:

   Thought
   Trade / Wealth
   Purity
   Numbers

*/